{"version":3,"sources":["pages/idx.js","actions/wm.js","actions/selectFile.js","pages/about.js","pages/calc.js","pages/img.js","reducers/file-reducer.js","reducers/wm-reducer.js","reducers/index.js","store.js","index.js","pages/images/wm.png","pages/images/wm2.png"],"names":["CheckboxItem","Checkbox","App","props","unsubscribe","store","useContext","StoreContext","ele","useRef","useEffect","setTimeout","current","removeAttribute","addListener","_useState","useState","_useState2","Object","slicedToArray","drawerVisible","setDrawerVisible","_useState3","getState","watermark","simple","_useState4","simpleMark","setSimpleMark","sidebar","react_default","a","createElement","es","Item","Link","to","key","checked","onChange","e","onCheckboxChange","subscribe","s","console","log","target","dispatch","type","style","display","ref","mode","icon","onClick","onOpenChange","className","minHeight","document","documentElement","clientHeight","open","files","index","history","push","file","List","pages_about","leftContent","onLeftClick","goBack","renderHeader","extra","fArr","dict","震","巽","坎","离","艮","坤","兑","乾","year","setYear","gender","setGender","_useState5","_useState6","fate","setFate","genderArr","label","value","size","data","cols","v","arrow","placeholder","toString","trim","r","f","y","slice","text","concat","Toast","info","doCalc","houseImg","wmImg","Image","src","warterMark_simple","warterMark","cvs","width","height","ctx","getContext","finish","img","imgData","setData","selectFile","showImg","objectSpread","url","doCrop","d","getCroppedCanvas","toDataURL","onCreateImg","aSrc","Promise","rs","rj","tImg","onload","this","then","aImage","imgWidth","imgHeight","disTop","disLeft","drawImage","globalAlpha","drawTheImage","createImg","window","PinchZoom","default","parentNode","rightContent","replace","save_link","createElementNS","href","download","event","createEvent","initMouseEvent","dispatchEvent","rotate","react_cropper_default","defaultState","allReducers","state","arguments","length","undefined","action","rootReducer","combineReducers","createStore","reducer","PrimaryLayout","Route","path","exact","component","Idx","About","Calc","Img","render","index_es","Provider","HashRouter","src_PrimaryLayout","getElementById","module","exports","__webpack_require__","p"],"mappings":"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","file":"static/js/main.e5299cca.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect, useContext } from 'react';\r\nimport {Link} from 'react-router-dom'\r\nimport { NavBar, Icon, Drawer, List, ImagePicker, Checkbox } from 'antd-mobile';\r\nimport './idx.css';\r\nimport {StoreContext} from 'redux-react-hook';\r\n//两个action 这里面出触发监听\r\nimport selectFile from '../actions/selectFile';\r\nimport changeWatermarkType from '../actions/wm';\r\n\r\nconst CheckboxItem = Checkbox.CheckboxItem;\r\nconst App = (props) => {\r\n  //console.log(window.gSelectFile);\r\n  //console.log(props);\r\n  //共享store\r\n  const store = useContext(StoreContext);\r\n  //console.log(store)\r\n  //hooks里面引用ref (引用元素)\r\n  const ele = useRef(null);\r\n  let unsubscribe;\r\n  useEffect(() => {\r\n    //console.log(ele.current);\r\n    setTimeout(()=>{\r\n      ele.current.removeAttribute(\"style\")\r\n    },50);\r\n    addListener();\r\n    //析构\r\n    return ()=> {\r\n      unsubscribe();\r\n    }\r\n  },[]);  \r\n  //侧栏显示隐藏\r\n  const [drawerVisible, setDrawerVisible] = useState(false);\r\n  //侧栏水印选项\r\n  const [simpleMark, setSimpleMark] = useState(store.getState().watermark.simple);\r\n  //侧栏内容\r\n  const sidebar = (<List>\r\n        <List.Item> <Link to=\"/calc\">东西四命计算</Link></List.Item>\r\n        <List.Item>\r\n          <CheckboxItem key=\"0\" checked={simpleMark} onChange={(e) => onCheckboxChange(e)}>\r\n            使用简化版水印\r\n          </CheckboxItem>  \r\n        </List.Item>        \r\n        <List.Item> <Link to=\"/about\">关于</Link></List.Item>\r\n  </List>);\r\n  const addListener = ()=> {\r\n    //监听使用简单水印还是复杂水印\r\n    unsubscribe = store.subscribe(() =>{\r\n        let s = store.getState();\r\n        //console.log(s)\r\n        setSimpleMark(s.watermark.simple);\r\n      }\r\n    ); \r\n  }  \r\n  //侧栏\r\n  const onOpenChange = (...args) => {\r\n    //console.log(args);\r\n    setDrawerVisible(!drawerVisible)\r\n  }\r\n  //选择复杂还是简单水印的checkbox\r\n  const onCheckboxChange = (e) => {\r\n    //setSimpleMark(e.target.checked)\r\n    console.log(e.target.checked)\r\n    store.dispatch(changeWatermarkType(e.target.checked));\r\n  }\r\n  //选择了图片后的事件\r\n  const onImgChange = (files, type, index)=> {\r\n    //console.log(files, type, index)\r\n    //window.gSelectFile = files[0]; //以前加了全局变量 现在用了redux 所以去掉了\r\n    props.history.push(\"/img\")\r\n    store.dispatch(selectFile(files[0]));\r\n  }\r\n  // componentDidMount() {\r\n  //   document.title = `You clicked ${this.state.count} times`;\r\n  // }\r\n  //\r\n  // componentDidUpdate() {\r\n  //   document.title = `You clicked ${this.state.count} times`;\r\n  // }\r\n\r\n  return (\r\n    <div style={{display:\"none\"}} ref={ele}>  \r\n      <NavBar mode=\"dark\" icon={<Icon type=\"ellipsis\" />}  onClick={() =>setDrawerVisible(!drawerVisible)}>东西四宅计算</NavBar>\r\n      <Drawer \r\n        onOpenChange={onOpenChange}\r\n        className=\"my-drawer\"\r\n        style={{ minHeight: document.documentElement.clientHeight*.6 }}\r\n        sidebar={sidebar}\r\n        open={drawerVisible}>\r\n        <div className=\"idx-imgbox\">\r\n          <ImagePicker\r\n            onChange={onImgChange}\r\n          />\r\n          <div>点击添加房型图</div>\r\n        </div>\r\n      </Drawer>        \r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n// import React, { Component } from 'react';\r\n\r\n// class App extends React.Component {\r\n//   state = {\r\n//     count: 0\r\n//   }\r\n\r\n//   componentDidMount() {\r\n//     document.title = `You clicked ${this.state.count} times`;\r\n//   }\r\n\r\n//   componentDidUpdate() {\r\n//     document.title = `You clicked ${this.state.count} times`;\r\n//   }\r\n\r\n//   render() {\r\n//     return (\r\n//       <div>\r\n//         <p>You clicked {this.state.count} times</p>\r\n//         <button onClick={() => this.setState({ count: this.state.count + 1 })}>\r\n//           Click me\r\n//         </button>\r\n//       </div>\r\n//     );\r\n//   }\r\n// }\r\n// export default App;","export default function changeWatermarkType(b) {\r\n  return {\r\n    type: \"wm_type\",\r\n    simple: b\r\n  }\r\n}","export default function selectFile(aFile) {\r\n  return {\r\n    type: \"select_file\",\r\n    file: aFile\r\n  }\r\n}","import React from 'react';\r\nimport { NavBar, List } from 'antd-mobile';\r\nimport './about.css';\r\nconst Item = List.Item;\r\nexport default  (props) => {\r\n    const back = () => {\r\n      props.history.goBack();\r\n    }  \r\n    return (\r\n      <div >\r\n        <NavBar\r\n          mode=\"dark\"\r\n          leftContent=\"后退\"\r\n          onLeftClick={() => back()}\r\n        >关于</NavBar>     \r\n           <List renderHeader={() => '东西四宅计算'} className=\"c-about-list\">\r\n             <Item extra={'MikeChen'}>作者</Item>\r\n           </List>          \r\n           <List className=\"c-about-list\">\r\n             <Item extra={'mike8625@163.com'}>邮箱</Item>\r\n           </List>          \r\n      </div>\r\n    );\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { Button, NavBar, Picker, List, WhiteSpace, WingBlank, InputItem, Toast } from 'antd-mobile';\r\nimport './calc.css';\r\nconst App = (props) => {\r\n  const fArr = [\"坎\",\"坤\",\"震\",\"巽\",[\"坤\", \"艮\"],\"乾\",\"兑\",\"艮\",\"离\"]\r\n  const dict= {\r\n    \"震\": [\"东四\",\"东\",\"木\"],\r\n    \"巽\": [\"东四\",\"东南\",\"木\"],\r\n    \"坎\": [\"东四\",\"北\",\"水\"],\r\n    \"离\": [\"东四\",\"南\",\"火\"],\r\n    \"艮\": [\"西四\",\"东北\",\"土\"],\r\n    \"坤\": [\"西四\",\"西南\",\"土\"],\r\n    \"兑\": [\"西四\",\"西\",\"金\"],\r\n    \"乾\": [\"西四\",\"西北\",\"金\"]\r\n  }  \r\n  const [year, setYear] = useState(\"\")  \r\n  const [gender, setGender] = useState([0])\r\n  const [fate, setFate] = useState()\r\n  const onChangeGender = (g) => {\r\n    //console.log(g)\r\n    setGender(g);\r\n  };\r\n  const onChangeYear = (y) => {\r\n    setYear(y)\r\n  };\r\n  const doCalc = () => {\r\n    if (year.toString().trim() === \"\") {\r\n      Toast.info(\"请输入年份\");\r\n      return;\r\n    }\r\n    let y = +(year.toString().slice(2));\r\n    let r, f;\r\n    if (gender[0] === 0) {\r\n      r = (100 - y) % 9 || 9; \r\n    }\r\n    else {\r\n      r = (y - 4) % 9 || 9;\r\n    }\r\n    r--;\r\n    if (r === 4) {\r\n      f = fArr[4][gender];\r\n    }\r\n    else {\r\n      f = fArr[r];\r\n    }\r\n    let text = `${dict[f][0]}命, ${f}卦, ${dict[f][1]}方, 属${dict[f][2]}`;\r\n    setFate(text);\r\n  };\r\n  const genderArr = [\r\n    {\r\n      label:\r\n      (<div key={0}>\r\n        <span>男</span>\r\n      </div>),\r\n      value: 0,\r\n    },\r\n    {\r\n      label:\r\n      (<div key={1}>\r\n        <span>女</span>\r\n      </div>),\r\n      value: 1,\r\n    }\r\n  ];\r\n  return (\r\n    <div >  \r\n      <NavBar mode=\"dark\" leftContent=\"后退\" onLeftClick={() => props.history.goBack()}>东西四命计算</NavBar>\r\n      <WhiteSpace size=\"lg\" />\r\n      <List>\r\n        <Picker \r\n            data={genderArr}\r\n            value={gender}\r\n            cols={1}\r\n            onChange={(v)=>onChangeGender(v)}\r\n          >\r\n            <List.Item arrow=\"horizontal\">性别</List.Item>\r\n          </Picker>\r\n          <InputItem \r\n            type=\"digit\"\r\n            placeholder=\"请输入出生年份\"\r\n            onChange={(v)=>onChangeYear(v)}\r\n            value={year}\r\n          >出生年份</InputItem>         \r\n      </List>  \r\n      <WhiteSpace size=\"lg\" />   \r\n      <WingBlank> \r\n        <Button type=\"ghost\" onClick={()=>doCalc()}>计算</Button><WhiteSpace />\r\n      </WingBlank>\r\n      <WhiteSpace size=\"lg\" />    \r\n      <div className=\"fate-result\">{fate}</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport { NavBar, Toast } from 'antd-mobile';\r\nimport Cropper from 'react-cropper';\r\nimport 'cropperjs/dist/cropper.css';\r\nimport './img.css';\r\nimport warterMark_simple from './images/wm.png'\r\nimport warterMark from './images/wm2.png'\r\n//用这个可以共享store\r\nimport {StoreContext} from 'redux-react-hook';\r\n//图片尺寸\r\nconst imgSize = 1600;\r\nconst App = (props) => {\r\n  const store = useContext(StoreContext);\r\n  //hooks里面引用ref必须这么写\r\n  const ele = useRef(null);\r\n  const houseImg = useRef(null);\r\n  \r\n  //图片,canvas 合成图片用\r\n//  let theImg = new Image();\r\n//  //theImg.setAttribute('crossOrigin','anonymous')\r\n//  theImg.onload = function(e) {\r\n//    drawTheImage(this);\r\n//    createImg();\r\n//  }  \r\n  \r\n  //mask水印  根据用户的配置 选简单的图还是复杂的图\r\n  let wmImg = new Image();\r\n  if(store.getState().watermark.simple) {\r\n    wmImg.src = warterMark_simple;\r\n  }\r\n  else {\r\n    wmImg.src = warterMark;\r\n  }\r\n  //canvas 用来画图和在图上贴水印\r\n  let cvs = document.createElement(\"canvas\");\r\n  cvs.width = imgSize; \r\n  cvs.height= imgSize;\r\n  let ctx = cvs.getContext(\"2d\");\r\n  //数据\r\n  const [data, setData] = useState({\r\n    finish: false,\r\n    img: \"\",\r\n    imgData: \"\"\r\n  });\r\n  //初始化\r\n  useEffect(() => {\r\n    //console.log(store.getState())\r\n    let f = store.getState().selectFile.file;\r\n    if (!f) {\r\n      return;\r\n    }\r\n    setTimeout(()=>{\r\n      showImg(f);\r\n    }, 300);\r\n  },[]); \r\n  \r\n  //把裁切的图放到一个临时图片里面   \r\n  const loadImg = (aSrc)=> {\r\n    return new Promise((rs,rj)=> {\r\n      //图片,canvas 合成图片用\r\n      let tImg = new Image();\r\n      tImg.src = aSrc;\r\n      tImg.onload = function(e) {\r\n        rs(this);\r\n      }\r\n    })\r\n  }\r\n  //旋转\r\n  const doRotate = ()=> {\r\n    ele.current.rotate(90)\r\n  }\r\n  //保存 pc端可以 移动端貌似不行\r\n  const doSave = ()=> {\r\n//    var link = document.createElement(\"a\");\r\n//    link.download = 'image.png';\r\n//    link.href =  data.imgData;\r\n//    link.click();    \r\n//    return;\r\n//    cvs.toBlob(function(blob) {\r\n//      console.log(blob)\r\n//      var url = URL.createObjectURL(blob);\r\n//      let a = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\r\n//      a.href = url;\r\n//      a.download = 'house.png';\r\n//      a.click();\r\n//    })\r\n//    return;\r\n    Toast.info(\"如果下载失败请长按图片保存\");\r\n    let d = data.imgData.replace(\"image/jpeg\",'image/octet-stream');\r\n    let save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\r\n    save_link.href = d;\r\n    save_link.download = \"house.jpg\";\r\n    let event = document.createEvent('MouseEvents');\r\n    event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n    save_link.dispatchEvent(event);\r\n  }\r\n//  var _fixType = function(type) {\r\n//   type = type.toLowerCase().replace(/jpg/i, 'jpeg');\r\n//   let r = type.match(/png|jpeg|bmp|gif/)[0];\r\n//   return 'image/' + r;\r\n//  };\r\n  //点完成\r\n  const doFinish = ()=> {\r\n    doCrop()\r\n  }\r\n  //显示选择的图片 还没有裁切\r\n  const showImg = (f)=> {\r\n    setData({\r\n      ...data,\r\n      img: f.url  \r\n    })\r\n    Toast.info(\"请裁切掉所有白边\", 2, null, false);\r\n  }\r\n  //设置图片可以用手放大缩小\r\n  const setZoomImg = () => {\r\n    //console.log(typeof(houseImg.current));\r\n    //new PinchZoom(houseImg.current,houseImg.current.parentNode, {});\r\n     new window.PinchZoom.default(houseImg.current.parentNode, {});\r\n  }\r\n  //裁切\r\n  const doCrop = () => {\r\n    let d = ele.current.getCroppedCanvas().toDataURL(\"image/png\", 0.6);\r\n    //console.log(d);  \r\n    onCreateImg(d);  \r\n  }\r\n  //把切画好的图片滑到canvas上,然后加上水印mask\r\n  const drawTheImage = (aImage) => {\r\n    let r, disTop = 0, disLeft = 0, imgWidth, imgHeight;\r\n    if(aImage.width > aImage.height) {\r\n      r = aImage.height / aImage.width;\r\n      imgWidth = imgSize;\r\n      imgHeight = imgSize * r;\r\n      disTop = (imgSize - imgHeight) / 2;\r\n    }\r\n    else {\r\n      r = aImage.width / aImage.height;\r\n      imgHeight = imgSize;\r\n      imgWidth = imgSize * r;    \r\n      disLeft = (imgSize - imgWidth) / 2;  \r\n    }\r\n    ctx.drawImage(aImage, 0, 0, aImage.width, aImage.height, disLeft, disTop, imgWidth, imgHeight);\r\n    //水印........\r\n    ctx.globalAlpha=0.35;\r\n    ctx.drawImage(wmImg, 0, 0);\r\n  }\r\n  //选好去掉白边的图,然后生成自己的图\r\n  const onCreateImg = (d) => {\r\n    //theImg.src = d;\r\n    loadImg(d).then((img)=>{\r\n      drawTheImage(img);\r\n      createImg();      \r\n    })\r\n  }\r\n  //把最终图片显示在界面\r\n  const createImg = () => {\r\n    let d = cvs.toDataURL(\"image/jpeg\");\r\n    setData({\r\n      ...data,\r\n      finish: true,\r\n      imgData: d \r\n    })\r\n    setZoomImg();\r\n  }\r\n  \r\n  return (\r\n    <div >  \r\n      <NavBar mode=\"dark\" leftContent=\"后退\" onLeftClick={() => props.history.goBack()} \r\n       rightContent={[\r\n         <span key=\"0\" onClick={doSave} style={{display: data.finish ? \"block\": \"none\"}}>保存</span>,\r\n         <span key=\"1\" onClick={doRotate} style={{display: data.finish ? \"none\" : \"block\"}}>旋转</span>,\r\n         <span key=\"2\" onClick={doFinish} style={{display: data.finish ? \"none\" : \"block\"}}>完成</span>\r\n       ]}></NavBar>\r\n      <Cropper\r\n        ref={ele}\r\n        src={data.img}\r\n        style={{display: data.finish ? \"none\" : \"block\", height: document.documentElement.clientHeight - 45, width: '100%'}}\r\n      />  \r\n      <div style={{display: data.finish ? \"flex\": \"none\", height: document.documentElement.clientHeight - 45}} className=\"img-con\">\r\n        <div style={{height: \"100vw\", width: \"100%\"}}>\r\n          <div className=\"img-zoombox\" >\r\n            <img src={data.imgData} ref={houseImg} />  \r\n          </div>\r\n        </div>\r\n        <div className=\"img-text\">东,东南,南,北为东四宅,其他为西四宅</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const defaultState = {file: null}\r\nconst reducer = (state=defaultState, action) => {\r\n  switch (action.type) {\r\n    case 'select_file':\r\n      return {...state, file: action.file}\r\n    default: \r\n      return state;\r\n  }\r\n};\r\nexport default reducer;","const defaultState = {simple: true}\r\nconst reducer = (state=defaultState, action) => {\r\n  switch (action.type) {\r\n    case 'wm_type':\r\n      return {...state, simple: action.simple};\r\n    default: \r\n      return state;\r\n  }\r\n};\r\nexport default reducer;","import { combineReducers } from 'redux';\r\nimport fileReducer from './file-reducer';\r\nimport wmReducer from './wm-reducer';\r\n\r\n//����������recuder�ϲ�����\r\nconst allReducers = {\r\n  selectFile: fileReducer,\r\n  watermark: wmReducer\r\n}\r\n\r\nconst rootReducer = combineReducers(allReducers);\r\n\r\nexport default rootReducer;\r\n","import { createStore } from \"redux\";\r\nimport reducer from './reducers/index'\r\n\r\nconst store = createStore(reducer);  //��������൱��addListener ��Ҳ��̫һ�� ��Ϊ����һ��subscribe....\r\n\r\nexport default store;","import React from 'react'\r\nimport {\r\n  HashRouter,\r\n  Route,  \r\n} from 'react-router-dom'\r\nimport { render } from \"react-dom\";\r\nimport { createStore } from \"redux\";\r\nimport {StoreContext} from 'redux-react-hook';\r\nimport 'antd-mobile/dist/antd-mobile.css';\r\nimport './index.css';\r\n\r\nimport Idx from './pages/idx'\r\nimport About  from './pages/about'\r\nimport Calc from './pages/calc'\r\nimport Img from './pages/img'\r\n\r\n//������ȥ����store���߼� \r\nimport store from './store'\r\n\r\nconst PrimaryLayout = () => (\r\n  <div className=\"primary-layout\">\r\n    <main>\r\n      <Route path=\"/\" exact component={Idx} />\r\n      <Route path=\"/about\" component={About} />\r\n      <Route path=\"/calc\" component={Calc} />\r\n      <Route path=\"/img\" component={Img} />\r\n    </main>\r\n  </div>\r\n)\r\n\r\nconst App = () => (\r\n  <HashRouter>\r\n    <PrimaryLayout />\r\n  </HashRouter>\r\n)\r\n\r\nrender(<StoreContext.Provider value={store}><App /></StoreContext.Provider>, document.getElementById(\"root\"))","module.exports = __webpack_public_path__ + \"static/media/wm.ab9cdb87.png\";","module.exports = __webpack_public_path__ + \"static/media/wm2.9811e247.png\";"],"sourceRoot":""}