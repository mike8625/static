(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{1242:function(e,t,n){Promise.resolve().then(n.bind(n,4440))},4440:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(7437),s=n(2265),u=n(7351),c=n(3189),a=n(5219),i=n(988),o=n(4542),l=n.n(o),m=n(7603);function d(){let e=(0,a.useRouter)(),[t,n]=(0,s.useState)(0),o=(0,u.Z)({queTime:0,answer:"",queText:"",curIndex:-1}),d=(0,s.useRef)([]),p=(0,i.o)(e=>e.perSecond),g=(0,i.o)(e=>e.queCount),f=(0,i.o)(e=>e.queType),x=(0,i.o)(e=>e.queList),q=(0,s.useRef)("计算"),h=(0,s.useRef)([]),w=(0,i.o)(e=>e.addQueHisList),T={"+":"plus","＋":"plus","-":"minus","－":"minus","*":"times",x:"times","\xd7":"times","/":"div","\xf7":"div"},v=(0,s.useRef)();(0,s.useEffect)(()=>{if(x.length&&!v.current)return v.current=c.Vq.alert({content:"点击开始答题",confirmText:"开始",onConfirm:()=>{N()}}),()=>{clearInterval(_.current),clearTimeout(b.current)}},[x]);let _=(0,s.useRef)(),I=()=>{_.current=setInterval(()=>{n(e=>e+1)},1e3)},b=(0,s.useRef)(),y=()=>{b.current=setTimeout(()=>{if(o.queTime<=0){clearTimeout(b.current),C().then(()=>{j()});return}o.queTime=o.queTime-1,y()},1e3)},C=()=>new Promise((e,t)=>{R(!0),setTimeout(()=>{e(1)},1e3),setTimeout(()=>{R(e=>!1)},1001)}),N=()=>{I();let e=x[f];q.current=e.name,h.current=e.list.sort((e,t)=>Math.random()-.5),o.curIndex=0};(0,s.useEffect)(()=>{if(o.curIndex<0)return;let e=h.current[o.curIndex];o.queText=e.toString().replace(/\s+/g,""),o.queTime=p,o.answer="",y()},[o.curIndex,h]);let S=()=>{let e=o.queText,t=e.split(/[+＋\-－*x×/÷]/g),n=e.match(/[+＋\-－*x×/÷]/g),r=new m.Z(parseFloat(t[0].trim()));for(let e=1;e<t.length;e++)r=r[T[n[e-1]]](new m.Z(parseFloat(t[e].trim())));let s=r.toNumber();console.log(s);let u=!1;s===parseFloat(o.answer)&&(u=!0);let c={que:e.replace(/\s+/g,""),answer:""===o.answer?"未答":parseFloat(o.answer),bingo:u,realAnswer:s};d.current.push(c)},j=()=>{if(clearTimeout(b.current),S(),o.curIndex>=h.current.length-1||o.curIndex>=g-1){L();return}o.curIndex++},L=()=>{console.log("onFinish");let n=d.current.filter(e=>e.bingo).length,r=d.current.length-n;w({name:x[f].name,createTime:H(new Date),totalTime:t,speed:p,bingoCount:n,errorCount:r,list:d.current}),c.Vq.confirm({content:"答对了"+n+"题, 答错"+r+"题, 用时"+t+"秒",confirmText:"返回",cancelText:"重新开始",onConfirm:()=>{e.push("/")},onCancel:()=>{window.location.reload()}})},H=function(e,t){function n(e){return(e=parseInt(e))<10?"0"+e:e}e||(e=new Date);var r,s=e.getFullYear(),u=n(e.getMonth()+1),c=n(e.getDate()),a=n(e.getHours()),i=n((r=parseInt(r=e.getHours()))>12?r-12:r),o=n(e.getMinutes()),l=n(e.getSeconds());return t?t=(t=(t=(t=(t=(t=(t=t.replace(/yyyy/g,s.toString())).replace(/MM/g,u)).replace(/dd/g,c)).replace(/HH/g,a)).replace(/hh/g,i)).replace(/mm/g,o)).replace(/ss/g,l):""+s+"-"+u+"-"+c+":"+a+":"+o+":"+l},[F,R]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"c-container",children:[(0,r.jsx)(c.l2,{className:"c-navbar",onBack:()=>{console.log("onBtnBack"),e.push("/")},children:q.current}),(0,r.jsxs)("div",{className:"c-content",children:[(0,r.jsx)("div",{className:l().timer,children:o.queTime}),(0,r.jsxs)("div",{className:l().queIndex,children:["第",o.curIndex+1,"/",g,"题"]}),(0,r.jsx)("div",{className:l()["c-cur-que"],children:o.queText}),(0,r.jsx)("div",{className:l()["c-my-answer"],children:o.answer}),(0,r.jsx)(c.JE,{onConfirm:j,onDelete:()=>{o.answer=o.answer.slice(0,o.answer.length-1)},onInput:e=>{o.answer=o.answer+e},visible:!0,showCloseButton:!1,customKey:".",confirmText:"确定"})]}),(0,r.jsx)(c.zd,{visible:F,children:(0,r.jsx)("div",{className:"c-loading c-timeup-text",children:"时间到,下一题"})})]})}},988:function(e,t,n){"use strict";n.d(t,{o:function(){return u}});var r=n(9099),s=n(9291);let u=(0,r.Ue)((0,s.tJ)((e,t)=>({bears:0,addABear:()=>e({bears:t().bears+1}),reset(){e({bears:0})},perSecond:5,setPerSecond(t){e({perSecond:t})},queCount:10,setQueCount(t){e({queCount:t})},queType:0,setQueType(t){e({queType:t})},queList:[],setQueList(t){e({queList:t})},queHisList:[],addQueHisList(n){let r=t().queHisList;r.length>=30&&r.pop(),e({queHisList:[n,...r]})}}),{name:"food-storage",storage:(0,s.FL)(()=>localStorage)}))},4542:function(e){e.exports={"c-cur-que":"page_c-cur-que__Sp8Aw","c-my-answer":"page_c-my-answer__cOTpY",timer:"page_timer__Qaq7y",queIndex:"page_queIndex__o3FB4"}}},function(e){e.O(0,[593,189,461,709,971,23,744],function(){return e(e.s=1242)}),_N_E=e.O()}]);