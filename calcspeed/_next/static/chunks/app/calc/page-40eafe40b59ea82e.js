(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{5042:function(){},1242:function(e,t,n){Promise.resolve().then(n.bind(n,4440))},4440:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(7437),u=n(2265),c=n(7351),s=n(1462),a=n(5219),o=n(988),i=n(4542),l=n.n(i),m=n(8243),d=n(8643);let p=(0,m.U)(d.$,{number:"BigNumber",precision:64});function f(){let e=(0,a.useRouter)(),[t,n]=(0,u.useState)(0),i=(0,c.Z)({queTime:0,answer:"",queText:"",curIndex:-1,canNext:!0}),m=(0,u.useRef)([]),d=(0,o.o)(e=>e.perSecond),f=(0,o.o)(e=>e.queCount),g=(0,o.o)(e=>e.queType),x=(0,o.o)(e=>e.queList),q=(0,u.useRef)("计算"),T=(0,u.useRef)([]),h=(0,o.o)(e=>e.addQueHisList),w={"＋":"+","－":"-",x:"*",X:"*","\xd7":"*","\xf7":"/","（":"(","）":")"},_=(0,u.useRef)();(0,u.useEffect)(()=>()=>{clearInterval(v.current),clearTimeout(N.current)},[]),(0,u.useEffect)(()=>{x.length&&!_.current&&(_.current=s.Vq.alert({content:"点击开始答题",confirmText:"开始",onConfirm:()=>{j()}}))},[x]);let v=(0,u.useRef)(),I=()=>{v.current=setInterval(()=>{n(e=>e+1)},1e3)},N=(0,u.useRef)(),y=()=>{N.current=setTimeout(()=>{if(i.queTime<=0){if(!N.current)return;clearTimeout(N.current),N.current=null,C().then(()=>{Q()});return}i.queTime=i.queTime-1,y()},1e3)},C=()=>new Promise((e,t)=>{R(!0),setTimeout(()=>{e(1)},1e3),setTimeout(()=>{R(e=>!1)},1001)}),j=()=>{I();let e=x[g];q.current=e.name,T.current=e.list.sort((e,t)=>Math.random()-.5),i.curIndex=0};(0,u.useEffect)(()=>{if(i.curIndex<0)return;let e=T.current[i.curIndex];i.queText=e.toString().replace(/\s+/g,""),i.queTime=d,i.answer="",y()},[i.curIndex,T]);let b=e=>{let t=RegExp(Object.keys(w).join("|"),"g");return e.replace(t,e=>w[e])},S=e=>e.replace(/(\.\d*?)0+$/,"$1").replace(/\.$/,""),L=()=>{let e=i.queText,t=b(e),n=p.evaluate(t);console.log(n=S(p.format(n,{notation:"fixed",precision:2})));let r=!1;parseFloat(n)===parseFloat(i.answer)&&(r=!0);let u={que:e.replace(/\s+/g,""),answer:""===i.answer?"未答":parseFloat(i.answer),bingo:r,realAnswer:n};m.current.push(u)},Q=()=>{if(i.canNext){if(i.canNext=!1,setTimeout(()=>{i.canNext=!0},180),clearTimeout(N.current),N.current=null,L(),i.curIndex>=T.current.length-1||i.curIndex>=f-1){H();return}i.curIndex++}},H=()=>{console.log("onFinish");let n=m.current.filter(e=>e.bingo).length,r=m.current.length-n;h({name:x[g].name,createTime:k(new Date),totalTime:t,speed:d,bingoCount:n,errorCount:r,list:m.current}),s.Vq.confirm({content:"答对了"+n+"题, 答错"+r+"题, 用时"+t+"秒",confirmText:"返回",cancelText:"重新开始",onConfirm:()=>{e.replace("/")},onCancel:()=>{window.location.reload()}})},k=function(e,t){function n(e){return(e=parseInt(e))<10?"0"+e:e}e||(e=new Date);var r,u=e.getFullYear(),c=n(e.getMonth()+1),s=n(e.getDate()),a=n(e.getHours()),o=n((r=parseInt(r=e.getHours()))>12?r-12:r),i=n(e.getMinutes()),l=n(e.getSeconds());return t?t=(t=(t=(t=(t=(t=(t=t.replace(/yyyy/g,u.toString())).replace(/MM/g,c)).replace(/dd/g,s)).replace(/HH/g,a)).replace(/hh/g,o)).replace(/mm/g,i)).replace(/ss/g,l):""+u+"-"+c+"-"+s+" "+a+":"+i+":"+l},[E,R]=(0,u.useState)(!1);return(0,r.jsxs)("div",{className:"c-container",children:[(0,r.jsx)(s.l2,{className:"c-navbar",onBack:()=>{console.log("onBtnBack"),e.replace("/")},children:q.current}),(0,r.jsxs)("div",{className:"c-content",children:[(0,r.jsx)("div",{className:l().timer,children:i.queTime}),(0,r.jsxs)("div",{className:l().queIndex,children:["第",i.curIndex+1,"/",f,"题"]}),(0,r.jsx)("div",{className:l()["c-cur-que"],children:i.queText}),(0,r.jsx)("div",{className:l()["c-my-answer"],children:i.answer}),(0,r.jsx)(s.JE,{onConfirm:Q,onDelete:()=>{i.answer=i.answer.slice(0,i.answer.length-1)},onInput:e=>{i.answer=i.answer+e},visible:!0,showCloseButton:!1,customKey:".",confirmText:"确定"})]}),(0,r.jsx)(s.zd,{visible:E,children:(0,r.jsx)("div",{className:"c-loading c-timeup-text",children:"时间到,下一题"})})]})}console.log(p.config())},988:function(e,t,n){"use strict";n.d(t,{o:function(){return c}});var r=n(9099),u=n(9291);let c=(0,r.Ue)((0,u.tJ)((e,t)=>({perSecond:5,setPerSecond(t){e({perSecond:t})},queCount:10,setQueCount(t){e({queCount:t})},queType:0,setQueType(t){e({queType:t})},queVal:["0","10","5"],setQueVal(t){e({queVal:t})},customQue:[],setCustomQue(t){e({customQue:t})},queList:[],setQueList(t){e({queList:t})},queHisList:[],addQueHisList(n){let r=t().queHisList;r.length>=30&&r.pop(),e({queHisList:[n,...r]})}}),{name:"mike-calc-storage",storage:(0,u.FL)(()=>localStorage)}))},4542:function(e){e.exports={"c-cur-que":"page_c-cur-que__Sp8Aw","c-my-answer":"page_c-my-answer__cOTpY",timer:"page_timer__Qaq7y",queIndex:"page_queIndex__o3FB4"}}},function(e){e.O(0,[1,462,261,274,971,23,744],function(){return e(e.s=1242)}),_N_E=e.O()}]);