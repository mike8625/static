(this["webpackJsonpaudio-comp-ts"]=this["webpackJsonpaudio-comp-ts"]||[]).push([[0],{106:function(e,t,n){e.exports=n(200)},111:function(e,t,n){},112:function(e,t,n){},163:function(e,t,n){},164:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},188:function(e,t,n){},189:function(e,t,n){},194:function(e,t,n){},200:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(10),o=n.n(r),c=(n(111),n(13)),s=n(12),l=n(17),u=n(16),m=(n(112),n(202),n(105)),d=(n(155),n(97)),p=(n(92),n(52)),f=(n(93),n(44)),h=(n(71),n(20)),v=n(51),b=(n(161),n(73)),g=(n(163),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={},e.onCancel=function(){e.props.onDialogCancel()},e.onAccept=function(){e.props.onDialogAccept()},e}return Object(s.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"c-dg-mask",style:{display:this.props.visible?"block":"none"}},i.a.createElement("div",{className:"c-dg-box"},i.a.createElement("div",{className:"c-dg-title"},this.props.title),i.a.createElement("div",{className:"c-dg-content"},this.props.children),i.a.createElement("div",{className:"c-dg-footer"},i.a.createElement(b.a,{size:"small",onClick:this.onCancel},"\u53d6\u6d88"),i.a.createElement(b.a,{size:"small",onClick:this.onAccept},"\u786e\u5b9a"))))}}]),n}(a.Component));g.defaultProps={visible:!1,title:"",onDialogCancel:function(){},onDialogAccept:function(){}};var y=g,E=(n(164),function(e,t,n){function a(e){return e>>0}var i=a(e/864e5),r=a(e%864e5/36e5),o=a(e%36e5/6e4),c=[a(e%6e4/1e3),o,r,i];if(t){for(var s=[1,60,60,24],l=c.length-1;l>=t;l--)c[l-1]+=c[l]*s[l];c=c.slice(0,t)}var u,m=new Array;if(n)for(var d=0;d<c.length;d++)m[d]=(u=c[d])<10?"0"+u:u+"";return m.reverse()}),k=function(e){return/^((https|http|ftp|rtsp|mms)?:\/\/)/.test(e)},C=function(e){var t=e.match(/\.([^\.]*)$/);return t?t[1]:""},O=function(e){return e.replace(/\.[^\.]*$/,"")},j=n(165);n(166);var w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).rec=null,a.wave=null,a.rs=null,a.started=!1,a.recordTime=0,a.state={dialogShow:!1,recording:!1,time:"00:00",canRecord:!1},a.recOpen=function(){a.rec=j({type:"mp3",sampleRate:16e3,bitRate:32,onProcess:function(e,t,n,i,r,o){n>3e5?a.onDgAccept():(a.recordTime=n,a.setTimeString(n),a.wave.input(e[e.length-1],t,i))}}),a.rec.open((function(){a.setState({canRecord:!0},(function(){setTimeout((function(){null==a.wave&&(a.wave=j.WaveView({elem:".c-rec-wave"})),a.wave.input(new Int16Array(1),0,1),a.onRecordBtnClick()}),1e3)}))}),(function(e,t){var n=(t?"\u7528\u6237\u62d2\u7edd\u6388\u6743\u6216\u4e0d\u652f\u6301\uff0c":"")+"\u65e0\u6cd5\u5f55\u97f3:"+e;h.a.alert("\u63d0\u793a",n)}))},a.setTimeString=function(e){var t=E(e,2,!0);a.setState({time:t.join(":")})},a.resetTime=function(){a.setState({time:"00:00"}),a.recordTime=0},a.onRecordBtnClick=function(){a.state.recording?(a.rec.pause(),a.setState({recording:!1})):(a.started?a.rec.resume():a.rec.start(),a.started=!0,a.setState({recording:!0}))},a.onDgCancel=function(){a.reset(),a.rec.stop((function(){a.rec.close(),a.rs(null)}))},a.onDgAccept=function(){!a.started||a.recordTime<2e3?h.a.alert("\u63d0\u793a","\u6ca1\u6709\u5f55\u97f3\u6216\u8005\u5f55\u97f3\u65f6\u95f4\u592a\u77ed"):(a.reset(),a.rec.stop((function(e,t){a.rec.close();var n=(window.URL||webkitURL).createObjectURL(e);a.rs(n)}),(function(e){a.rec.close()})))},a.reset=function(){a.closeDialog(),a.resetTime(),a.started=!1,a.setState({recording:!1})},a.props.onRef(Object(v.a)(a)),a}return Object(s.a)(n,[{key:"showDialog",value:function(){var e=this;return this.recOpen(),this.setState({dialogShow:!0}),new Promise((function(t,n){e.rs=t}))}},{key:"closeDialog",value:function(){this.setState({dialogShow:!1})}},{key:"render",value:function(){var e;return e=this.state.recording?i.a.createElement("i",{className:"c-recbtn-icon c-recbtn-pause"}):i.a.createElement("i",{className:"c-recbtn-icon c-recbtn-recording"}),i.a.createElement(y,{title:"\u5f55\u97f3",onDialogCancel:this.onDgCancel,onDialogAccept:this.onDgAccept,visible:this.state.dialogShow},i.a.createElement("div",{className:"c-rec-wave"}),i.a.createElement("div",{className:"c-rec-panel"},i.a.createElement("div",{className:"c-recbtn",style:{display:this.state.canRecord?"flex":"none"},onClick:this.onRecordBtnClick},e),i.a.createElement("div",{className:"c-no-rec",style:{display:this.state.canRecord?"none":"block"}},"\u8bf7\u6839\u636e\u63d0\u793a\u6388\u6743\u5f55\u97f3\u6743\u9650,\u5982\u957f\u65f6\u95f4\u6ca1\u6709\u53cd\u5e94,\u8bf4\u660e\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5f55\u97f3,\u53ef\u4ee5\u5c1d\u8bd5\u9009\u62e9\u6587\u4ef6\u4e2d\u7684\u5f55\u97f3\u6309\u94ae"),i.a.createElement("div",{className:"c-rectime",style:{display:this.state.canRecord?"block":"none"}},this.state.time)))}}]),n}(a.Component);w.defaultProps={onRef:function(e){}};var S,T,x,N=w,R=(n(167),n(168),n(49),n(26)),P=(n(169),n(77)),D=n(79),I=(n(188),n(189),function(e){e=e||"";var t=function(){o.a.render(i.a.cloneElement(n,{visible:!1}),a),o.a.unmountComponentAtNode(a),a.remove()},n=i.a.createElement(y,{title:"\u8bf7\u8f93\u5165\u5185\u5bb9",onDialogCancel:function(){t()},onDialogAccept:function(){var e=a.querySelector("textarea")||{value:""};r(e.value),t()},visible:!0},i.a.createElement("div",null,i.a.createElement("textarea",{className:"c-inputwin-text"}))),a=document.createElement("div");document.body.append(a),o.a.render(n,a);var r,c=a.querySelector("textarea");return c&&(c.value=e),new Promise((function(e,t){r=e}))}),A=n(36),F=Object(A.a)(S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currentTime:0,duration:0,muted:!1,paused:!0,volume:0,totalTimeStr:"00:00",currentTimeStr:"00:00",active:!1},e.refs=i.a.createRef(),e.releaseUrl=function(){e.refs.au.src.startsWith("blob:")&&window.URL.revokeObjectURL(e.refs.au.src)},e.errorFun=function(e){h.a.alert("\u63d0\u793a","\u64ad\u653e\u5931\u8d25")},e.endFun=function(t){e.setState({paused:!0})},e.timeFun=function(t){var n=Math.ceil(t.target.currentTime);e.setState({currentTime:n,currentTimeStr:e.getCurrentTimeStr(n)})},e.loadFun=function(t){var n=Math.ceil(t.target.duration);e.setState({duration:n,totalTimeStr:e.getTotalTimeStr(n)})},e.setTimeString=function(t){e.setState({currentTime:t})},e.resetTime=function(){e.setState({currentTime:0})},e.setDisabled=function(){e.setState({muted:!e.state.muted})},e.onBtnPlayClick=function(){e.refs.au.play(),e.setState({paused:!1,active:!0}),e.props.onPlay(e.props.item.id)},e.onBtnPauseClick=function(){e.refs.au.pause(),e.setState({paused:!0,active:!1})},e.onTimeSliderChange=function(t){console.log(t),e.refs.au.currentTime=t},e.onEditText=function(){I(e.props.item.text).then((function(t){var n=Object(D.a)({},e.props.item);n.text=t,e.props.store.editItem(n)}))},e.getCurrentTimeStr=function(e){return E(1e3*e,2,!0).join(":")},e.getTotalTimeStr=function(e){return E(1e3*e,2,!0).join(":")},e.onVolumeSliderChange=function(t){e.refs.au.volume=t},e.onAudioNameClick=function(){h.a.prompt("\u8bf7\u8f93\u5165\u540d\u79f0","",[{text:"\u53d6\u6d88",onPress:function(e){return new Promise((function(e){e()}))}},{text:"\u786e\u5b9a",onPress:function(t){return new Promise((function(n,a){""==(t=t.trim())&&(f.a.info("\u8bf7\u8f93\u5165\u540d\u79f0"),a());var i=Object(D.a)({},e.props.item);i.name=t,e.props.store.editItem(i),n()}))}}],"default",e.props.item.name,["\u8bf7\u8f93\u5165\u540d\u79f0"])},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.refs.au.addEventListener("timeupdate",this.timeFun,!1),this.refs.au.addEventListener("loadedmetadata",this.loadFun,!1),this.refs.au.addEventListener("ended",this.endFun,!1),this.refs.au.addEventListener("error",this.errorFun,!1)}},{key:"componentWillUnmount",value:function(){this.refs.au.pause(),this.refs.au.removeEventListener("timeupdate",this.timeFun,!1),this.refs.au.removeEventListener("loadedmetadata",this.loadFun,!1),this.refs.au.removeEventListener("ended",this.endFun,!1),this.refs.au.removeEventListener("error",this.errorFun,!1)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.state.active?"c-item-box c-item-active":"c-item-box"},i.a.createElement("audio",{src:this.props.item.url,ref:"au"}),i.a.createElement("div",{className:"c-item-head"},this.state.paused?i.a.createElement("i",{className:"c-item-playbtn",onClick:this.onBtnPlayClick}):i.a.createElement("i",{className:"c-item-pausebtn",onClick:this.onBtnPauseClick}),i.a.createElement("span",{className:"c-item-audioname",onClick:this.onAudioNameClick},this.props.item.name||"------"),i.a.createElement("span",{className:"icon iconfont icon-yinliang1 ".concat(this.state.muted?"disabled":null),onClick:this.setDisabled}),i.a.createElement("div",{className:"c-item-volume"},i.a.createElement(P.a,{onChange:this.onVolumeSliderChange,defaultValue:1,step:.1,min:0,max:1,handleStyle:{borderColor:"#ffffff",height:"18px",width:"18px",marginLeft:"-7px",marginTop:"-8px",backgroundColor:"#ffffff"},trackStyle:{backgroundColor:"#cdcdcd"}}))),i.a.createElement("div",{className:"c-item-body"},i.a.createElement("div",{className:"c-item-time"},this.state.currentTimeStr,"/",this.state.totalTimeStr),i.a.createElement("div",{className:"c-item-progressbox"},i.a.createElement(P.a,{onChange:this.onTimeSliderChange,defaultValue:0,value:this.state.currentTime,min:0,max:this.state.duration,handleStyle:{borderColor:"#ffffff",backgroundColor:"#ffffff"},trackStyle:{backgroundColor:"#cdcdcd"}})),i.a.createElement("span",{className:"icon iconfont icon-bianji c-item-text",onClick:this.onEditText})),i.a.createElement("div",{className:"c-item-foot",style:{display:""===this.props.item.text?"none":"block"}},this.props.item.text),i.a.createElement(R.a,{className:"c-item-closebtn",type:"cross-circle-o",size:"md",onClick:function(t){e.props.onRemove(e.props.item.id)}}))}}]),n}(a.Component))||S,L=Object(A.a)(T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={subTitle:"\u8bf7\u8f93\u5165\u6807\u9898",dialogShow:!1,disabled:!1},e.refs=i.a.createRef(),e.subTileChanged=!1,e.setDisabled=function(){e.setState({disabled:!e.state.disabled})},e.onChangeSubTitle=function(){var t=e.subTileChanged?e.state.subTitle:"";h.a.prompt("\u8bf7\u8f93\u5165\u5185\u5bb9","",[{text:"\u53d6\u6d88",onPress:function(e){return new Promise((function(e){e()}))}},{text:"\u786e\u5b9a",onPress:function(t){return new Promise((function(n,a){t=t.trim(),e.setState({subTitle:t}),e.subTileChanged=!0,n()}))}}],"default",t,["\u8bf7\u8f93\u5165\u5185\u5bb9"])},e.onFileSelect=function(t){var n=t.target.files[0],a=C(n.name);if(["mp3","wav","ogg","webm","aac","m4a"].includes(a.toLowerCase())){var i=URL.createObjectURL(n),r={id:e.generateId(),url:i,name:O(n.name),text:""};e.addAudioObject(r),t.target.value=""}else f.a.info("\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u683c\u5f0f")},e.onItemRemove=function(t){h.a.alert("\u63d0\u793a","\u786e\u8ba4\u5220\u9664?",[{text:"\u53d6\u6d88",onPress:function(){return console.log("cancel")}},{text:"\u786e\u5b9a",onPress:function(){e.props.store.delItem(t)}}])},e.onItemPlay=function(t){for(var n=0;n<e.props.store.list.length;n++)n!=t&&e.refs["player"+n].onBtnPauseClick()},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"c-page-con"},i.a.createElement(p.a,{mode:"light",leftContent:i.a.createElement("span",{className:"icon iconfont icon-shezhi c-nav-icon",onClick:function(){e.onSetting()}}),rightContent:i.a.createElement("span",{className:"icon iconfont icon-tianjia c-nav-icon",onClick:function(){e.onAdd()}})},"Audio Compare"),this.props.store.hideTitle?i.a.createElement(d.a,{size:"xl"}):i.a.createElement("div",{className:"c-main-subtitlebox",onClick:this.onChangeSubTitle},i.a.createElement("span",null,this.state.subTitle||"\ud83c\udfb5\ud83c\udfb5\ud83c\udfb5"),i.a.createElement("i",null)),i.a.createElement("input",{type:"file",ref:"auFile",accept:"audio/*",onChange:this.onFileSelect,style:{display:"none"}}),i.a.createElement("div",null,this.props.store.list.map((function(t,n){return i.a.createElement(F,{key:t.id,store:e.props.store,ref:"player"+n,item:t,onRemove:e.onItemRemove,onPlay:function(){e.onItemPlay(n)}})}))),i.a.createElement(N,{ref:"rwin"}))}},{key:"componentDidMount",value:function(){}},{key:"generateId",value:function(){return(1e4*Math.random()).toString()}},{key:"onSetting",value:function(){this.props.history.push("/Setting")}},{key:"test1",value:function(){}},{key:"onAdd",value:function(){var e=this,t=["\u9009\u62e9\u6587\u4ef6","\u8f93\u5165\u7f51\u5740","\u5f55\u97f3","\u53d6\u6d88"];m.a.showActionSheetWithOptions({options:t,cancelButtonIndex:t.length-1,message:"\u8bf7\u9009\u62e9\u6dfb\u52a0\u65b9\u5f0f",maskClosable:!0},(function(t){switch(console.log(t),t){case 0:e.setFile();break;case 1:e.setUrl();break;case 2:e.setRecorder()}}))}},{key:"setFile",value:function(){this.refs.auFile.click()}},{key:"setUrl",value:function(){var e=this;h.a.prompt("\u8bf7\u8f93\u5165\u7f51\u5740","",[{text:"\u53d6\u6d88",onPress:function(e){return new Promise((function(e){e()}))}},{text:"\u786e\u5b9a",onPress:function(t){return new Promise((function(n,a){""!=(t=t.trim())&&k(t)||(f.a.info("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f51\u5740"),a());var i={id:e.generateId(),url:t,name:"",text:""};e.addAudioObject(i),n()}))}}],"default","",["\u8bf7\u8f93\u5165\u7f51\u5740"])}},{key:"addAudioObject",value:function(e){var t=this.props.store.list;""==e.name&&(e.name="\u97f3\u9891"+(t.length+1)),this.props.store.addItem(e)}},{key:"setRecorder",value:function(){var e=this;this.refs.rwin.showDialog().then((function(t){if(null!=t){var n={id:e.generateId(),url:t,name:"",text:""};e.addAudioObject(n)}}))}}]),n}(a.Component))||T,U=n(100),B=(n(190),n(37)),_=(n(192),n(101));n(194);function z(){var e=Object(U.a)(["\n      width: 120px;\n      height: 120px;\n      background-color: #1E7FF8;\n      border-radius: 50%;\n      margin: 30px auto;\n      position: relative;\n      box-shadow: 2px 2px 4px 2px #8e8c8c;\n      .center {\n        width: 40px;\n        height: 40px;\n        background: #FFFFFF;\n        border-radius: 50%;\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n      }\n      >div{  // \u6559\u7a0b\u524d\u9762\u8fd8\u52a0\u4e86\u4e00\u4e2a&\u8868\u793a\u7236\u5143\u7d20 ,\u4e0d\u52a0\u597d\u50cf\u4e5f\u884c\n          display:none;\n      }\n      &{  // &\u8868\u793a\u7236\u5143\u7d20\n          display:none;\n      }\n"]);return z=function(){return e},e}var H=n(195).default;console.log(H);var M,W,V,q=Object(A.a)(x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"c-page-con"},i.a.createElement(p.a,{mode:"light",icon:i.a.createElement(R.a,{type:"left"}),onLeftClick:function(){e.props.history.goBack()}},"Setting"),i.a.createElement(B.a,{renderHeader:function(){return"\u8bbe\u7f6e"}},i.a.createElement(B.a.Item,{extra:i.a.createElement(_.a,{checked:this.props.store.hideTitle,onChange:function(){e.props.store.setTitleHidden(!e.props.store.hideTitle)}})},"\u9690\u85cf\u6807\u9898\u6587\u5b57")),i.a.createElement(B.a,{renderHeader:function(){return"\u5173\u4e8e"}},i.a.createElement(B.a.Item,{extra:i.a.createElement("span",null,"\u5c0f\u6b23")},"\u4f5c\u8005"),i.a.createElement(B.a.Item,{extra:i.a.createElement("span",null,"41156358")},"\u5fae\u4fe1")),i.a.createElement(J,null,i.a.createElement("div",{className:"center"})))}},{key:"componentDidMount",value:function(){}}]),n}(a.Component))||x,J=H.div(z()),$=n(74),G=n(29),K=(n(197),n(9)),Q=new(M=function(){function e(){Object(c.a)(this,e),Object($.a)(this,"hideTitle",W,this),Object($.a)(this,"list",V,this),this.init()}return Object(s.a)(e,[{key:"setTitleHidden",value:function(e){this.hideTitle=e,localStorage.audio_comp_hide_title=e?1:0,console.log(localStorage.audio_comp_hide_title)}},{key:"delItem",value:function(e){for(var t=0;t<this.list.length;t++)if(this.list[t].id==e){var n=this.list[t].url;return this.list.splice(t,1),void(n.startsWith("blob:")&&window.URL.revokeObjectURL(n))}}},{key:"addItem",value:function(e){this.list.push(e)}},{key:"editItem",value:function(e){for(var t=0;t<this.list.length;t++)if(this.list[t].id==e.id)return void this.list.splice(t,1,e)}}]),Object(s.a)(e,[{key:"releasUrl",value:function(){this.list.forEach((function(e){e.url.startsWith("blob:")&&window.URL.revokeObjectURL(e.url)}))}},{key:"init",value:function(){var e=this;this.hideTitle="1"==localStorage.audio_comp_hide_title,window.addEventListener("unload",(function(){e.releasUrl()}),!1)}}]),e}(),W=Object(G.a)(M.prototype,"hideTitle",[K.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(G.a)(M.prototype,"setTitleHidden",[K.f],Object.getOwnPropertyDescriptor(M.prototype,"setTitleHidden"),M.prototype),V=Object(G.a)(M.prototype,"list",[K.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(G.a)(M.prototype,"delItem",[K.f],Object.getOwnPropertyDescriptor(M.prototype,"delItem"),M.prototype),Object(G.a)(M.prototype,"addItem",[K.f],Object.getOwnPropertyDescriptor(M.prototype,"addItem"),M.prototype),Object(G.a)(M.prototype,"editItem",[K.f],Object.getOwnPropertyDescriptor(M.prototype,"editItem"),M.prototype),M),X=n(201),Y=X.HashRouter,Z=(X.Link,X.Route),ee=X.Redirect,te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return i.a.createElement(Y,null,i.a.createElement("div",{className:"App"},i.a.createElement(Z,{path:"/",exact:!0,render:function(e){return i.a.createElement(L,Object.assign({},e,{store:Q}))}}),i.a.createElement(Z,{path:"/setting",render:function(e){return i.a.createElement(q,Object.assign({},e,{store:Q}))}}),i.a.createElement(ee,{path:"/comp",to:"/"})))}}]),n}(a.Component);n(199);o.a.render(i.a.createElement(te,null),document.getElementById("root"))}},[[106,1,2]]]);
//# sourceMappingURL=main.d2b1c76a.chunk.js.map