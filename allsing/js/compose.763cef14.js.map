{"version":3,"file":"js/compose.763cef14.js","mappings":"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","sources":["webpack://allsing/./src/components/SettingDialog.vue","webpack://allsing/./src/components/SettingDialog.vue?de02","webpack://allsing/./src/views/ComposeView.vue","webpack://allsing/./src/views/ComposeView.vue?b024"],"sourcesContent":["<template>\n  <van-dialog v-model:show=\"isVisible\" title=\"设置\" @close=\"onCloseDialog\">\n    <div class=\"c-setting-box\">\n      <van-cell title=\"歌词同步\" :value=\"store.lrcDelayTime\" />\n      <div class=\"c-setting-sliderbox\">\n        <van-slider\n          v-model=\"store.lrcDelayTime\"\n          @change=\"onlrcDelayChange\"\n          min=\"-2\"\n          max=\"2\"\n          step=\"0.1\"\n        />\n      </div>\n      <van-cell title=\"歌词编码\" />\n      <div class=\"c-setting-sliderbox\">\n        <van-radio-group v-model=\"store.lrcEncoding\" direction=\"horizontal\" @change=\"onLrcEncodingChange\">\n          <van-radio name=\"GBK\">GBK</van-radio>\n          <van-radio name=\"UTF-8\">UTF-8</van-radio>\n        </van-radio-group>\n      </div>   \n      <van-cell title=\"伴奏音量\" :value=\"store.banzouVolume*100\" />\n      <div class=\"c-setting-sliderbox\">\n        <van-slider\n          v-model=\"store.banzouVolume\"\n          @change=\"onBanzouVolumeChange\"\n          min=\"0\"\n          max=\"1\"\n          step=\"0.1\"\n        />\n      </div>\n      <van-cell title=\"伴奏音调\" :value=\"store.banzouPitch * 10\" />\n      <div class=\"c-setting-sliderbox\">\n        <van-slider\n          v-model=\"store.banzouPitch\"\n          @change=\"onBanzouPitchChange\"\n          min=\"-1.1\"\n          max=\"1.1\"\n          step=\"0.1\"\n        />        \n      </div>         \n    </div>\n  </van-dialog>    \n</template>\n\n<script>\nimport useStore from \"../store\";\nimport { ref, watch } from \"vue\";\nexport default {\n  name: \"setting\",\n  props: {\n    visible: { type: Boolean, default: false },\n  },\n  emits: ['update:visible'],  \n  setup(props, { emit }) {\n    // 不把store写在这,初始化的好多值就报错\n    const store = useStore();\n    const isVisible = ref(props.visible);  \n  \n    // 监听props中的visible变化，更新isVisible  \n    watch(() => props.visible, (newVal) => {  \n      console.log(newVal);\n      isVisible.value = newVal;  \n    });   \n    // 如果需要从外部关闭对话框，可以定义一个方法来关闭 \n    let onCloseDialog = ()=> {  \n      console.log('关闭对话框');\n      emit('update:visible', false);  \n    } \n    return { store, isVisible, onCloseDialog };\n  },\n  methods: {\n    onlrcDelayChange (val) {\n      // 改歌词延迟只需要重新解析即可\n      this.store.parseLRC()\n    },\n    onLrcEncodingChange (val) {\n      // 改编码要重新读取文件 \n      this.store.readLrcText()\n    },\n    onBanzouVolumeChange(val) {\n      this.store.banzouVolume = val;\n    },\n    onBanzouPitchChange(val) {\n      this.store.banzouPitch = val;\n    }\n  }\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n\n.c-setting-box {\n  text-align: left;\n}\n.c-setting-sliderbox {\n  padding: 16px 20px;\n}\n</style>\n","import { render } from \"./SettingDialog.vue?vue&type=template&id=521478c4&scoped=true\"\nimport script from \"./SettingDialog.vue?vue&type=script&lang=js\"\nexport * from \"./SettingDialog.vue?vue&type=script&lang=js\"\n\nimport \"./SettingDialog.vue?vue&type=style&index=0&id=521478c4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-521478c4\"]])\n\nexport default __exports__","<template>\n  <div class=\"container compose\">\n    <van-nav-bar\n      title=\"合成\"\n      left-text=\"主页\"\n      @click-left=\"onBack()\"\n      right-text=\"设置\"\n      @click-right=\"onSetting\"      \n    />\n    <!-- <audio\n      ref=\"audio\"\n      style=\"display: none\"\n      @ended=\"finish\"\n      @loadedmetadata=\"onLoadedMetadata\"\n    ></audio> -->\n    <div class=\"content content-compose\">\n      <div class=\"c-e-name c-e-name-crop\">{{ musicName }}</div>\n      <div class=\"c-e-ctrlbox\">\n        <div class=\"c-e-ctrlitem\">\n          <van-icon\n            v-show=\"playing\"\n            name=\"pause-circle-o\"\n            class=\"c-e-ctrlicon\"\n            @click=\"onPause\"\n          />\n          <van-icon\n            name=\"play-circle\"\n            class=\"c-e-ctrlicon\"\n            v-show=\"!playing\"\n            @click=\"onPlay\"\n          />\n        </div>\n        <div class=\"c-e-sliderbox-time\">\n          {{ util.convertTime(curTime) }}\n        </div>\n        <div class=\"c-e-sliderbox\">\n          <van-slider v-model=\"curTime\" @change=\"onDurationChange\" :max=\"audioDuration\" @drag-start=\"dragging = true\" @drag-end=\"dragging = false\" />\n        </div>\n        <div class=\"c-e-sliderbox-time\">{{ util.convertTime(audioDuration) }}</div>\n      </div>\n      <div class=\"c-co-lrcbox\">\n        {{ curLrc }}\n      </div> \n      <div class=\"c-e-title\">\n        <span>伴奏音量</span><span>{{ accompanyVal }}</span>\n      </div>\n      <div class=\"c-e-voicebox c-co-voicebox\">\n        <van-slider min=\"0\" max=\"100\" v-model=\"accompanyVal\" @change=\"onAccompanyVoiceChange\" />\n      </div>      \n      <div class=\"c-e-title\">\n          <span>压缩音频</span>\n          <van-switch v-model=\"store.compress\" />\n        </div>      \n      <div class=\"c-co-imgbox\" v-show=\"imgList.length\">\n        <div class=\"c-co-imgtitle\">\n          <span>images:</span>\n          <van-radio-group v-model=\"orient\" direction=\"horizontal\" @change=\"onOrientChange\">\n            <van-radio name=\"0\">landscape</van-radio>\n            <van-radio name=\"1\">portrait</van-radio>\n          </van-radio-group>\n        </div>\n        <div :class=\"orient == '0' ? 'c-co-imglist': 'c-co-imglist portrait'\">\n          <div class=\"c-co-imgitem\" v-for=\"(item,index) of imgList\" :key=\"index\" :style=\"getBg(item)\">\n            <van-icon name=\"close\" class=\"c-co-imgrev\" @click=\"onRemoveImg(item, index)\"/>\n          </div>\n        </div>\n      </div>\n      <div class=\"c-e-editbox c-co-editbox\">\n        <!--  -->\n        <div class=\"c-co-item\" v-for=\"(item, index) of filelist\" :key=\"index\">\n          <audio :src=\"item.file.url\" ref=\"setItemRef\" class=\"c-co-audio\" />\n          <div class=\"c-co-namebox\">\n            <div class=\"c-co-itemname\">{{ item.file.name.replace(/\\.(mp3|wav)$/i, \"\") }}</div>\n          </div>\n          <div class=\"c-co-volbox\">\n            <span class=\"c-co-volname\">音量:&nbsp;<b>{{ item.volume }}</b></span>\n            <van-slider\n              class=\"c-co-volslider\"\n              v-model=\"item.volume\"\n              @change=\"onVolumeChange(item, index)\"\n            />\n          </div>\n          <div class=\"c-co-volbox\">\n            <span class=\"c-co-volname\">迟延:&nbsp;<b>{{ item.delay }}</b></span>\n            <van-slider\n              min=\"-2\"\n              max=\"2\"\n              step=\"0.1\"\n              class=\"c-co-volslider c-co-volslider-delay\"\n              v-model=\"item.delay\"\n              @change=\"onDelayChange(item, index)\"\n            />\n          </div>    \n          <div class=\"c-co-volbox\">\n            <div class=\"c-co-volname\">混响</div>\n            <div class=\"c-co-reverbbox\">\n              <!-- <van-radio-group v-model=\"item.reverb\" direction=\"horizontal\" @change=\"onReverbChange(item, index)\">\n                <van-radio class=\"c-co-reverbitem\" :name=\"0\">none</van-radio>\n                <van-radio class=\"c-co-reverbitem\" :name=\"1\">reverse</van-radio>\n                <van-radio class=\"c-co-reverbitem\" :name=\"2\">reverse2</van-radio>\n                <van-radio class=\"c-co-reverbitem\" :name=\"3\">reverse3</van-radio>\n              </van-radio-group> -->\n              <van-button v-show=\"item.reverb\" plain type=\"primary\" size=\"small\" class=\"c-e-cusbtn\" @click=\"onReverbSetting(item, index)\">设置</van-button>\n              <van-switch  v-model=\"item.reverb\" @change=\"(b)=>{onReverbChange(b, item, index)}\" />\n            </div>\n          </div>\n          <van-icon name=\"close\" class=\"c-co-remove\" @click=\"onVoiceRemove(item, index)\"/>\n        </div>\n      </div>\n      <div class=\"c-e-btnbox c-co-btnbox\">\n        <div class=\"c-co-innerbox\">\n          <input type=\"file\" multiple ref=\"imgFile\" style=\"display: none\" @change=\"onImgFileSelect\" />\n          <!-- 暂时去掉这个功能 发现了一个软件可以实现这样的功能, 就不自己实现了:-) -->\n          <!-- <van-button plain class=\"c-e-btn\" type=\"warning\" @click=\"onImgAdd\">image</van-button> -->\n          <input type=\"file\" ref=\"audioFile\" style=\"display: none\" @change=\"onAudioFileSelect\" />\n          <van-button class=\"c-e-btn\" type=\"primary\" @click=\"onAudioAdd\">添加人声</van-button>\n          <van-button round class=\"c-e-btn c-e-btn-r\" type=\"success\" @click=\"compose\">合成歌曲</van-button>\n        </div>\n      </div>\n    </div>\n  </div>\n  <SettingDialog v-model:visible=\"settingShow\" :data=\"curReverbData\"/>\n  <ReverbDialog ref=\"rbDlg\" @change=\"onReverbDetailChange\" @close=\"curReverbItem=null\"/>\n\n</template>\n<script>\n// @ is an alias to /src\nimport { ref } from \"vue\";\nimport useStore from \"../store\";\nimport SettingDialog from \"../components/SettingDialog\";\nimport ReverbDialog from \"../components/ReverbDialog\";\nimport util from \"../common/js/util.js\";\nimport { renderProgress }from \"../common/js/progress.js\";\nimport downloadAudio from \"../common/js/downloadAudio.js\";\nimport {stopDownload} from \"../common/js/downloadAudio.js\";\nimport { showToast } from \"vant\";\nimport createPizzicato from \"../common/js/Pizzicato.js\";\nlet Pizzicato;\n\nexport default {\n  name: \"ComposeView\",\n  components: {SettingDialog, ReverbDialog},\n  setup() {\n    Pizzicato = createPizzicato(new (window.AudioContext || window.webkitAudioContext)());\n    console.log(\"compose.......\")\n    // 不把store写在这,初始化的好多值就报错\n    const store = useStore();\n    const rbDlg = ref(null);\n    return { store, util, rbDlg };\n  },\n  data() {\n    return {\n      audioContext: null,\n      offlineAudioCtx: null,\n      musicName: \"\",\n      // 音频总时长\n      audioDuration: 0,\n      // 当前播放时间\n      curTime: 0,\n      // 当前歌词\n      curLrc: \"\",\n      dragging: false,\n      accompanyVal: 0,\n      playing: false,\n      orient: \"0\",\n      settingShow: false,\n      remainTime: 0,\n      imgList: [\n      ],\n      filelist: [\n      ],\n      rbSettingShow: false,\n      curReverbData: {},\n    };\n  },\n  mounted() {\n    if(!this.store.banzou) {\n      alert(\"没有找到需要编辑的音频\");\n      this.$router.replace(\"/\");\n      return;\n    }\n    \n    this.audioContext = Pizzicato.context;\n    console.log(this.audioContext)\n    this.init(this.store.banzou);\n  },\n  unmounted() {\n    if(this.rTimer) {\n      cancelAnimationFrame(this.rTimer);\n    }\n    for(let i = 0; i < this.filelist.length; i++) {\n      const item = this.filelist[i];\n      if(item.delayPlayTimer) {\n        clearTimeout(item.delayPlayTimer);\n        item.delayPlayTimer = null;\n      }\n      item.voiceSource.disconnect();\n      item.voiceSource.buffer = null;       \n    }\n    this.fileList = [];\n    try {\n      this.bgSource.disconnect();\n      this.bgSource.buffer = null;\n    }catch(e){}\n\n    try {\n      this.audioContext.close();\n    }catch(e){\n      console.log(e);\n    }\n    try {\n      if(this.offlineAudioCtx) {\n        if(this.offlineAudioCtx.state == \"running\") {\n          this.offlineAudioCtx.suspend(this.offlineAudioCtx.currentTime);\n        }\n        this.offlineAudioCtx = null;\n      }\n    }catch(e){\n      console.log(e);\n    }\n    console.log(\"hide loading\")\n    this.store.hideLoading();\n    this.store.hideProgess();\n    stopDownload();\n    renderProgress.stop();\n    Pizzicato = null;\n  },\n  watch: {\n    // 监视全局伴奏音量变化\n    \"store.banzouVolume\": {\n      handler() {\n        if (this.audioContext) {\n          this.accompanyVal = this.store.banzouVolume * 100;\n          this.bgGain.gain.value = this.store.banzouVolume;          \n        }\n      },\n    },\n  },\n  methods: {\n    onReverbSetting(item, index){\n      this.rbDlg.show({        \n        time: item.reverbNode.time, \n        decay: item.reverbNode.decay, \n        mix: item.reverbNode.mix\n      });\n      this.curReverbItem = item;\n    },\n    async init(accompanimentBlob) {\n      this.musicName = this.store.banzou.name.replace(/\\.mp3$/i, \"\");\n      this.store.showLoading();\n      // 1. 加载伴奏音频\n      const accompanimentBuffer = await this.loadAudioData(this.audioContext,accompanimentBlob);\n      const recordDuration = accompanimentBuffer.duration;\n      this.audioDuration = recordDuration;\n      // 2. 创建合成音频缓冲区，长度为设定的伴奏总时长\n      const sampleRate = this.audioContext.sampleRate;\n      const totalLength = recordDuration * sampleRate;\n\n      const bgBuffer = this.audioContext.createBuffer(2, totalLength, sampleRate); // 双声道\n\n      // 3. 插入伴奏到合成缓冲区\n      bgBuffer.getChannelData(0).set(accompanimentBuffer.getChannelData(0).subarray(0, totalLength));\n      let n = 0;\n      if(accompanimentBuffer.numberOfChannels > 1){\n        n = 1;\n      }      \n      bgBuffer.getChannelData(1).set(accompanimentBuffer.getChannelData(n).subarray(0, totalLength));\n      \n      const bgSource = this.audioContext.createBufferSource();\n      bgSource.buffer = bgBuffer;\n\n      this.bgGain = this.audioContext.createGain();\n      this.accompanyVal = this.store.banzouVolume * 100;\n      this.bgGain.gain.value = this.store.banzouVolume;\n      // this.accompanyVal = Math.round(this.bgGain.gain.value * 100);\n      bgSource.connect(this.bgGain);  \n      Tone.setContext(this.audioContext);\n      var pitchShift = new Tone.PitchShift();\n      pitchShift.pitch = this.store.banzouPitch;  \n      Tone.connect(this.bgGain, pitchShift);    \n      // this.bgGain.connect(this.audioContext.destination);\n      Tone.connect(pitchShift, this.audioContext.destination);\n\n     \n      this.bgSource = bgSource;\n\n      this.remainTime = this.audioContext.currentTime;\n      \n      //this.setCurTime();\n      if(this.store.lrc) {\n        await this.store.readLrcText()\n      }\n\n      // 同时播放\n      this.audioContext.suspend();\n      bgSource.start(); \n      this.store.hideLoading();\n      // voiceSource.start();\n    },  \n    loadAudioData(audioContext, blob) {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = () => {\n          audioContext\n            .decodeAudioData(reader.result)\n            .then((audioBuffer) => resolve(audioBuffer))\n            .catch((err) => reject(err));\n        };\n        reader.onerror = () => reject(reader.error);\n        reader.readAsArrayBuffer(blob);\n      });\n    }, \n    setCurTime() {\n      let n = this.audioContext.currentTime - this.remainTime;\n      if(n >= this.audioDuration){\n        this.doStop(true);\n        return;\n      }\n      if(!this.dragging) {\n        this.curTime = n;\n      }\n      this.onTimeUpdate();\n      //console.log(\"curTime-> \", this.curTime,  this.store.banzouLength);\n      this.rTimer = requestAnimationFrame(this.setCurTime);\n    },    \n    onAccompanyVoiceChange(n) {\n      if (this.bgGain) {\n        this.bgGain.gain.value = n / 100;\n        this.store.banzouVolume = n / 100;\n      }\n    },    \n    doStop(goStart) {\n      console.log(this.audioContext.state)\n      if(this.audioContext.state == \"running\") {\n        this.playing = false;\n        this.audioContext.suspend();\n        if(goStart) {\n          this.curTime = 0;\n          this.rTimer = null;\n          this.remainTime = this.audioContext.currentTime;\n        }\n        // this.bgSource.stop();\n        // this.voiceSource.stop();\n      }\n    },   \n    jumpTo(n) {\n      try {\n        this.bgSource.stop();\n      }catch(e){\n      }\n      const newBgSource = this.audioContext.createBufferSource();\n      newBgSource.buffer = this.bgSource.buffer;  \n      this.bgSource.disconnect();\n      this.bgSource.buffer = null;\n      newBgSource.connect(this.bgGain);  \n      this.bgSource = newBgSource;\n      this.bgSource.start(0, n);\n\n      for(let index = 0; index < this.filelist.length; index++) {\n        let item = this.filelist[index];\n        try{\n          item.voiceSource.stop();\n        }catch(e){}\n        const newVoiceSource = this.audioContext.createBufferSource();\n        //console.log(item)\n        console.log(item.voiceSource)\n        newVoiceSource.buffer = item.voiceSource.buffer;  \n        item.voiceSource.disconnect(); \n        item.voiceSource.buffer = null;\n        newVoiceSource.connect(item.gainNode);  \n        item.voiceSource = newVoiceSource;\n        //newVoiceSource.start();\n        this.startVoiceSource(n, item);        \n      }\n      // console.log(\"jumpTo-> \", n\n      // this.voiceSource.stop();\n      // const newVoiceSource = this.audioContext.createBufferSource();\n      // newVoiceSource.buffer = this.voiceSource.buffer;  \n      // this.voiceSource.disconnect();\n      // newVoiceSource.connect(this.voiceGain);  \n      // this.voiceSource = newVoiceSource;\n      // //newVoiceSource.start();\n      // this.startVoiceSource(n);\n    },    \n\n    // 人声播放\n    startVoiceSource(n = 0, item) {\n\n      if(item.delayPlayTimer){\n        clearTimeout(item.delayPlayTimer);\n        item.delayPlayTimer = null;\n      }\n      //  第一个参数很坑, source.start(迟延几秒播放, 从第几秒开始); 结果第一个参数总不准 所以我就只设置成0 然后用setTimeout来延迟\n      let offsetTime = 0;\n      offsetTime = n + item.delay;\n      if(offsetTime >= 0) {\n        item.voiceSource.start(0, offsetTime);\n      }\n      else {\n        let n = offsetTime * -1000;\n        offsetTime = 0;\n        item.delayPlayTimer = setTimeout(()=>{\n          item.voiceSource.start(0, offsetTime);\n        }, n)        \n      }\n\n      // let delayTime = 0;\n      // let offsetTime = 0;\n      // // 人声调快\n      // if(item.delay < 0) {\n      //   delayTime = item.delay * -1; //人声调慢\n      // }\n      // // 如果开始就有人声 会把调快的0.x秒那部分弄没了 一般不会马上就有人声\n      // else if(item.delay > 0) {\n      //   offsetTime = n + item.delay; // 人声调快\n      // }\n      // console.log(\"------\", delayTime, offsetTime)\n      // item.voiceSource.start(delayTime, offsetTime);\n    },\n    onPlay() {\n      this.doPlay();\n    },\n    doPlay() {\n      console.log(this.audioContext.state)\n      if(this.audioContext.state != \"running\") {\n        this.playing = true;\n        this.audioContext.resume();\n        if(!this.rTimer) {\n          this.setCurTime();\n          this.jumpTo(0)\n        }\n        //不加这个 新加的音频会播放不出来\n        else {\n          this.jumpTo(this.curTime);\n        }\n        // this.bgSource.start(n);\n        // this.voiceSource.start(n);\n      }\n    },    \n    onPause() {\n      this.doStop();\n    },\n    onBack() {\n      this.$router.replace(\"/\");\n    },    \n    // 循环中的ref 需要这样设置 this.$refs[\"voice\"+index] 即可访问\n    setItemRef(el, index){\n      return `voice${index}`;\n    },\n    onTimeUpdate() {\n      if(!this.store.parsedLyrics || !this.store.parsedLyrics.length) {\n        return;\n      }\n      const currentTime = this.curTime;\n      // 查找当前播放时间对应的歌词行\n      for (let i = 0; i < this.store.parsedLyrics.length; i++) {\n        if (\n          currentTime >= this.store.parsedLyrics[i].time &&\n          (i === this.store.parsedLyrics.length - 1 ||\n            currentTime < this.store.parsedLyrics[i + 1].time)\n        ) {\n          this.curLrc = this.store.parsedLyrics[i].text; // 自动滚动到当前歌词行\n          break;\n        }\n      }\n    },\n\n    //---------这个是想生成电子相册,后来发现有现成的软件可以实现,就不自己写了--------------\n    getBg(item){\n      let url = `background-image: url(${item.url}); background-repeat: no-repeat; background-position: center;`\n      return url;\n    },\n    onImgFileSelect() {\n      if(this.imgList.length >= 10){\n        alert(\"最多添加10张图片\");\n        return;\n      }\n\n      const fileList = this.$refs.imgFile.files;\n      for(let file of fileList) {\n        // 判断文件类型 只能是jpg和png格式\n        console.log(file.type);\n        if (file.type !== \"image/png\" && file.type !== \"image/jpeg\") {\n          alert(\"只能添加图片文件 -> \" + file.name);\n          continue;\n        }\n        // 判断文件大小 不能大于5M\n        if (file.size > 5 * 1024 * 1024) {\n          alert(\"图片大小不能超过5M -> \" + file.name);\n          continue;\n        }\n        let url = URL.createObjectURL(file);\n        this.imgList.push({ url: url });\n      }\n      this.$refs.imgFile.value = \"\";\n    },\n    onImgAdd(){\n      this.$refs.imgFile.click();\n    },\n    onRemoveImg(item, index) {\n      this.imgList.splice(index, 1);\n    },\n    //----------------------\n    isSurpportFile(file) {\n      const regex = /\\.(mp3|wav)$/i; // 匹配以.mp3 .wav结尾的字符串，忽略大小写\n      return regex.test(file.name);\n    },\n    async onAudioFileSelect(){\n      this.store.showLoading();\n      const file = this.$refs.audioFile.files[0];\n      // console.log(file);\n      if (!this.isSurpportFile(file)) {\n        showToast(\"目前只支持 wav, mp3 格式\");\n        this.store.hideLoading();\n        return;\n      }\n      this.doStop();\n      let o = {\n        reverb: false,\n        reverbNode: new Pizzicato.Effects.Reverb({\n          ...this.store.reverbOption\n        }),\n        volume: 100,\n        delay: 0,\n        file: file,\n        //rMap: {},\n        gainNode: null\n      };\n      this.filelist.push(o);\n      await this.addVoice(o);\n      this.$refs.audioFile.value = \"\";\n      this.store.hideLoading();\n    },\n    onAudioAdd() {\n      this.$refs.audioFile.click();\n    },\n    async addVoice(o) {\n      const audBuffer = await this.loadAudioData(this.audioContext, o.file);\n      let duration = audBuffer.duration;\n      if(this.audioDuration < duration) {\n        duration = this.audioDuration;\n      }\n      // 2. 创建合成音频缓冲区，长度为设定的伴奏总时长\n      const sampleRate = this.audioContext.sampleRate;\n      const totalLength = duration * sampleRate;\n\n      const voiceBuffer = this.audioContext.createBuffer(2, totalLength, sampleRate); // 双声道\n\n      // 3. 插入伴奏到合成缓冲区\n      voiceBuffer.getChannelData(0).set(audBuffer.getChannelData(0).subarray(0, totalLength));\n      let n = 0;\n      if(audBuffer.numberOfChannels > 1){\n        n = 1;\n      }      \n      voiceBuffer.getChannelData(1).set(audBuffer.getChannelData(n).subarray(0, totalLength));\n\n      const voiceSource = this.audioContext.createBufferSource();\n      voiceSource.buffer = voiceBuffer;\n      o.voiceSource = voiceSource;\n      let voiceGain = this.audioContext.createGain();\n      voiceGain.gain.value = 1;  \n      o.gainNode = voiceGain;\n\n      voiceSource.connect(voiceGain);       \n      // voiceSource.start();\n      // let nObj = await util.connectReverbNode(voiceGain, o.reverb, this.audioContext);\n      //let nObj = await util.connectReverbNode(voiceGain, this.store.reverbOption, this.audioContext);\n      //let node = nObj.outputNode;\n      //this.reverbNodes = nObj.reverbNodes;   \n      //o.disconnect = nObj.disconnectReverb;\n      voiceGain.connect(this.audioContext.destination);\n    },\n\n    // 卷积合成混响使用 目前用不上了\n    async getReverb(num) {\n      this.store.showLoading();\n      const audioUrl = 'audio/reverb' + num + '.wav';\n      \n      try {\n        const response = await fetch(audioUrl);\n        if (!response.ok) {\n          throw new Error('Network response was not ok ' + response.statusText);\n        }\n        \n        const arrayBuffer = await response.arrayBuffer();\n        \n        // 解码为 AudioBuffer\n        const audioBuffer = await this.audioContext.decodeAudioData(arrayBuffer);\n        \n        console.log(audioBuffer); // 检查是否成功加载 AudioBuffer\n        this.store.hideLoading();\n        return audioBuffer; // 返回解码后的 AudioBuffer\n      } catch (error) {\n        console.error('There has been a problem with your fetch operation:', error);\n        this.store.hideLoading();\n        return null;\n      }\n    },     \n\n    // 是否开启混响设置 之前是可以设置多个混响方案,现在会有一个开关, 然后有设置按钮可以设置具体参数,不再预设方案\n    async onReverbChange(b, item, index) {\n  \n      if(b) {\n        item.gainNode.disconnect();\n        item.gainNode.connect(item.reverbNode);\n        item.reverbNode.connect(this.audioContext.destination)\n      }\n      else {\n        item.gainNode.disconnect();\n        item.reverbNode.disconnect();\n        item.gainNode.connect(this.audioContext.destination);\n      }\n    },\n\n    // 混响参数调整\n    onReverbDetailChange(opt){\n      if(!this.curReverbItem) {\n        return;\n      }\n      this.curReverbItem.reverbNode.time = opt.time;\n      this.curReverbItem.reverbNode.decay = opt.decay;\n      this.curReverbItem.reverbNode.mix = opt.mix;\n    },    \n    onVolumeChange(item, index) {\n      console.log(item, index);\n      item.gainNode.gain.value = item.volume / 100;\n    },\n    onDelayChange(item, index) {\n      this.jumpTo(this.curTime);\n    },\n    onSetting() {\n      this.settingShow = true;\n    },\n    onDurationChange(n) {\n      this.remainTime = this.audioContext.currentTime - n;\n      this.jumpTo(n);\n    },\n    onOrientChange(item, index) {\n      console.log(item, index);\n    },\n    onVoiceRemove(item, index) {\n      this.doStop();\n      item.voiceSource.disconnect();\n      item.gainNode.disconnect();\n      if(item.disconnectReverb) {\n        item.disconnectReverb();\n        item.disconnectReverb = null;\n      }\n      // if(item.reverbNode) {\n      //   item.reverbNode.disconnect();\n      // }\n      this.filelist.splice(index, 1);\n    },\n    compose() {\n      if(!this.filelist.length){\n        showToast(\"请添加人声音频\");\n        return;\n      }\n      this.doStop();\n      this.exportAudio(this.store.compress);\n    },    \n    async exportAudio(compress){\n        // 创建 OfflineAudioContext\n        let length = this.audioDuration; \n        let audioCtx = new OfflineAudioContext({\n            numberOfChannels: 2,\n            length: 48000 * length,\n            sampleRate: 48000,\n        });\n        let Pizzicato = createPizzicato(audioCtx);\n        this.offlineAudioCtx = audioCtx;\n        let bufferSource;\n        // 将音频数据加载到 bufferSource\n        bufferSource = audioCtx.createBufferSource();\n        bufferSource.buffer = this.bgSource.buffer;\n    \n        // 创建 GainNode\n        let gainNode = audioCtx.createGain();\n    \n        // 设置 Tone.js 的上下文为 OfflineAudioContext\n        Tone.setContext(audioCtx);\n    \n        // 创建 Tone.PitchShift 并连接\n        let pitchShift = new Tone.PitchShift();\n        pitchShift.pitch = this.store.banzouPitch;  \n        // 连接音频节点\n        bufferSource.connect(gainNode);\n        Tone.connect(gainNode, pitchShift);\n        Tone.connect(pitchShift, audioCtx.destination);\n\n        let vList = [];\n        //循环filelist\n        for(let i = 0; i < this.filelist.length; i++) {\n          const item = this.filelist[i];\n          // 人声 \n          let voiceBufferSource = audioCtx.createBufferSource();\n          voiceBufferSource.buffer = item.voiceSource.buffer;\n\n          let voiceGain = audioCtx.createGain();   \n          let rItem = {\n            reverb: item.reverb,\n            reverbNode: new Pizzicato.Effects.Reverb({\n              time: item.reverbNode.time,\n              decay: item.reverbNode.decay,\n              mix: item.reverbNode.mix\n            }),\n            // item.reverbNode,\n            //rMap: {},\n            gainNode: voiceGain,\n            //reverbNode: null,\n            voiceSource: voiceBufferSource,\n            delay: item.delay,\n            volume: item.volume,\n          }\n          console.log(rItem);\n          voiceGain.gain.value = rItem.volume / 100;\n          voiceBufferSource.connect(voiceGain);\n          if(rItem.reverb) {\n            voiceGain.connect(rItem.reverbNode);\n            rItem.reverbNode.connect(audioCtx.destination);\n          }\n          else {\n            voiceGain.connect(audioCtx.destination);\n          }\n          //let node = await this.connectReverbNode(rItem, voiceGain, audioCtx);\n          //let nObj = await util.connectReverbNode(voiceGain, rItem.reverb, audioCtx);\n          //let node = nObj.outputNode;\n          //rItem.disconnect = nObj.disconnectReverb;          \n          //node.connect(audioCtx.destination);    \n          this.startVoiceSource(0, rItem);\n          vList.push(voiceBufferSource)\n        }\n        \n         bufferSource.start();\n\n        console.log(\"start generate\")\n        // 开始渲染 OfflineAudioContext\n        audioCtx.startRendering()\n            .then(renderedBuffer => {\n                if(!this.offlineAudioCtx){\n                  return;\n                }\n                console.log('渲染完成', renderedBuffer);\n                if(compress){\n                  showToast(\"正在压缩音频,可能要花费很长时间...\");\n                }\n                downloadAudio(renderedBuffer, audioCtx.length, compress, (progress)=>{\n                  // console.log(\"progress-mp3\", progress);\n                  if(!this.offlineAudioCtx){\n                    return;\n                  }                  \n                  this.store.showProgess(progress);\n                }, ()=>{\n                  this.store.hideProgess();\n                }); // 将渲染后的结果下载\n            })\n            .catch(err => {\n                console.error('渲染错误:', err);\n            });\n        showToast(\"正在生成音频,请稍后...\");\n        renderProgress.start(audioCtx, bufferSource.buffer.duration, (progess)=>{\n          if(!this.offlineAudioCtx) {\n            return;\n          }\n          console.log(\"progess\", progess);\n          this.store.showProgess(progess);\n        }, ()=>{\n          this.store.hideProgess();\n          if(!onlyVoice) {\n            bufferSource.disconnect();\n            bufferSource.buffer = null;\n          }\n          for(let source of vList) {\n            source.disconnect();\n            source.buffer = null;\n          }\n        })\n\n        // console.log(audioCtx.currentTime);\n        // setTimeout(() => {\n        //   console.log(audioCtx.currentTime, bufferSource);\n        // }, 100);\n        \n    }     \n  },\n};\n</script>\n<style scoped>\n.c-co-item {\n  margin: 10px 14px 20px;\n  border-bottom: solid 1px #ccc;\n  position: relative;\n}\n.c-co-namebox {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.c-co-volslider {\n  flex: 1;\n  margin-right: 18px;\n}\n\n.content-compose {\n  display: flex;\n  flex-direction: column;\n}\n.c-co-editbox {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  min-height: 0;\n}\n.c-co-btnbox {\n  padding: 10px 0 15px;\n  margin-top: 10px;\n  border-top: solid 1px #ccc;\n}\n.c-co-itemname {\n  font-weight: bold;\n  font-size: 16px;\n  /* 末尾省略号 */\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.c-co-remove {\n  position: absolute;\n  top: -10px;\n  right: -10px;\n  color: #ff0000;\n  font-size: 28px;\n  cursor: pointer;\n  box-shadow:inset 0px 0px 5px #ff0000;\n  border-radius: 50%;\n}\n.c-co-volslider-delay ::deep .van-slider__button {\n  background-color: rgb(29, 150, 96) !important;\n}\n.c-co-volslider-delay ::deep .van-slider__bar{\n  background-color: rgb(29, 150, 96) !important;\n}\n/* .c-co-reverbbox .van-radio-group.van-radio-group--horizontal{\n  flex-wrap: nowrap;\n} */\n.c-co-reverbbox {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: end;\n  padding: 10px 0;\n}\n.c-co-imgbox {\n  padding: 5px 12px 0;\n  border-top: solid 1px #ccc;\n  border-bottom: solid 1px #ccc;\n}\n.c-co-imgtitle {\n  display: flex;\n  justify-content: space-between;\n  padding: 6px 0;\n}\n.c-co-imglist {\n  padding-top: 2px;\n  white-space: nowrap;\n  overflow-x: auto;\n  text-align: left;\n}\n.c-co-imgitem {\n  display: inline-block;\n  margin: 8px 15px;\n  width: 60px;\n  height: 40px;\n  border: solid 1px #ccc;\n  border-radius: 3px;\n  position: relative;\n  background-size: cover;\n}\n.c-co-imglist.portrait .c-co-imgitem {\n  width: 40px;\n  height: 60px; \n}\n.c-co-imgrev {\n  position: absolute;\n  top: -8px;\n  right: -8px;\n  color: #ed1919;\n  font-size: 26px;\n  cursor: pointer;\n  box-shadow:inset 0px 0px 5px #e85454;\n  border-radius: 50%;  \n}\n.c-co-innerbox {\n  flex: 1;\n  text-align: center;\n  position: relative;\n}\n\n.c-e-btn-r{\n  position:absolute;\n  right: 10px;\n  top: 0px;\n}\n\n.c-co-voicebox {\n  margin-bottom: 10px;\n  padding: 8px 16px;\n}\n</style>\n","import { render } from \"./ComposeView.vue?vue&type=template&id=00ec0b26&scoped=true\"\nimport script from \"./ComposeView.vue?vue&type=script&lang=js\"\nexport * from \"./ComposeView.vue?vue&type=script&lang=js\"\n\nimport \"./ComposeView.vue?vue&type=style&index=0&id=00ec0b26&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-00ec0b26\"]])\n\nexport default __exports__"],"names":["class","_createBlock","_component_van_dialog","show","$setup","isVisible","_cache","$event","title","onClose","onCloseDialog","default","_withCtx","_createElementVNode","_hoisted_1","_createVNode","_component_van_cell","value","store","lrcDelayTime","_hoisted_2","_component_van_slider","modelValue","onChange","$options","onlrcDelayChange","min","max","step","_hoisted_3","_component_van_radio_group","lrcEncoding","direction","onLrcEncodingChange","_component_van_radio","name","_createTextVNode","_","banzouVolume","_hoisted_4","onBanzouVolumeChange","banzouPitch","_hoisted_5","onBanzouPitchChange","props","visible","type","Boolean","emits","setup","emit","useStore","ref","watch","newVal","console","log","methods","val","this","parseLRC","readLrcText","__exports__","render","_createElementBlock","_Fragment","_component_van_nav_bar","onClickLeft","onBack","onClickRight","onSetting","_toDisplayString","$data","musicName","_component_van_icon","onClick","onPause","playing","onPlay","_hoisted_6","util","convertTime","curTime","_hoisted_7","onDurationChange","audioDuration","onDragStart","dragging","onDragEnd","_hoisted_8","_hoisted_9","curLrc","_hoisted_10","_hoisted_11","accompanyVal","_hoisted_12","onAccompanyVoiceChange","_hoisted_13","_hoisted_14","_component_van_switch","compress","_hoisted_15","_hoisted_16","_hoisted_17","orient","onOrientChange","_normalizeClass","_renderList","imgList","item","index","key","style","_normalizeStyle","getBg","onRemoveImg","length","_hoisted_18","filelist","src","file","url","ref_for","_hoisted_19","_hoisted_20","_hoisted_21","replace","_hoisted_22","_hoisted_23","volume","onVolumeChange","_hoisted_24","_hoisted_25","delay","onDelayChange","_hoisted_26","_hoisted_27","_hoisted_28","_component_van_button","plain","size","onReverbSetting","reverb","b","onReverbChange","onVoiceRemove","_hoisted_29","_hoisted_30","multiple","args","onImgFileSelect","onAudioFileSelect","onAudioAdd","round","compose","_component_SettingDialog","settingShow","data","curReverbData","_component_ReverbDialog","onReverbDetailChange","_ctx","curReverbItem","Pizzicato","components","SettingDialog","ReverbDialog","createPizzicato","window","AudioContext","webkitAudioContext","rbDlg","audioContext","offlineAudioCtx","remainTime","rbSettingShow","mounted","banzou","alert","$router","context","init","unmounted","rTimer","cancelAnimationFrame","i","delayPlayTimer","clearTimeout","voiceSource","disconnect","buffer","fileList","bgSource","e","close","state","suspend","currentTime","hideLoading","hideProgess","stopDownload","renderProgress","stop","handler","bgGain","gain","time","reverbNode","decay","mix","accompanimentBlob","showLoading","accompanimentBuffer","loadAudioData","recordDuration","duration","sampleRate","totalLength","bgBuffer","createBuffer","getChannelData","set","subarray","n","numberOfChannels","createBufferSource","createGain","connect","Tone","setContext","pitchShift","PitchShift","pitch","destination","lrc","start","blob","Promise","resolve","reject","reader","FileReader","onload","decodeAudioData","result","then","audioBuffer","catch","err","onerror","error","readAsArrayBuffer","setCurTime","doStop","onTimeUpdate","requestAnimationFrame","goStart","jumpTo","newBgSource","newVoiceSource","gainNode","startVoiceSource","offsetTime","setTimeout","doPlay","resume","setItemRef","el","parsedLyrics","text","$refs","imgFile","files","URL","createObjectURL","push","onImgAdd","click","splice","isSurpportFile","regex","test","audioFile","showToast","o","Effects","Reverb","reverbOption","addVoice","audBuffer","voiceBuffer","voiceGain","getReverb","num","audioUrl","response","fetch","ok","Error","statusText","arrayBuffer","opt","disconnectReverb","exportAudio","bufferSource","audioCtx","OfflineAudioContext","vList","voiceBufferSource","rItem","startRendering","renderedBuffer","downloadAudio","progress","showProgess","progess","onlyVoice","source"],"sourceRoot":""}