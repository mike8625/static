(function(){var e={8069:function(e,t,i){i(4114),function(t,i,n,o){"use strict";var s,a,r=!1,c={};function l(e,t,i,n,o){n=n||0,o=o||0,this.identifier=t,this.target=e,this.clientX=i.clientX+n,this.clientY=i.clientY+o,this.screenX=i.screenX+n,this.screenY=i.screenY+o,this.pageX=i.pageX+n,this.pageY=i.pageY+o}function u(){var e=[];return e.item=function(e){return this[e]||null},e.identifiedTouch=function(e){return this[e+1]||null},e}function h(){for(var e=[t,i.documentElement],n=["ontouchstart","ontouchmove","ontouchcancel","ontouchend"],s=0;s<e.length;s++)for(var a=0;a<n.length;a++)e[s]&&e[s][n[a]]==o&&(e[s][n[a]]=null)}function d(){return"ontouchstart"in t||t.Modernizr&&t.Modernizr.touch||(navigator.msMaxTouchPoints||navigator.maxTouchPoints)>2}function f(e){e.preventDefault(),e.stopPropagation()}function m(e){return function(t){C.ignoreTags.indexOf(t.target.tagName)<0&&f(t),1===t.which&&(("mousedown"==t.type||!a||a&&!a.dispatchEvent)&&(a=t.composedPath()&&t.composedPath().length>0?t.composedPath()[0]:t.target),r&&!t.shiftKey&&(g("touchend",t),r=!1),g(e,t),!r&&t.shiftKey&&(r=!0,s={pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY},g("touchstart",t)),"mouseup"==t.type&&(s=null,r=!1,a=null))}}function g(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.touches=v(t,e),n.targetTouches=v(t,e),n.changedTouches=b(t,e),a.dispatchEvent(n)}function p(e){var t=new u;if(r){var i=C.multiTouchOffset,n=s.pageX-e.pageX,o=s.pageY-e.pageY;t.push(new l(a,1,s,-1*n-i,-1*o+i)),t.push(new l(a,2,s,n+i,o-i))}else t.push(new l(a,1,e,0,0));return t}function v(e,t){if("mouseup"==e.type)return new u;var i=p(e);return r&&"mouseup"!=e.type&&"touchend"==t&&i.splice(1,1),i}function b(e,t){var i=p(e);return!r||"mouseup"==e.type||"touchstart"!=t&&"touchend"!=t||i.splice(0,1),i}function y(e){var t,n,o,s;for(n=0;n<e.touches.length;n++)for(var a in t=e.touches[n],o=c[t.identifier],o||(o=c[t.identifier]=i.createElement("div"),i.body.appendChild(o)),s=C.template(t),s)o.style[a]=s[a];if("touchend"==e.type||"touchcancel"==e.type)for(n=0;n<e.changedTouches.length;n++)t=e.changedTouches[n],o=c[t.identifier],o&&(o.parentNode.removeChild(o),delete c[t.identifier])}function C(){d()||(h(),t.addEventListener("mousedown",m("touchstart"),!0),t.addEventListener("mousemove",m("touchmove"),!0),t.addEventListener("mouseup",m("touchend"),!0),t.addEventListener("mouseenter",f,!0),t.addEventListener("mouseleave",f,!0),t.addEventListener("mouseout",f,!0),t.addEventListener("mouseover",f,!0),t.addEventListener("touchstart",y,!0),t.addEventListener("touchmove",y,!0),t.addEventListener("touchend",y,!0),t.addEventListener("touchcancel",y,!0))}i.createTouch||(i.createTouch=function(e,i,n,s,a,r,c,u,h){return u!=o&&h!=o||(u=s-t.pageXOffset,h=a-t.pageYOffset),new l(i,n,{pageX:s,pageY:a,screenX:r,screenY:c,clientX:u,clientY:h})}),i.createTouchList||(i.createTouchList=function(){for(var e=new u,t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length=arguments.length,e}),C.multiTouchOffset=75,C.ignoreTags=["TEXTAREA","INPUT","SELECT"],C.template=function(e){var t=30,i="translate("+(e.clientX-t/2)+"px, "+(e.clientY-t/2)+"px)";return{position:"fixed",left:0,top:0,background:"#fff",border:"solid 1px #999",opacity:.6,borderRadius:"100%",height:t+"px",width:t+"px",padding:0,margin:0,display:"block",overflow:"hidden",pointerEvents:"none",webkitUserSelect:"none",mozUserSelect:"none",userSelect:"none",webkitTransform:i,mozTransform:i,transform:i,zIndex:100}},"function"==typeof t.define&&t.define.define.amd?t.define((function(){return C})):e.exports?e.exports=C:t[n]=C;var A="ontouchstart"in t;A||new C}(window,document,"TouchEmulator")},4312:function(e,t,i){"use strict";var n=i(5130),o=i(6768);const s={class:"c-pg-barbox"};function a(e,t,i,a,r,c){const l=(0,o.g2)("router-view"),u=(0,o.g2)("van-loading"),h=(0,o.g2)("van-overlay"),d=(0,o.g2)("van-progress");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l),(0,o.bF)(h,{show:a.store.loading},{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:"wrapper",onClick:t[0]||(t[0]=(0,n.D$)((()=>{}),["stop"]))},[(0,o.bF)(u,{type:"spinner"})])])),_:1},8,["show"]),(0,o.bF)(h,{show:a.store.rendering},{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:"wrapper",onClick:t[1]||(t[1]=(0,n.D$)((()=>{}),["stop"]))},[(0,o.Lk)("div",s,[(0,o.bF)(d,{"pivot-text":"working...",color:"#ee0a24",percentage:a.store.renderingProgess},null,8,["percentage"])])])])),_:1},8,["show"])],64)}i(4114);var r=i(657);const c=(0,r.nY)("userData",{state:()=>({counter:0,banzou:null,lrcEncoding:"GBK",lrc:null,lrcText:"",parsedLyrics:[],lrcDelayTime:0,banzouLength:0,recordLength:0,banzouVolume:.7,humanVolume:.9,banzouPitch:0,audioChunk:[],reverb:!1,voiceDelay:0,compress:!1,loading:!1,rendering:!1,renderingProgess:0,alertDialog:{show:!1,text:""},reverbOption:{time:1.8,decay:1.5,mix:.4},reverbOption_default:{time:1.8,decay:1.5,mix:.4}}),actions:{parseLRC(){let e=this.lrcText;if(!e)return void console.log("歌词内容为空");const t=e.split(/[\r\n]/),i=/\[(\d{2}):(\d{2})\.(\d{2,3})\]/,n=[];t.forEach((e=>{const t=i.exec(e);if(t){const o=parseInt(t[1],10),s=parseInt(t[2],10);let a=parseInt(t[3],10);a=t[3].length>2?parseInt(t[3],10)/1e3:parseInt(t[3],10)/100;const r=60*o+s+a,c=e.replace(i,"").trim();n.push({text:c,value:r+this.lrcDelayTime,time:r+this.lrcDelayTime})}})),this.parsedLyrics=n},readLrcText(){return this.readText().then((e=>{this.lrcText=e,this.parseLRC()}))},readText(){if(this.lrc)return new Promise((e=>{let t=new FileReader;t.onload=t=>{e(t.target.result)},t.readAsText(this.lrc,this.lrcEncoding)}));console.log("没有歌词文件")},increment(){this.counter++},showLoading(){this.loading=!0},hideLoading(){this.loading=!1},showProgess(e){this.rendering=!0,this.renderingProgess=e},hideProgess(){this.rendering=!1,setTimeout((()=>{this.renderingProgess=0}),1e3)},showAlert(e){this.alertDialog.show=!0,this.alertDialog.text=e},hideAlert(){this.alertDialog.show=!1,this.alertDialog.text=""}},persist:{paths:["lrcDelayTime","lrcEncoding","compress","reverb","reverbOption","voiceDelay","banzouVolume","humanVolume"]}});var l=c,u=i(2094),h=i(989),d=i(7418),f=i.n(d),m={name:"AppView",components:{Loading:u.Rh,Overlay:h.hJ},setup(){const e=l();return{store:e}},mounted(){},methods:{noSleep(){let e=new(f());document.addEventListener("click",(function t(){e.enable(),document.removeEventListener("click",t,!1)}),!1)}}},g=i(1241);const p=(0,g.A)(m,[["render",a]]);var v=p;i(4603),i(7566),i(8721);let b={getTime:function(e){function t(e){return e=e.toString(),e[1]?e:"0"+e}e=e||new Date;var i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),s=e.getHours(),a=e.getMinutes(),r=e.getSeconds();return[t(i),t(n),t(o)].join("-")+" "+[t(s),t(a),t(r)].join(":")},getDate:function(e){return this.getTime(e).split(" ")[0]},addDays:function(e,t){return this.addTimes(e,60,60,24,t)},addHours:function(e,t){return this.addTimes(e,60,60,t,1)},addMinutes:function(e,t){return this.addTimes(e,60,t,1,1)},addSeconds:function(e,t){return this.addTimes(e,t,1,1,1)},addTimes:function(e,t,i,n,o){e=e||new Date;var s=e.getTime(),a=s+1e3*t*i*n*o,r=new Date(a);return r},formatTime:function(e,t){function i(e){return e=parseInt(e),e<10?"0"+e:e}function n(e){return e=parseInt(e),e>12?e-12:e}e||(e=new Date);var o=e.getFullYear(),s=i(e.getMonth()+1),a=i(e.getDate()),r=i(e.getHours()),c=i(n(e.getHours())),l=i(e.getMinutes()),u=i(e.getSeconds());return t?(t=t.replace(/yyyy/g,o),t=t.replace(/MM/g,s),t=t.replace(/dd/g,a),t=t.replace(/HH/g,r),t=t.replace(/hh/g,c),t=t.replace(/mm/g,l),t=t.replace(/ss/g,u),t):""+o+s+a+r+l+u},getQueryString:function(e){var t="",i=window.location.href,n=-1,o=e.length;do{if(n=i.indexOf(e+"="),-1!=n){if("?"==i.charAt(n-1)||"&"==i.charAt(n-1)){i=i.substr(n);break}i=i.substr(n+o+1)}}while(-1!=n);if(-1!=n){var s=i.indexOf("&");t=-1==s?i.substr(o+1):i.substring(o+1,s)}return t},isMobile(){let e=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);return!!e},HTMLDecode(e){var t=document.createElement("div");t.innerHTML=e;var i=t.textContent;return t=null,i},replaceTag(e){return e=e.replace(/^\<p\s*\>/,"").replace(/\<\/p\s*\>$/,""),e},fixRem(e){return this.isMobile()?e:1==window.devicePixelRatio?2*e:e},px2rem(e){return this.fixRem(window.lib.flexible.px2rem(parseFloat(e)))+"rem"},base64decode(e){var t,i,n,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),a=e.replace(/=/g,"").split(""),r="";for(t in a){for(i in n="",s)if(a[t]==s[i]){n=i;break}if(""==n)return"编码有误";o=Number(n).toString(2),o.length<6&&(o=("00000"+o).slice(-6)),r+=o}var c,l,u=Math.floor(r.length/8),h="";for(c=0;c<u;c++)l=parseInt(r.slice(8*c,8*c+8),2).toString(16),l.length<2&&(l=("00"+l).slice(-2)),h+="%"+l;return decodeURIComponent(h)},getListSearchOption:function(){var e=b.formatTime(b.addDays(new Date,0),"yyyy-MM-dd"),t=b.formatTime(b.addDays(new Date,1),"yyyy-MM-dd"),i=10,n=window.screen.height;return n>900&&(i=15),{starttime:e,endtime:t,pagesize:i}},downloadFile:function(e){let t=new Blob([e.data],{type:"application/octet-stream;charset=utf-8"}),i=document.createElement("a"),n=window.URL.createObjectURL(t);i.href=n,i.download=e.name,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)},resetObject:function(e){Object.keys(e).forEach((function(t){"number"==typeof e[t]?e[t]=0:"string"==typeof e[t]?e[t]="":"[object Array]"==Object.prototype.toString.call(e[t])&&(e[t]=[])}))},convertTime(e){let t=Math.floor(e/60),i=Math.round(e%60);return`${t}:${i<10?"0"+i:i}`},async connectReverbNode(e,t,i){if(!t)return{outputNode:e,reverbNodes:null,disconnectReverb:()=>{}};const n=t,o=i.createGain();o.gain.value=n.dryGain;const s=i.createGain();s.gain.value=n.wetGain;const a=i.createDelay();a.delayTime.value=n.preDelayTime;const r=i.createBiquadFilter();r.type="lowpass",r.frequency.value=n.highCutFrequency;const c=i.createGain(),l=i.createGain(),u=i.createDelay();u.delayTime.value=n.delayTimes[0];const h=i.createGain();h.gain.value=n.feedbackGains[0],u.connect(h),h.connect(u);const d=i.createDelay();d.delayTime.value=n.delayTimes[1];const f=i.createGain();f.gain.value=n.feedbackGains[1],d.connect(f),f.connect(d);const m=i.createChannelMerger(2);u.connect(m,0,0),d.connect(m,0,1);const g=i.createGain();e.connect(o),e.connect(s),s.connect(a),a.connect(r),r.connect(c),r.connect(l),c.connect(u),l.connect(d),o.connect(g),m.connect(g);let p={dryGainNode:o,wetGainNode:s,preDelayNode:a,highCutFilter:r,delayNodeLeft:u,delayNodeRight:d,feedbackGainLeft:h,feedbackGainRight:f};return{outputNode:g,reverbNodes:p,disconnectReverb:()=>{o.disconnect(),s.disconnect(),a.disconnect(),r.disconnect(),c.disconnect(),l.disconnect(),u.disconnect(),d.disconnect(),m.disconnect()}}}};var y=b;(function(e,t){var i,n=e.document,o=n.documentElement,s=n.querySelector('meta[name="viewport"]'),a=n.querySelector('meta[name="flexible"]'),r=0,c=0,l=t.flexible||(t.flexible={});if(s){console.warn("将根据已有的meta标签来设置缩放比例");var u=s.getAttribute("content").match(/initial\-scale=([\d\.]+)/);u&&(c=parseFloat(u[1]),r=parseInt(1/c))}else if(a){var h=a.getAttribute("content");if(h){var d=h.match(/initial\-dpr=([\d\.]+)/),f=h.match(/maximum\-dpr=([\d\.]+)/);d&&(r=parseFloat(d[1]),c=parseFloat((1/r).toFixed(2))),f&&(r=parseFloat(f[1]),c=parseFloat((1/r).toFixed(2)))}}if(!r&&!c){e.navigator.appVersion.match(/android/gi);var m=e.navigator.appVersion.match(/iphone/gi),g=e.devicePixelRatio;r=m?g>=3&&(!r||r>=3)?3:g>=2&&(!r||r>=2)?2:1:1,c=1/r}if(o.setAttribute("data-dpr",r),!s)if(s=n.createElement("meta"),s.setAttribute("name","viewport"),s.setAttribute("content","initial-scale="+c+", maximum-scale="+c+", minimum-scale="+c+", user-scalable=no"),o.firstElementChild)o.firstElementChild.appendChild(s);else{var p=n.createElement("div");p.appendChild(s),n.write(p.innerHTML)}function v(){var t=o.getBoundingClientRect().width;t/r>750&&(t=750*r),y.isMobile()||(t=480*r,o.classList.add("pc"));var i=t/10;o.style.fontSize=i+"px",l.rem=e.rem=i}e.addEventListener("resize",(function(){clearTimeout(i),i=setTimeout(v,300)}),!1),e.addEventListener("pageshow",(function(e){e.persisted&&(clearTimeout(i),i=setTimeout(v,300))}),!1),"complete"===n.readyState?n.body.style.fontSize=12*r+"px":n.addEventListener("DOMContentLoaded",(function(e){n.body.style.fontSize=12*r+"px"}),!1),v(),l.dpr=e.dpr=r,l.refreshRem=v,l.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"===typeof e&&e.match(/rem$/)&&(t+="px"),t},l.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"===typeof e&&e.match(/px$/)&&(t+="rem"),t}})(window,window["lib"]||(window["lib"]={}));i(8069);var C=i(1387),A=i(4232);const x=e=>((0,o.Qi)("data-v-876e8884"),e=e(),(0,o.jt)(),e),w={class:"container home"},N={class:"content c-text-center"},k=x((()=>(0,o.Lk)("div",{class:"c-select-title c-mtop15"},"选择伴奏",-1))),L={class:"c-iconadd-box"},S=["src"],T=x((()=>(0,o.Lk)("div",{class:"c-select-title"},"选择歌词(lrc)",-1))),G={class:"c-iconadd-box"},R=["src"];function F(e,t,i,s,a,r){const c=(0,o.g2)("van-nav-bar"),l=(0,o.g2)("van-icon"),u=(0,o.g2)("van-button");return(0,o.uX)(),(0,o.CE)("div",w,[(0,o.bF)(c,{title:"都来唱歌","left-text":"关于",onClickLeft:t[0]||(t[0]=e=>r.showAbout())}),(0,o.Lk)("div",N,[k,(0,o.Lk)("div",L,[(0,o.Lk)("input",{type:"file",ref:"banzou",style:{display:"none"},onChange:t[1]||(t[1]=(...e)=>r.onBanzouFileChange&&r.onBanzouFileChange(...e))},null,544),(0,o.bo)((0,o.bF)(l,{name:"plus",class:"c-img-add",onClick:t[2]||(t[2]=e=>r.onAddBanzou())},null,512),[[n.aG,null==s.store.banzou]]),(0,o.bo)((0,o.Lk)("img",{src:a.banzouImg,class:"c-icon-selected"},null,8,S),[[n.aG,null!=s.store.banzou]]),(0,o.bo)((0,o.bF)(l,{name:"cross",class:"c-icon-rev",onClick:r.onRevBanzou},null,8,["onClick"]),[[n.aG,null!=s.store.banzou]]),(0,o.bo)((0,o.Lk)("div",{class:"c-text-selected"},(0,A.v_)(s.store.banzou&&s.store.banzou.name),513),[[n.aG,null!=s.store.banzou]])]),T,(0,o.Lk)("div",G,[(0,o.Lk)("input",{type:"file",ref:"lrc",style:{display:"none"},onChange:t[3]||(t[3]=(...e)=>r.onLrcFileChange&&r.onLrcFileChange(...e))},null,544),(0,o.bo)((0,o.bF)(l,{name:"plus",class:"c-img-add",onClick:t[4]||(t[4]=e=>r.onAddLrc())},null,512),[[n.aG,null==s.store.lrc]]),(0,o.bo)((0,o.Lk)("img",{src:a.lrcImg,class:"c-icon-selected"},null,8,R),[[n.aG,null!=s.store.lrc]]),(0,o.bo)((0,o.bF)(l,{name:"cross",class:"c-icon-rev",onClick:r.onRevLrc},null,8,["onClick"]),[[n.aG,null!=s.store.lrc]]),(0,o.bo)((0,o.Lk)("div",{class:"c-text-selected"},(0,A.v_)(s.store.lrc&&s.store.lrc.name),513),[[n.aG,null!=s.store.lrc]])]),(0,o.Lk)("div",null,[(0,o.bF)(u,{type:"primary",size:"large",class:"c-rec-btn",onClick:t[5]||(t[5]=e=>r.onStartRec())},{default:(0,o.k6)((()=>[(0,o.eW)("开始")])),_:1}),(0,o.bF)(u,{plain:"",type:"danger",class:"c-compose-btn",onClick:t[6]||(t[6]=e=>r.onstartCompose())},{default:(0,o.k6)((()=>[(0,o.eW)("合成")])),_:1})])])])}var I=i(2570),E=i(715),U={name:"HomeView",components:{},setup(){const e=l();return{store:e}},data(){return{banzouImg:i(8411),lrcImg:i(9527)}},mounted(){},methods:{test1(){console.log(this.$refs.banzou)},showAbout(){(0,I.ui)({title:"关于",message:"Author: MikeChen",showConfirmButton:!0})},onClickRight(){this.$router.push("/compose")},isSurpportFile(e){const t=/\.(mp3|wav)$/i;return t.test(e.name)},isLrcFile(e){const t=/\.lrc$/i;return t.test(e.name)},onStartRec(){null!=this.store.banzou?this.$router.push("/record"):(0,E.P0)("请选择一个伴奏文件")},onstartCompose(){null!=this.store.banzou?this.$router.push("/compose"):(0,E.P0)("请选择一个伴奏文件")},onAddBanzou(){this.$refs.banzou.click()},onBanzouFileChange(){const e=this.$refs.banzou.files[0];this.isSurpportFile(e)?this.store.banzou=e:(0,E.P0)("目前只支持 wav, mp3 格式")},onRevBanzou(){this.store.banzou=null,this.$refs.banzou.value=""},onLrcFileChange(){const e=this.$refs.lrc.files[0];this.isLrcFile(e)?this.store.lrc=e:(0,E.P0)("目前只支持 lrc 文件")},onAddLrc(){this.$refs.lrc.click()},onRevLrc(){this.store.lrc=null,this.$refs.lrc.value=""}}};const D=(0,g.A)(U,[["render",F],["__scopeId","data-v-876e8884"]]);var V=D;const B=e=>((0,o.Qi)("data-v-52f7963e"),e=e(),(0,o.jt)(),e),O={class:"container edit"},P={class:"content"},z={class:"c-e-name c-e-name-crop"},M={class:"c-e-ctrlbox"},Q={class:"c-e-ctrlitem"},j={class:"c-e-sliderbox-time"},K={class:"c-e-sliderbox"},W={class:"c-e-sliderbox-time"},H={class:"c-co-lrcbox"},X={class:"c-e-editbox"},Y={class:"c-e-title"},J=B((()=>(0,o.Lk)("span",null,"人声音量",-1))),q={class:"c-e-voicebox"},Z={class:"c-e-title"},_=B((()=>(0,o.Lk)("span",null,"伴奏音量",-1))),$={class:"c-e-voicebox"},ee={class:"c-e-title"},te=B((()=>(0,o.Lk)("span",null,"人声迟延",-1))),ie={class:"c-e-voicebox"},ne={class:"c-e-title"},oe=B((()=>(0,o.Lk)("span",null,"混响",-1))),se={class:"c-reverb-gp"},ae={class:"c-e-title"},re=B((()=>(0,o.Lk)("span",null,"压缩音频",-1))),ce={class:"c-e-btnbox"};function le(e,t,i,s,a,r){const c=(0,o.g2)("van-nav-bar"),l=(0,o.g2)("van-icon"),u=(0,o.g2)("van-slider"),h=(0,o.g2)("van-button"),d=(0,o.g2)("van-switch"),f=(0,o.g2)("ReverbDialog");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",O,[(0,o.bF)(c,{title:"编辑","left-text":"主页",onClickLeft:t[0]||(t[0]=e=>r.onBack())}),(0,o.Lk)("div",P,[(0,o.Lk)("div",z,(0,A.v_)(a.musicName),1),(0,o.Lk)("div",M,[(0,o.Lk)("div",Q,[(0,o.bo)((0,o.bF)(l,{name:"pause-circle-o",class:"c-e-ctrlicon",onClick:r.onPause},null,8,["onClick"]),[[n.aG,a.playing]]),(0,o.bo)((0,o.bF)(l,{name:"play-circle",class:"c-e-ctrlicon",onClick:r.onPlay},null,8,["onClick"]),[[n.aG,!a.playing]])]),(0,o.Lk)("div",j,(0,A.v_)(s.util.convertTime(a.curTime)),1),(0,o.Lk)("div",K,[(0,o.bF)(u,{modelValue:a.curTime,"onUpdate:modelValue":t[1]||(t[1]=e=>a.curTime=e),min:"0",max:s.store.recordLength,onChange:r.onDurationChange,onDragStart:t[2]||(t[2]=e=>a.dragging=!0),onDragEnd:t[3]||(t[3]=e=>a.dragging=!1)},null,8,["modelValue","max","onChange"])]),(0,o.Lk)("div",W,(0,A.v_)(s.util.convertTime(s.store.recordLength)),1)]),(0,o.Lk)("div",H,(0,A.v_)(a.curLrc),1),(0,o.Lk)("div",X,[(0,o.Lk)("div",Y,[J,(0,o.Lk)("span",null,(0,A.v_)(a.humanVal),1)]),(0,o.Lk)("div",q,[(0,o.bF)(u,{min:"0",max:"100",modelValue:a.humanVal,"onUpdate:modelValue":t[4]||(t[4]=e=>a.humanVal=e),onChange:r.onHumanVoiceChange},null,8,["modelValue","onChange"])]),(0,o.Lk)("div",Z,[_,(0,o.Lk)("span",null,(0,A.v_)(a.accompanyVal),1)]),(0,o.Lk)("div",$,[(0,o.bF)(u,{min:"0",max:"100",modelValue:a.accompanyVal,"onUpdate:modelValue":t[5]||(t[5]=e=>a.accompanyVal=e),onChange:r.onAccompanyVoiceChange},null,8,["modelValue","onChange"])]),(0,o.Lk)("div",ee,[te,(0,o.Lk)("span",null,(0,A.v_)(s.store.voiceDelay),1)]),(0,o.Lk)("div",ie,[(0,o.bF)(u,{min:"-1",max:"1",step:"0.1",modelValue:s.store.voiceDelay,"onUpdate:modelValue":t[6]||(t[6]=e=>s.store.voiceDelay=e),onChange:r.onDelayChange},null,8,["modelValue","onChange"])]),(0,o.Lk)("div",ne,[oe,(0,o.Lk)("div",se,[(0,o.bo)((0,o.bF)(h,{plain:"",type:"primary",size:"small",class:"c-e-cusbtn",onClick:r.onReverbSetting},{default:(0,o.k6)((()=>[(0,o.eW)("设置")])),_:1},8,["onClick"]),[[n.aG,s.store.reverb]]),(0,o.bF)(d,{modelValue:s.store.reverb,"onUpdate:modelValue":t[7]||(t[7]=e=>s.store.reverb=e),onChange:r.onReverbChange},null,8,["modelValue","onChange"])])]),(0,o.Lk)("div",ae,[re,(0,o.bF)(d,{modelValue:s.store.compress,"onUpdate:modelValue":t[8]||(t[8]=e=>s.store.compress=e)},null,8,["modelValue"])])]),(0,o.Lk)("div",ce,[(0,o.bF)(h,{plain:"",class:"c-e-btn",onClick:t[9]||(t[9]=e=>r.reRecord())},{default:(0,o.k6)((()=>[(0,o.eW)("重录")])),_:1}),(0,o.bF)(h,{plain:"",class:"c-e-btn",type:"danger",onClick:r.exportHuman},{default:(0,o.k6)((()=>[(0,o.eW)("导出人声")])),_:1},8,["onClick"]),(0,o.bF)(h,{class:"c-e-btn",type:"primary",onClick:r.exportSong},{default:(0,o.k6)((()=>[(0,o.eW)("导出歌曲")])),_:1},8,["onClick"])])])]),(0,o.bF)(f,{ref:"rbDlg",onChange:r.onReverbDetailChange},null,8,["onChange"])],64)}var ue=i(144);let he={timer:null,start(e,t,i,n){this.timer=setInterval((()=>{e.currentTime<t?i(Math.floor(e.currentTime/t*100)):(i(100),this.stop(),setTimeout((()=>{n()}),1e3))}),200)},stop(){clearInterval(this.timer)}};i(6573),i(8100),i(7936),i(7467),i(4732),i(9577);let de=!1;async function fe(e,t,i=!1,n,o){de=!0;var s=await ge(e,t,i,n,o);if(s){var a=URL.createObjectURL(s),r="song"+(i?".mp3":".wav"),c=document.createElement("a");c.href=a,c.download=r,c.click(),window.URL.revokeObjectURL(c.href),o()}}function me(){de=!1}async function ge(e,t,i,n){var o,s,a=e.numberOfChannels,r=t*a*2+44,c=new ArrayBuffer(r),l=new DataView(c),u=[],h=0,d=0;for(m(1179011410),m(r-8),m(1163280727),m(544501094),m(16),f(1),f(a),m(e.sampleRate),m(2*e.sampleRate*a),f(2*a),f(16),m(1635017060),m(r-d-4),o=0;o<e.numberOfChannels;o++)u.push(e.getChannelData(o));while(d<r){for(o=0;o<a;o++)s=Math.max(-1,Math.min(1,u[o][h])),s=0|(.5+s<0?32768*s:32767*s),l.setInt16(d,s,!0),d+=2;h++}if(i){let e=lamejs.WavHeader.readHeader(new DataView(c)),t=new Int16Array(c,e.dataOffset,e.dataLen/2);return await pe(e.channels,e.sampleRate,t,n)}return new Blob([c],{type:"audio/wav"});function f(e){l.setUint16(d,e,!0),d+=2}function m(e){l.setUint32(d,e,!0),d+=4}}async function pe(e=2,t=48e3,i,n){var o=[],s=new lamejs.Mp3Encoder(e,t,128),a=i.length,r=4608;console.time();for(var c=0;a>=r;c+=r){var l=i.subarray(c,c+r),u=l.filter((function(e,t,i){return t%2===0})),h=l.filter((function(e,t,i){return t%2}));if(!de)return null;var d=await ve(s,u,h);d&&d.length>0&&o.push(new Int8Array(d)),a-=r,n(Math.floor(c/i.length*100))}var f=s.flush();f.length>0&&o.push(new Int8Array(f)),console.timeEnd();var m=new Blob(o,{type:"audio/mp3"});return m}async function ve(e,t,i){return new Promise(((n,o)=>{let s=e.encodeBuffer(t,i);setTimeout((()=>{n(s)}),0)}))}var be=fe;const ye={class:"c-setting-box"},Ce={class:"c-setting-sliderbox"},Ae={class:"c-setting-sliderbox"},xe={class:"c-setting-sliderbox"},we={class:"c-setting-resetbtnbox"};function Ne(e,t,i,n,s,a){const r=(0,o.g2)("van-cell"),c=(0,o.g2)("van-slider"),l=(0,o.g2)("van-button"),u=(0,o.g2)("van-dialog");return(0,o.uX)(),(0,o.Wv)(u,{show:n.isVisible,"onUpdate:show":t[3]||(t[3]=e=>n.isVisible=e),title:"混响设置",onClose:a.onCloseDialog},{default:(0,o.k6)((()=>[(0,o.Lk)("div",ye,[(0,o.bF)(r,{title:"混响时间:",value:n.option.value.time},null,8,["value"]),(0,o.Lk)("div",Ce,[(0,o.bF)(c,{modelValue:n.option.value.time,"onUpdate:modelValue":t[0]||(t[0]=e=>n.option.value.time=e),onChange:a.onTimeChange,min:"0",max:"5",step:"0.1"},null,8,["modelValue","onChange"])]),(0,o.bF)(r,{title:"衰减",value:n.option.value.decay},null,8,["value"]),(0,o.Lk)("div",Ae,[(0,o.bF)(c,{modelValue:n.option.value.decay,"onUpdate:modelValue":t[1]||(t[1]=e=>n.option.value.decay=e),onChange:a.onDecayChange,min:"0",max:"5",step:"0.1"},null,8,["modelValue","onChange"])]),(0,o.bF)(r,{title:"混合",value:n.option.value.mix},null,8,["value"]),(0,o.Lk)("div",xe,[(0,o.bF)(c,{modelValue:n.option.value.mix,"onUpdate:modelValue":t[2]||(t[2]=e=>n.option.value.mix=e),onChange:a.onMixChange,min:"0",max:"1",step:"0.01"},null,8,["modelValue","onChange"])]),(0,o.Lk)("div",we,[(0,o.bF)(l,{type:"warning",size:"small",onClick:a.onReset},{default:(0,o.k6)((()=>[(0,o.eW)("重置参数")])),_:1},8,["onClick"])])])])),_:1},8,["show","onClose"])}var ke={name:"setting",props:{},emits:["change"],setup(e,{emit:t}){const i=l();let n=(0,ue.KR)(!1),o=(0,ue.KR)({});return{isVisible:n,option:o,store:i}},methods:{show(e){this.isVisible=!0,this.option.value=e},onCloseDialog(){this.isVisible=!1,this.option.value={},this.$emit("close")},onTimeChange(e){this.option.value.time=e,this.$emit("change",this.option.value)},onDecayChange(e){this.option.value.decay=e,this.$emit("change",this.option.value)},onMixChange(e){this.option.value.mix=e,this.$emit("change",this.option.value)},onReset(){this.option.value.time=this.store.reverbOption_default.time,this.option.value.decay=this.store.reverbOption_default.decay,this.option.value.mix=this.store.reverbOption_default.mix,this.$emit("change",this.option.value)}}};const Le=(0,g.A)(ke,[["render",Ne],["__scopeId","data-v-731bbba6"]]);var Se=Le;function Te(e){var t={},i=t;t.context=e;var n=t.context.createGain();n.connect(t.context.destination),t.Util={isString:function(e){return"[object String]"===toString.call(e)},isObject:function(e){return"[object Object]"===toString.call(e)},isFunction:function(e){return"[object Function]"===toString.call(e)},isNumber:function(e){return"[object Number]"===toString.call(e)&&e===+e},isArray:function(e){return"[object Array]"===toString.call(e)},isInRange:function(e,t,n){return!!(i.Util.isNumber(e)&&i.Util.isNumber(t)&&i.Util.isNumber(n))&&(e>=t&&e<=n)},isBool:function(e){return"boolean"===typeof e},isOscillator:function(e){return e&&"[object OscillatorNode]"===e.toString()},isAudioBufferSourceNode:function(e){return e&&"[object AudioBufferSourceNode]"===e.toString()},isSound:function(e){return e instanceof i.Sound},isEffect:function(e){for(var i in t.Effects)if(e instanceof t.Effects[i])return!0;return!1},normalize:function(e,t,n){if(i.Util.isNumber(e)&&i.Util.isNumber(t)&&i.Util.isNumber(n))return(n-t)*e/1+t},getDryLevel:function(e){return!i.Util.isNumber(e)||e>1||e<0?0:e<=.5?1:1-2*(e-.5)},getWetLevel:function(e){return!i.Util.isNumber(e)||e>1||e<0?0:e>=.5?1:1-2*(.5-e)}};var o=t.context.createGain(),s=Object.getPrototypeOf(Object.getPrototypeOf(o)),a=s.connect;s.connect=function(e){var t=i.Util.isEffect(e);return t?(a.call(this,e.inputNode),e):a.apply(this,arguments)},Object.defineProperty(t,"volume",{enumerable:!0,get:function(){return n.gain.value},set:function(e){i.Util.isInRange(e,0,1)&&n&&(n.gain.value=e)}}),Object.defineProperty(t,"masterGainNode",{enumerable:!1,get:function(){return n},set:function(e){console.error("Can't set the master gain node")}}),t.Events={on:function(e,t,i){if(e&&t){this._events=this._events||{};var n=this._events[e]||(this._events[e]=[]);n.push({callback:t,context:i||this,handler:this})}},trigger:function(e){var t,i,n,o;if(e&&(this._events=this._events||{},t=this._events[e]||(this._events[e]=[]),t)){for(i=Math.max(0,arguments.length-1),n=[],o=0;o<i;o++)n[o]=arguments[o+1];for(o=0;o<t.length;o++)t[o].callback.apply(t[o].context,n)}},off:function(e){e?this._events[e]=void 0:this._events={}}},t.Sound=function(e,n){var o=this,s=t.Util,a=u(e),r=s.isObject(e)&&s.isObject(e.options),c=.04,l=.04;if(a)throw console.error(a),new Error("Error initializing Pizzicato Sound: "+a);function u(e){var t=["wave","file","input","script","sound"];if(e&&!s.isFunction(e)&&!s.isString(e)&&!s.isObject(e))return"Description type not supported. Initialize a sound using an object, a function or a string.";if(s.isObject(e)){if(!s.isString(e.source)||-1===t.indexOf(e.source))return"Specified source not supported. Sources can be wave, file, input or script";if("file"===e.source&&(!e.options||!e.options.path))return"A path is needed for sounds with a file source";if("script"===e.source&&(!e.options||!e.options.audioFunction))return"An audio function is needed for sounds with a script source"}}function h(e,n){e=e||{},this.getRawSourceNode=function(){var i=this.sourceNode?this.sourceNode.frequency.value:e.frequency,n=t.context.createOscillator();return n.type=e.type||"sine",n.frequency.value=i||440,n},this.sourceNode=this.getRawSourceNode(),this.sourceNode.gainSuccessor=i.context.createGain(),this.sourceNode.connect(this.sourceNode.gainSuccessor),s.isFunction(n)&&n()}function d(e,i){e=s.isArray(e)?e:[e];var n=new XMLHttpRequest;n.open("GET",e[0],!0),n.responseType="arraybuffer",n.onload=function(n){t.context.decodeAudioData(n.target.response,function(e){o.getRawSourceNode=function(){var i=t.context.createBufferSource();return i.loop=this.loop,i.buffer=e,i},s.isFunction(i)&&i()}.bind(o),function(t){if(console.error("Error decoding audio file "+e[0]),e.length>1)return e.shift(),void d(e,i);t=t||new Error("Error decoding audio file "+e[0]),s.isFunction(i)&&i(t)}.bind(o))},n.onreadystatechange=function(t){4===n.readyState&&200!==n.status&&console.error("Error while fetching "+e[0]+". "+n.statusText)},n.send()}function f(e,i){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia||navigator.mediaDevices.getUserMedia){var n=function(e){o.getRawSourceNode=function(){return t.context.createMediaStreamSource(e)},s.isFunction(i)&&i()}.bind(o),a=function(e){s.isFunction(i)&&i(e)};navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(n).catch(a):navigator.getUserMedia({audio:!0},n,a)}else console.error("Your browser does not support getUserMedia")}function m(e,i){var n=s.isFunction(e)?e:e.audioFunction,o=s.isObject(e)&&e.bufferSize?e.bufferSize:null;if(!o)try{t.context.createScriptProcessor()}catch(a){o=2048}this.getRawSourceNode=function(){var e=t.context.createScriptProcessor(o,1,1);return e.onaudioprocess=n,e}}function g(e,t){this.getRawSourceNode=e.sound.getRawSourceNode,e.sound.sourceNode&&i.Util.isOscillator(e.sound.sourceNode)&&(this.sourceNode=this.getRawSourceNode(),this.frequency=e.sound.frequency)}this.detached=r&&e.options.detached,this.masterVolume=t.context.createGain(),this.fadeNode=t.context.createGain(),this.fadeNode.gain.value=0,this.detached||this.masterVolume.connect(t.masterGainNode),this.lastTimePlayed=0,this.effects=[],this.effectConnectors=[],this.playing=this.paused=!1,this.loop=r&&e.options.loop,this.attack=r&&s.isNumber(e.options.attack)?e.options.attack:c,this.volume=r&&s.isNumber(e.options.volume)?e.options.volume:1,r&&s.isNumber(e.options.release)?this.release=e.options.release:r&&s.isNumber(e.options.sustain)?(console.warn("'sustain' is deprecated. Use 'release' instead."),this.release=e.options.sustain):this.release=l,e?s.isString(e)?d.bind(this)(e,n):s.isFunction(e)?m.bind(this)(e,n):"file"===e.source?d.bind(this)(e.options.path,n):"wave"===e.source?h.bind(this)(e.options,n):"input"===e.source?f.bind(this)(e,n):"script"===e.source?m.bind(this)(e.options,n):"sound"===e.source&&g.bind(this)(e.options,n):h.bind(this)({},n)},t.Sound.prototype=Object.create(t.Events,{play:{enumerable:!0,value:function(e,n){this.playing||(i.Util.isNumber(n)||(n=this.offsetTime||0),i.Util.isNumber(e)||(e=0),this.playing=!0,this.paused=!1,this.sourceNode=this.getSourceNode(),this.applyAttack(),i.Util.isFunction(this.sourceNode.start)&&(this.lastTimePlayed=t.context.currentTime-n,this.sourceNode.start(i.context.currentTime+e,n)),this.trigger("play"))}},stop:{enumerable:!0,value:function(){(this.paused||this.playing)&&(this.paused=this.playing=!1,this.stopWithRelease(),this.offsetTime=0,this.trigger("stop"))}},pause:{enumerable:!0,value:function(){if(!this.paused&&this.playing){this.paused=!0,this.playing=!1,this.stopWithRelease();var e=i.context.currentTime-this.lastTimePlayed;this.sourceNode.buffer?this.offsetTime=e%(this.sourceNode.buffer.length/i.context.sampleRate):this.offsetTime=e,this.trigger("pause")}}},clone:{enumerable:!0,value:function(){for(var e=new t.Sound({source:"sound",options:{loop:this.loop,attack:this.attack,release:this.release,volume:this.volume,sound:this}}),i=0;i<this.effects.length;i++)e.addEffect(this.effects[i]);return e}},onEnded:{enumerable:!0,value:function(e){return function(){this.sourceNode&&this.sourceNode!==e||(this.playing&&this.stop(),this.paused||this.trigger("end"))}}},addEffect:{enumerable:!0,value:function(e){if(!i.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.fadeNode;t.disconnect(),t.connect(e);var n=i.context.createGain();return this.effectConnectors.push(n),e.connect(n),n.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this sound."),this;var i=this.playing;i&&this.pause();var n=0===t?this.fadeNode:this.effectConnectors[t-1];n.disconnect();var o,s=this.effectConnectors[t];return s.disconnect(),e.disconnect(s),this.effectConnectors.splice(t,1),this.effects.splice(t,1),o=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],n.connect(o),i&&this.play(),this}},connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},connectEffects:{enumerable:!0,value:function(){for(var e=[],t=0;t<this.effects.length;t++){var n=t===this.effects.length-1,o=n?this.masterVolume:this.effects[t+1].inputNode;e[t]=i.context.createGain(),this.effects[t].outputNode.disconnect(this.effectConnectors[t]),this.effects[t].outputNode.connect(o)}}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){i.Util.isInRange(e,0,1)&&this.masterVolume&&(this.masterVolume.gain.value=e)}},frequency:{enumerable:!0,get:function(){return this.sourceNode&&i.Util.isOscillator(this.sourceNode)?this.sourceNode.frequency.value:null},set:function(e){this.sourceNode&&i.Util.isOscillator(this.sourceNode)&&(this.sourceNode.frequency.value=e)}},sustain:{enumerable:!0,get:function(){return console.warn("'sustain' is deprecated. Use 'release' instead."),this.release},set:function(e){console.warn("'sustain' is deprecated. Use 'release' instead."),i.Util.isInRange(e,0,10)&&(this.release=e)}},getSourceNode:{enumerable:!0,value:function(){if(this.sourceNode){var e=this.sourceNode;e.gainSuccessor.gain.setValueAtTime(e.gainSuccessor.gain.value,i.context.currentTime),e.gainSuccessor.gain.linearRampToValueAtTime(1e-4,i.context.currentTime+.2),setTimeout((function(){e.disconnect(),e.gainSuccessor.disconnect()}),200)}var t=this.getRawSourceNode();return t.gainSuccessor=i.context.createGain(),t.connect(t.gainSuccessor),t.gainSuccessor.connect(this.fadeNode),this.fadeNode.connect(this.getInputNode()),i.Util.isAudioBufferSourceNode(t)&&(t.onended=this.onEnded(t).bind(this)),t}},getInputNode:{enumerable:!0,value:function(){return this.effects.length>0?this.effects[0].inputNode:this.masterVolume}},applyAttack:{enumerable:!1,value:function(){this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(i.context.currentTime),this.attack){var e=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,t=this.attack;e||(t=(1-this.fadeNode.gain.value)*this.attack),this.fadeNode.gain.setTargetAtTime(1,i.context.currentTime,2*t)}else this.fadeNode.gain.setTargetAtTime(1,i.context.currentTime,.001)}},stopWithRelease:{enumerable:!1,value:function(e){var t=this.sourceNode,n=function(){return i.Util.isFunction(t.stop)?t.stop(0):t.disconnect()};this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(i.context.currentTime),!this.release)return this.fadeNode.gain.setTargetAtTime(0,i.context.currentTime,.001),void n();var o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,s=this.release;o||(s=this.fadeNode.gain.value*this.release),this.fadeNode.gain.setTargetAtTime(1e-5,i.context.currentTime,s/5),window.setTimeout((function(){n()}),1e3*s)}}}),t.Group=function(e){e=e||[],this.mergeGainNode=i.context.createGain(),this.masterVolume=i.context.createGain(),this.sounds=[],this.effects=[],this.effectConnectors=[],this.mergeGainNode.connect(this.masterVolume),this.masterVolume.connect(i.masterGainNode);for(var t=0;t<e.length;t++)this.addSound(e[t])},t.Group.prototype=Object.create(i.Events,{connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},addSound:{enumerable:!0,value:function(e){i.Util.isSound(e)?this.sounds.indexOf(e)>-1?console.warn("The Pizzicato.Sound object was already added to this group"):e.detached?console.warn("Groups do not support detached sounds. You can manually create an audio graph to group detached sounds together."):(e.disconnect(i.masterGainNode),e.connect(this.mergeGainNode),this.sounds.push(e)):console.error("You can only add Pizzicato.Sound objects")}},removeSound:{enumerable:!0,value:function(e){var t=this.sounds.indexOf(e);-1!==t?(e.disconnect(this.mergeGainNode),e.connect(i.masterGainNode),this.sounds.splice(t,1)):console.warn("Cannot remove a sound that is not part of this group.")}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){i.Util.isInRange(e,0,1)&&(this.masterVolume.gain.value=e)}},play:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].play();this.trigger("play")}},stop:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].stop();this.trigger("stop")}},pause:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].pause();this.trigger("pause")}},addEffect:{enumerable:!0,value:function(e){if(!i.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.mergeGainNode;t.disconnect(),t.connect(e);var n=i.context.createGain();return this.effectConnectors.push(n),e.connect(n),n.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this group."),this;var i=0===t?this.mergeGainNode:this.effectConnectors[t-1];i.disconnect();var n,o=this.effectConnectors[t];return o.disconnect(),e.disconnect(o),this.effectConnectors.splice(t,1),this.effects.splice(t,1),n=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],i.connect(n),this}}}),t.Effects={};var r=Object.create(null,{connect:{enumerable:!0,value:function(e){return this.outputNode.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.outputNode.disconnect(e),this}}});function c(e,n){this.options={},e=e||this.options;var o={frequency:350,peak:1};for(var s in this.inputNode=this.filterNode=i.context.createBiquadFilter(),this.filterNode.type=n,this.outputNode=t.context.createGain(),this.filterNode.connect(this.outputNode),o)this[s]=e[s],this[s]=void 0===this[s]||null===this[s]?o[s]:this[s]}t.Effects.Delay=function(e){this.options={},e=e||this.options;var i={feedback:.5,time:.3,mix:.5};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.delayNode),this.inputNode.connect(this.delayNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.Delay.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){i.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Compressor=function(e){this.options={},e=e||this.options;var i={threshold:-24,knee:30,attack:.003,release:.25,ratio:12};for(var n in this.inputNode=this.compressorNode=t.context.createDynamicsCompressor(),this.outputNode=t.context.createGain(),this.compressorNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.Compressor.prototype=Object.create(r,{threshold:{enumerable:!0,get:function(){return this.compressorNode.threshold.value},set:function(e){t.Util.isInRange(e,-100,0)&&(this.compressorNode.threshold.value=e)}},knee:{enumerable:!0,get:function(){return this.compressorNode.knee.value},set:function(e){t.Util.isInRange(e,0,40)&&(this.compressorNode.knee.value=e)}},attack:{enumerable:!0,get:function(){return this.compressorNode.attack.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.attack.value=e)}},release:{enumerable:!0,get:function(){return this.compressorNode.release.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.release.value=e)}},ratio:{enumerable:!0,get:function(){return this.compressorNode.ratio.value},set:function(e){t.Util.isInRange(e,1,20)&&(this.compressorNode.ratio.value=e)}},getCurrentGainReduction:function(){return this.compressorNode.reduction}}),t.Effects.LowPassFilter=function(e){c.call(this,e,"lowpass")},t.Effects.HighPassFilter=function(e){c.call(this,e,"highpass")};var l=Object.create(r,{frequency:{enumerable:!0,get:function(){return this.filterNode.frequency.value},set:function(e){t.Util.isInRange(e,10,22050)&&(this.filterNode.frequency.value=e)}},peak:{enumerable:!0,get:function(){return this.filterNode.Q.value},set:function(e){t.Util.isInRange(e,1e-4,1e3)&&(this.filterNode.Q.value=e)}}});function u(){var e,n,o=i.context.sampleRate*this.time,s=t.context.createBuffer(2,o,i.context.sampleRate),a=s.getChannelData(0),r=s.getChannelData(1);for(n=0;n<o;n++)e=this.reverse?o-n:n,a[n]=(2*Math.random()-1)*Math.pow(1-e/o,this.decay),r[n]=(2*Math.random()-1)*Math.pow(1-e/o,this.decay);this.reverbNode.buffer&&(this.inputNode.disconnect(this.reverbNode),this.reverbNode.disconnect(this.wetGainNode),this.reverbNode=t.context.createConvolver(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode)),this.reverbNode.buffer=s}t.Effects.LowPassFilter.prototype=l,t.Effects.HighPassFilter.prototype=l,t.Effects.Distortion=function(e){this.options={},e=e||this.options;var i={gain:.5};for(var n in this.waveShaperNode=t.context.createWaveShaper(),this.inputNode=this.outputNode=this.waveShaperNode,i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.Distortion.prototype=Object.create(r,{gain:{enumerable:!0,get:function(){return this.options.gain},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.gain=e,this.adjustGain())}},adjustGain:{writable:!1,configurable:!1,enumerable:!1,value:function(){for(var e,t=i.Util.isNumber(this.options.gain)?parseInt(100*this.options.gain,10):50,n=44100,o=new Float32Array(n),s=Math.PI/180,a=0;a<n;++a)e=2*a/n-1,o[a]=(3+t)*e*20*s/(Math.PI+t*Math.abs(e));this.waveShaperNode.curve=o}}}),t.Effects.Flanger=function(e){this.options={},e=e||this.options;var i={time:.45,speed:.2,depth:.1,feedback:.1,mix:.5};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.inputFeedbackNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.oscillatorNode=t.context.createOscillator(),this.gainNode=t.context.createGain(),this.feedbackNode=t.context.createGain(),this.oscillatorNode.type="sine",this.inputNode.connect(this.inputFeedbackNode),this.inputNode.connect(this.dryGainNode),this.inputFeedbackNode.connect(this.delayNode),this.inputFeedbackNode.connect(this.wetGainNode),this.delayNode.connect(this.wetGainNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.inputFeedbackNode),this.oscillatorNode.connect(this.gainNode),this.gainNode.connect(this.delayNode.delayTime),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),this.oscillatorNode.start(0),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.Flanger.prototype=Object.create(r,{time:{enumberable:!0,get:function(){return this.options.time},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.time=e,this.delayNode.delayTime.value=i.Util.normalize(e,.001,.02))}},speed:{enumberable:!0,get:function(){return this.options.speed},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.speed=e,this.oscillatorNode.frequency.value=i.Util.normalize(e,.5,5))}},depth:{enumberable:!0,get:function(){return this.options.depth},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.depth=e,this.gainNode.gain.value=i.Util.normalize(e,5e-4,.005))}},feedback:{enumberable:!0,get:function(){return this.options.feedback},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.feedback=e,this.feedbackNode.gain.value=i.Util.normalize(e,0,.8))}},mix:{enumberable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.StereoPanner=function(e){this.options={},e=e||this.options;var i={pan:0};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),t.context.createStereoPanner?(this.pannerNode=t.context.createStereoPanner(),this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):t.context.createPanner?(console.warn("Your browser does not support the StereoPannerNode. Will use PannerNode instead."),this.pannerNode=t.context.createPanner(),this.pannerNode.type="equalpower",this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):(console.warn("Your browser does not support the Panner effect."),this.inputNode.connect(this.outputNode)),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.StereoPanner.prototype=Object.create(r,{pan:{enumerable:!0,get:function(){return this.options.pan},set:function(e){if(i.Util.isInRange(e,-1,1)&&(this.options.pan=e,this.pannerNode)){var t=this.pannerNode.toString().indexOf("StereoPannerNode")>-1;t?this.pannerNode.pan.value=e:this.pannerNode.setPosition(e,0,1-Math.abs(e))}}}}),t.Effects.Convolver=function(e,n){this.options={},e=e||this.options;var o=this,s=new XMLHttpRequest,a={mix:.5};for(var r in this.callback=n,this.inputNode=t.context.createGain(),this.convolverNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.convolverNode),this.convolverNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),a)this[r]=e[r],this[r]=void 0===this[r]||null===this[r]?a[r]:this[r];e.impulse?(s.open("GET",e.impulse,!0),s.responseType="arraybuffer",s.onload=function(e){var n=e.target.response;t.context.decodeAudioData(n,(function(e){o.convolverNode.buffer=e,o.callback&&i.Util.isFunction(o.callback)&&o.callback()}),(function(e){e=e||new Error("Error decoding impulse file"),o.callback&&i.Util.isFunction(o.callback)&&o.callback(e)}))},s.onreadystatechange=function(t){4===s.readyState&&200!==s.status&&console.error("Error while fetching "+e.impulse+". "+s.statusText)},s.send()):console.error("No impulse file specified.")},t.Effects.Convolver.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.PingPongDelay=function(e){this.options={},e=e||this.options;var i={feedback:.5,time:.3,mix:.5};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.delayNodeLeft=t.context.createDelay(),this.delayNodeRight=t.context.createDelay(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.channelMerger=t.context.createChannelMerger(2),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNodeLeft.connect(this.channelMerger,0,0),this.delayNodeRight.connect(this.channelMerger,0,1),this.delayNodeLeft.connect(this.delayNodeRight),this.feedbackGainNode.connect(this.delayNodeLeft),this.delayNodeRight.connect(this.feedbackGainNode),this.inputNode.connect(this.feedbackGainNode),this.channelMerger.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.PingPongDelay.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){i.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNodeLeft.delayTime.value=e,this.delayNodeRight.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Reverb=function(e){this.options={},e=e||this.options;var i={mix:.5,time:.01,decay:.01,reverse:!1};for(var n in this.inputNode=t.context.createGain(),this.reverbNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n];u.bind(this)()},t.Effects.Reverb.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){i.Util.isInRange(e,1e-4,10)&&(this.options.time=e,u.bind(this)())}},decay:{enumerable:!0,get:function(){return this.options.decay},set:function(e){i.Util.isInRange(e,1e-4,10)&&(this.options.decay=e,u.bind(this)())}},reverse:{enumerable:!0,get:function(){return this.options.reverse},set:function(e){i.Util.isBool(e)&&(this.options.reverse=e,u.bind(this)())}}}),t.Effects.Tremolo=function(e){this.options={},e=e||this.options;var i={speed:4,depth:1,mix:.8};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.tremoloGainNode=t.context.createGain(),this.tremoloGainNode.gain.value=0,this.lfoNode=t.context.createOscillator(),this.shaperNode=t.context.createWaveShaper(),this.shaperNode.curve=new Float32Array([0,1]),this.shaperNode.connect(this.tremoloGainNode.gain),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.lfoNode.connect(this.shaperNode),this.lfoNode.type="sine",this.lfoNode.start(0),this.inputNode.connect(this.tremoloGainNode),this.tremoloGainNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.Tremolo.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){i.Util.isInRange(e,0,20)&&(this.options.speed=e,this.lfoNode.frequency.value=e)}},depth:{enumerable:!0,get:function(){return this.options.depth},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.depth=e,this.shaperNode.curve=new Float32Array([1-e,1]))}}}),t.Effects.DubDelay=function(e){this.options={},e=e||this.options;var i={feedback:.6,time:.7,mix:.5,cutoff:700};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.bqFilterNode=t.context.createBiquadFilter(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.bqFilterNode),this.bqFilterNode.connect(this.delayNode),this.delayNode.connect(this.feedbackGainNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]},t.Effects.DubDelay.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){i.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}},cutoff:{enumerable:!0,get:function(){return this.options.cutoff},set:function(e){i.Util.isInRange(e,0,4e3)&&(this.options.cutoff=e,this.bqFilterNode.frequency.value=this.cutoff)}}}),t.Effects.RingModulator=function(e){this.options={},e=e||this.options;var i={speed:30,distortion:1,mix:.5};for(var n in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.vIn=t.context.createOscillator(),this.vIn.start(0),this.vInGain=t.context.createGain(),this.vInGain.gain.value=.5,this.vInInverter1=t.context.createGain(),this.vInInverter1.gain.value=-1,this.vInInverter2=t.context.createGain(),this.vInInverter2.gain.value=-1,this.vInDiode1=new h(t.context),this.vInDiode2=new h(t.context),this.vInInverter3=t.context.createGain(),this.vInInverter3.gain.value=-1,this.vcInverter1=t.context.createGain(),this.vcInverter1.gain.value=-1,this.vcDiode3=new h(t.context),this.vcDiode4=new h(t.context),this.outGain=t.context.createGain(),this.outGain.gain.value=3,this.compressor=t.context.createDynamicsCompressor(),this.compressor.threshold.value=-24,this.compressor.ratio.value=16,this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.vcInverter1),this.inputNode.connect(this.vcDiode4.node),this.vcInverter1.connect(this.vcDiode3.node),this.vIn.connect(this.vInGain),this.vInGain.connect(this.vInInverter1),this.vInGain.connect(this.vcInverter1),this.vInGain.connect(this.vcDiode4.node),this.vInInverter1.connect(this.vInInverter2),this.vInInverter1.connect(this.vInDiode2.node),this.vInInverter2.connect(this.vInDiode1.node),this.vInDiode1.connect(this.vInInverter3),this.vInDiode2.connect(this.vInInverter3),this.vInInverter3.connect(this.compressor),this.vcDiode3.connect(this.compressor),this.vcDiode4.connect(this.compressor),this.compressor.connect(this.outGain),this.outGain.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),i)this[n]=e[n],this[n]=void 0===this[n]||null===this[n]?i[n]:this[n]};var h=function(e){this.context=e,this.node=this.context.createWaveShaper(),this.vb=.2,this.vl=.4,this.h=1,this.setCurve()};function d(e){for(var t=i.context.sampleRate,n=new Float32Array(t),o=Math.PI/180,s=0;s<t;s++){var a=2*s/t-1;n[s]=(3+e)*a*20*o/(Math.PI+e*Math.abs(a))}return n}return h.prototype.setDistortion=function(e){return this.h=e,this.setCurve()},h.prototype.setCurve=function(){var e,t,i,n,o,s,a,r;for(t=1024,o=new Float32Array(t),e=s=0,a=o.length;0<=a?s<a:s>a;e=0<=a?++s:--s)i=(e-t/2)/(t/2),i=Math.abs(i),n=i<=this.vb?0:this.vb<i&&i<=this.vl?this.h*(Math.pow(i-this.vb,2)/(2*this.vl-2*this.vb)):this.h*i-this.h*this.vl+this.h*(Math.pow(this.vl-this.vb,2)/(2*this.vl-2*this.vb)),o[e]=n;return r=this.node.curve=o,r},h.prototype.connect=function(e){return this.node.connect(e)},t.Effects.RingModulator.prototype=Object.create(r,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){i.Util.isInRange(e,0,2e3)&&(this.options.speed=e,this.vIn.frequency.value=e)}},distortion:{enumerable:!0,get:function(){return this.options.distortion},set:function(e){if(i.Util.isInRange(e,.2,50)){this.options.distortion=parseFloat(e,10);for(var t=[this.vInDiode1,this.vInDiode2,this.vcDiode3,this.vcDiode4],n=0,o=t.length;n<o;n++)t[n].setDistortion(e)}}}}),t.Effects.Quadrafuzz=function(e){this.options={},e=e||this.options;var t={lowGain:.6,midLowGain:.8,midHighGain:.5,highGain:.6};this.inputNode=i.context.createGain(),this.outputNode=i.context.createGain(),this.dryGainNode=i.context.createGain(),this.wetGainNode=i.context.createGain(),this.lowpassLeft=i.context.createBiquadFilter(),this.lowpassLeft.type="lowpass",this.lowpassLeft.frequency.value=147,this.lowpassLeft.Q.value=.7071,this.bandpass1Left=i.context.createBiquadFilter(),this.bandpass1Left.type="bandpass",this.bandpass1Left.frequency.value=587,this.bandpass1Left.Q.value=.7071,this.bandpass2Left=i.context.createBiquadFilter(),this.bandpass2Left.type="bandpass",this.bandpass2Left.frequency.value=2490,this.bandpass2Left.Q.value=.7071,this.highpassLeft=i.context.createBiquadFilter(),this.highpassLeft.type="highpass",this.highpassLeft.frequency.value=4980,this.highpassLeft.Q.value=.7071,this.overdrives=[];for(var n=0;n<4;n++)this.overdrives[n]=i.context.createWaveShaper(),this.overdrives[n].curve=d();this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode);var o=[this.lowpassLeft,this.bandpass1Left,this.bandpass2Left,this.highpassLeft];for(n=0;n<o.length;n++)this.wetGainNode.connect(o[n]),o[n].connect(this.overdrives[n]),this.overdrives[n].connect(this.outputNode);for(var s in t)this[s]=e[s],this[s]=void 0===this[s]||null===this[s]?t[s]:this[s]},t.Effects.Quadrafuzz.prototype=Object.create(r,{lowGain:{enumerable:!0,get:function(){return this.options.lowGain},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.lowGain=e,this.overdrives[0].curve=d(i.Util.normalize(this.lowGain,0,150)))}},midLowGain:{enumerable:!0,get:function(){return this.options.midLowGain},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.midLowGain=e,this.overdrives[1].curve=d(i.Util.normalize(this.midLowGain,0,150)))}},midHighGain:{enumerable:!0,get:function(){return this.options.midHighGain},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.midHighGain=e,this.overdrives[2].curve=d(i.Util.normalize(this.midHighGain,0,150)))}},highGain:{enumerable:!0,get:function(){return this.options.highGain},set:function(e){i.Util.isInRange(e,0,1)&&(this.options.highGain=e,this.overdrives[3].curve=d(i.Util.normalize(this.highGain,0,150)))}}}),t}let Ge;var Re={name:"EditView",components:{ReverbDialog:Se},setup(){Ge=Te(new(window.AudioContext||window.webkitAudioContext));const e=l(),t=(0,ue.KR)(null);return{store:e,util:y,rbDlg:t}},data(){return{musicName:"",curLrc:"",curTime:0,remainTime:0,playing:!1,humanVal:90,accompanyVal:70,reverbMap:{},curReverbConvolver:null,audioContext:null,offlineAudioCtx:null,dragging:!1,bgGain:null,voiceGain:null,bgSource:null,voiceSource:null,rTimer:null,delayPlayTimer:null,bgSource:null,voiceSource:null}},mounted(){if(document.addEventListener("visibilitychange",this.setVisibilyChange),!this.store.audioChunk||!this.store.audioChunk.length||!this.store.banzou)return alert("没有找到需要编辑的音频"),void this.$router.replace("/");this.audioContext=Ge.context,this.store.recordLength||(this.store.recordLength=this.store.banzouLength),this.init([...this.store.audioChunk],this.store.banzou,this.store.recordLength),this.musicName=this.store.banzou.name.replace(/\.mp3$/i,"")},unmounted(){document.removeEventListener("visibilitychange",this.setVisibilyChange),this.rTimer&&cancelAnimationFrame(this.rTimer),this.delayPlayTimer&&clearTimeout(this.delayPlayTimer);try{this.bgSource.disconnect(),this.bgSource.buffer=null,this.voiceSource.disconnect(),this.voiceSource.buffer=null}catch(e){}try{this.audioContext.close()}catch(e){console.log(e)}try{this.offlineAudioCtx&&("running"==this.offlineAudioCtx.state&&this.offlineAudioCtx.suspend(this.offlineAudioCtx.currentTime),this.offlineAudioCtx=null)}catch(e){console.log(e)}console.log("hide loading"),this.store.hideLoading(),this.store.hideProgess(),me(),he.stop(),Ge=null},methods:{setVisibilyChange(){if("visible"===document.visibilityState)try{this.audioContext.suspend()}catch(e){}else"hidden"===document.visibilityState&&this.doStop()},onBack(){this.$router.replace("/")},reRecord(){(0,I.M5)({title:"提示",message:"是否要重录?"}).then((()=>{this.$router.replace("/record")})).catch((()=>{}))},async getReverb(e){const t="audio/reverb"+e+".wav";try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok "+e.statusText);const i=await e.arrayBuffer(),n=await this.audioContext.decodeAudioData(i);return console.log(n),n}catch(i){return console.error("There has been a problem with your fetch operation:",i),null}},async onReverbChange(e){e?(this.voiceGain.disconnect(),this.voiceGain.connect(this.curReverbNode),this.curReverbNode.connect(this.audioContext.destination)):(this.curReverbNode.disconnect(),this.voiceGain.disconnect(),this.voiceGain.connect(this.audioContext.destination))},onReverbDetailChange(e){this.curReverbNode&&(this.store.reverbOption={...e},this.curReverbNode.time=this.store.reverbOption.time,this.curReverbNode.decay=this.store.reverbOption.decay,this.curReverbNode.mix=this.store.reverbOption.mix)},onPlay(){this.doPlay()},onPause(){this.doStop()},onDurationChange(e){this.remainTime=this.audioContext.currentTime-e,this.jumpTo(e)},onAccompanyVoiceChange(e){this.bgGain&&(this.bgGain.gain.value=e/100,this.store.banzouVolume=e/100)},onHumanVoiceChange(e){this.voiceGain&&(this.voiceGain.gain.value=e/100,this.store.humanVolume=e/100)},exportSong(){this.doStop(),this.exportAudio(!1,this.store.compress)},exportHuman(){this.doStop(),this.exportAudio(!0,this.store.compress)},onDelayChange(){console.log(this.store.voiceDelay),this.jumpTo(this.curTime)},onReverbSetting(){this.rbDlg.show({...this.store.reverbOption})},async init(e,t,i){this.store.showLoading();const n=await this.loadAudioData(this.audioContext,t),o=this.audioContext.sampleRate,s=i*o,a=this.audioContext.createBuffer(2,s,o);a.getChannelData(0).set(n.getChannelData(0).subarray(0,s));let r=0;n.numberOfChannels>1&&(r=1),a.getChannelData(1).set(n.getChannelData(r).subarray(0,s));const c=this.audioContext.createBufferSource();c.buffer=a,this.bgGain=this.audioContext.createGain(),this.accompanyVal=parseInt(100*this.store.banzouVolume),this.bgGain.gain.value=this.store.banzouVolume,c.connect(this.bgGain),Tone.setContext(this.audioContext);var l=new Tone.PitchShift;l.pitch=this.store.banzouPitch,Tone.connect(this.bgGain,l),Tone.connect(l,this.audioContext.destination);for(let d=e.length-1;d>=1;--d){const t=e[d],i=e[d-1];let n=t.start-i.end;if(n<0&&(i.end=t.start),n>0){let o=this.createSilentAudio(this.audioContext,n);e.splice(d,0,{start:i.end,end:t.start,buffer:o})}}const u=this.audioContext.createBuffer(2,s,o);for(let d=0;d<e.length;d++){let t,i=e[d];t=i.buffer?i.buffer:await this.loadAudioData(this.audioContext,i.blob);const n=Math.floor(i.start*o),a=Math.min(n+t.length,s);u.getChannelData(0).set(t.getChannelData(0).slice(0,Math.floor(a-n)),n);let r=0;console.log("channel "+t.numberOfChannels),t.numberOfChannels>1&&(r=1),u.getChannelData(1).set(t.getChannelData(r).slice(0,Math.floor(a-n)),n)}const h=this.audioContext.createBufferSource();h.buffer=u,this.voiceGain=this.audioContext.createGain(),this.humanVal=parseInt(this.store.humanVolume),this.voiceGain.gain.value=this.store.humanVolume,h.connect(this.voiceGain),this.curReverbNode=new Ge.Effects.Reverb({...this.store.reverbOption}),this.onReverbChange(this.store.reverb),this.audioContext.onstatechange=()=>{console.log("state-> ",this.audioContext.state)},console.log("delay time->",this.audioContext.currentTime),this.bgSource=c,this.voiceSource=h,this.playing=!0,this.remainTime=this.audioContext.currentTime,this.setCurTime(),c.start(),this.startVoiceSource(),console.log("voiceSource",h),this.store.hideLoading()},doStop(e){console.log(this.audioContext.state),this.playing=!1,"running"==this.audioContext.state&&(this.audioContext.suspend(),e&&(this.curTime=0,this.rTimer=null,this.remainTime=this.audioContext.currentTime))},jumpTo(e){this.bgSource.stop();const t=this.audioContext.createBufferSource();t.buffer=this.bgSource.buffer,this.bgSource.disconnect(),this.bgSource.buffer=null,t.connect(this.bgGain),this.bgSource=t,console.log("bg",0,e),this.bgSource.start(0,e),this.voiceSource.stop();const i=this.audioContext.createBufferSource();i.buffer=this.voiceSource.buffer,this.voiceSource.disconnect(),this.voiceSource.buffer=null,i.connect(this.voiceGain),this.voiceSource=i,this.startVoiceSource(e)},startVoiceSource(e=0,t=this.voiceSource){this.delayPlayTimer&&(clearTimeout(this.delayPlayTimer),this.delayPlayTimer=null);let i=0;if(i=e+this.store.voiceDelay,i>=0)t.start(0,i);else{let e=-1e3*i;i=0,this.delayPlayTimer=setTimeout((()=>{t.start(0,i)}),e)}},doPlay(){console.log(this.audioContext.state),"running"!=this.audioContext.state&&(this.playing=!0,this.audioContext.resume(),this.rTimer||(this.setCurTime(),this.jumpTo(0)))},setCurTime(){let e=this.audioContext.currentTime-this.remainTime;e>=this.store.recordLength?this.doStop(!0):(this.dragging||(this.curTime=e),this.setCurLrc(),this.rTimer=requestAnimationFrame(this.setCurTime))},setCurLrc(){if(!this.store.parsedLyrics||!this.store.parsedLyrics.length)return;const e=this.curTime;for(let t=0;t<this.store.parsedLyrics.length;t++)if(e>=this.store.parsedLyrics[t].time&&(t===this.store.parsedLyrics.length-1||e<this.store.parsedLyrics[t+1].time)){this.curLrc=this.store.parsedLyrics[t].text;break}},createSilentAudio(e,t){const i=2,n=e.sampleRate*t,o=e.createBuffer(i,n,e.sampleRate);return o},loadAudioData(e,t){return new Promise(((i,n)=>{const o=new FileReader;o.onload=()=>{e.decodeAudioData(o.result).then((e=>i(e))).catch((e=>n(e)))},o.onerror=()=>n(o.error),o.readAsArrayBuffer(t)}))},async exportAudio(e,t){let i,n=this.store.recordLength,o=new OfflineAudioContext({numberOfChannels:2,length:48e3*n,sampleRate:48e3}),s=Te(o);if(this.offlineAudioCtx=o,!e){i=o.createBufferSource(),i.buffer=this.bgSource.buffer;let e=o.createGain();e.gain.value=this.store.banzouVolume,Tone.setContext(o);let t=new Tone.PitchShift;t.pitch=this.store.banzouPitch,i.connect(e),Tone.connect(e,t),Tone.connect(t,o.destination)}let a=o.createBufferSource();a.buffer=this.voiceSource.buffer;let r=o.createGain();if(r.gain.value=this.store.humanVolume,a.connect(r),this.store.reverb){let e=new s.Effects.Reverb({time:this.curReverbNode.time,decay:this.curReverbNode.decay,mix:this.curReverbNode.mix});r.connect(e),e.connect(o.destination)}else r.connect(o.destination);e||i.start(),this.startVoiceSource(0,a),console.log("start generate"),o.startRendering().then((e=>{this.offlineAudioCtx&&(console.log("渲染完成",e),t&&(0,E.P0)("正在压缩音频,可能要花费很长时间..."),be(e,o.length,t,(e=>{this.offlineAudioCtx&&this.store.showProgess(e)}),(()=>{this.store.hideProgess()})))})).catch((e=>{console.error("渲染错误:",e)})),(0,E.P0)("正在生成音频,请稍后..."),he.start(o,this.bgSource.buffer.duration,(e=>{this.offlineAudioCtx&&(console.log("progess",e),this.store.showProgess(e))}),(()=>{this.store.hideProgess(),e||(i.disconnect(),i.buffer=null),a.disconnect(),a.buffer=null}))}}};const Fe=(0,g.A)(Re,[["render",le],["__scopeId","data-v-52f7963e"]]);var Ie=Fe;const Ee=e=>((0,o.Qi)("data-v-bfc3cbf6"),e=e(),(0,o.jt)(),e),Ue={class:"container record"},De={class:"content c-text-center"},Ve={class:"c-lrcbox"},Be={class:"c-cd-dotbox"},Oe={class:"c-ctrlbox"},Pe=Ee((()=>(0,o.Lk)("span",null,"重唱",-1))),ze={class:"c-ctrlitem"},Me=Ee((()=>(0,o.Lk)("span",null,"完成",-1))),Qe={class:"c-timebox"},je={ref:"waveBox",width:"375",height:"40",class:"c-re-wave"};function Ke(e,t,i,s,a,r){const c=(0,o.g2)("van-nav-bar"),l=(0,o.g2)("van-picker"),u=(0,o.g2)("van-icon"),h=(0,o.g2)("van-button"),d=(0,o.g2)("van-action-sheet"),f=(0,o.g2)("SettingDialog");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Ue,[(0,o.bF)(c,{title:a.musicName,"left-text":"主页",onClickLeft:t[0]||(t[0]=e=>r.onBack()),"right-text":"设置",onClickRight:r.onSetting},null,8,["title","onClickRight"]),(0,o.Lk)("audio",{ref:"audio",onTimeupdate:t[1]||(t[1]=(...e)=>r.onTimeUpdate&&r.onTimeUpdate(...e)),style:{display:"none"},onEnded:t[2]||(t[2]=(...e)=>r.finish&&r.finish(...e)),onLoadedmetadata:t[3]||(t[3]=(...e)=>r.onLoadedMetadata&&r.onLoadedMetadata(...e))},null,544),(0,o.Lk)("div",De,[(0,o.Lk)("div",Ve,[(0,o.bF)(l,{onTouchstart:r.onTouchStart,onTouchend:r.onTouchEnd,class:(0,A.C4)(r.getCurClass()),"show-toolbar":!1,columns:s.store.parsedLyrics,onChange:r.onChange,modelValue:a.curVal,"onUpdate:modelValue":t[4]||(t[4]=e=>a.curVal=e),readonly:a.countingdown||!a.playing,"visible-option-num":"8","option-height":"8vh","swipe-duration":"400"},null,8,["onTouchstart","onTouchend","class","columns","onChange","modelValue","readonly"]),(0,o.bo)((0,o.Lk)("div",Be,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.dotCount,(e=>((0,o.uX)(),(0,o.CE)("i",{key:e,class:"c-cd-dotitem"})))),128))],512),[[n.aG,a.countingdown]])]),(0,o.Lk)("div",Oe,[(0,o.Lk)("div",{class:"c-ctrlitem",onClick:t[5]||(t[5]=(...e)=>r.onReplay&&r.onReplay(...e))},[(0,o.bF)(u,{name:"revoke",class:"c-ctrlicon"}),Pe]),(0,o.Lk)("div",ze,[(0,o.bo)((0,o.bF)(u,{name:"pause-circle-o",class:"c-ctrlicon-big",onClick:r.onPause},null,8,["onClick"]),[[n.aG,a.playing]]),(0,o.bo)((0,o.bF)(u,{name:"play-circle",class:"c-ctrlicon-big",onClick:r.onPlay},null,8,["onClick"]),[[n.aG,!a.playing]])]),(0,o.Lk)("div",{class:"c-ctrlitem",onClick:t[6]||(t[6]=(...e)=>r.onFinish&&r.onFinish(...e))},[(0,o.bF)(u,{name:"passed",class:"c-ctrlicon"}),Me])]),(0,o.Lk)("div",Qe,(0,A.v_)(s.util.convertTime(a.curTime))+" / "+(0,A.v_)(s.util.convertTime(s.store.banzouLength)),1),(0,o.Lk)("div",null,[(0,o.bo)((0,o.bF)(h,{class:"c-jump-btn",plain:"",type:"default",onClick:r.jumpToSing},{default:(0,o.k6)((()=>[(0,o.eW)("跳过前奏")])),_:1},8,["onClick"]),[[n.aG,a.jumpShow]])]),(0,o.Lk)("canvas",je,null,512)])]),(0,o.bF)(d,{show:a.fShow,"onUpdate:show":t[7]||(t[7]=e=>a.fShow=e),actions:a.fShowList,onSelect:r.onFshowSelect,"cancel-text":"取消","close-on-click-action":"",onCancel:r.onFshowCancel},null,8,["show","actions","onSelect","onCancel"]),(0,o.bF)(f,{visible:a.settingShow,"onUpdate:visible":t[8]||(t[8]=e=>a.settingShow=e)},null,8,["visible"])],64)}const We={class:"c-setting-box"},He={class:"c-setting-sliderbox"},Xe={class:"c-setting-sliderbox"},Ye={class:"c-setting-sliderbox"},Je={class:"c-setting-sliderbox"};function qe(e,t,i,n,s,a){const r=(0,o.g2)("van-cell"),c=(0,o.g2)("van-slider"),l=(0,o.g2)("van-radio"),u=(0,o.g2)("van-radio-group"),h=(0,o.g2)("van-dialog");return(0,o.uX)(),(0,o.Wv)(h,{show:n.isVisible,"onUpdate:show":t[4]||(t[4]=e=>n.isVisible=e),title:"设置",onClose:n.onCloseDialog},{default:(0,o.k6)((()=>[(0,o.Lk)("div",We,[(0,o.bF)(r,{title:"歌词同步",value:n.store.lrcDelayTime},null,8,["value"]),(0,o.Lk)("div",He,[(0,o.bF)(c,{modelValue:n.store.lrcDelayTime,"onUpdate:modelValue":t[0]||(t[0]=e=>n.store.lrcDelayTime=e),onChange:a.onlrcDelayChange,min:"-2",max:"2",step:"0.1"},null,8,["modelValue","onChange"])]),(0,o.bF)(r,{title:"歌词编码"}),(0,o.Lk)("div",Xe,[(0,o.bF)(u,{modelValue:n.store.lrcEncoding,"onUpdate:modelValue":t[1]||(t[1]=e=>n.store.lrcEncoding=e),direction:"horizontal",onChange:a.onLrcEncodingChange},{default:(0,o.k6)((()=>[(0,o.bF)(l,{name:"GBK"},{default:(0,o.k6)((()=>[(0,o.eW)("GBK")])),_:1}),(0,o.bF)(l,{name:"UTF-8"},{default:(0,o.k6)((()=>[(0,o.eW)("UTF-8")])),_:1})])),_:1},8,["modelValue","onChange"])]),(0,o.bF)(r,{title:"伴奏音量",value:parseInt(100*n.store.banzouVolume)},null,8,["value"]),(0,o.Lk)("div",Ye,[(0,o.bF)(c,{modelValue:n.store.banzouVolume,"onUpdate:modelValue":t[2]||(t[2]=e=>n.store.banzouVolume=e),onChange:a.onBanzouVolumeChange,min:"0",max:"1",step:"0.1"},null,8,["modelValue","onChange"])]),(0,o.bF)(r,{title:"伴奏音调",value:parseInt(10*n.store.banzouPitch)},null,8,["value"]),(0,o.Lk)("div",Je,[(0,o.bF)(c,{modelValue:n.store.banzouPitch,"onUpdate:modelValue":t[3]||(t[3]=e=>n.store.banzouPitch=e),onChange:a.onBanzouPitchChange,min:"-1.1",max:"1.1",step:"0.1"},null,8,["modelValue","onChange"])])])])),_:1},8,["show","onClose"])}var Ze={name:"setting",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(e,{emit:t}){const i=l(),n=(0,ue.KR)(e.visible);(0,o.wB)((()=>e.visible),(e=>{console.log(e),n.value=e}));let s=()=>{console.log("关闭对话框"),t("update:visible",!1)};return{store:i,isVisible:n,onCloseDialog:s}},methods:{onlrcDelayChange(e){this.store.parseLRC()},onLrcEncodingChange(e){this.store.readLrcText()},onBanzouVolumeChange(e){this.store.banzouVolume=e},onBanzouPitchChange(e){this.store.banzouPitch=e}}};const _e=(0,g.A)(Ze,[["render",qe],["__scopeId","data-v-4c15c93c"]]);var $e=_e,et={name:"RecordView",components:{SettingDialog:$e},setup(){const e=l();return{store:e,util:y}},data(){return{musicName:"",curTime:0,jumpShow:!1,audioUrl:null,curVal:[],countingdown:!1,dotCount:5,needCountdown:!1,showCountdownTime:null,scrolling:!1,playing:!1,fShow:!1,fShowList:[{name:"结束在当前位置"},{name:"结束并保留之后的伴奏"}],mediaRecorder:null,recordStarttime:0,settingShow:!1,audioCtx:null,pitchShift_banzou:null,gainNode_banzou:null,analyser:null,ctx:null}},mounted(){if(document.addEventListener("visibilitychange",this.setVisibilyChange),console.log(this.store),!this.store.banzou)return alert("请先选择伴奏文件"),void this.$router.replace("/");navigator.mediaDevices.getUserMedia({audio:{channelCount:2,sampleRate:48e3,sampleSize:16,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!0}}).then((e=>{this.initMediaRecorder(e),this.musicName=this.store.banzou.name.replace(/\.(mp3|wav)$/i,""),this.store.audioChunk=[],this.connectAuido(),this.initAnalyser(e),this.store.lrc?this.store.readLrcText().then((()=>{this.store.parsedLyrics[0]&&this.setCountdownTime(this.store.parsedLyrics[0].value),this.loadAudio()})):this.loadAudio()})).catch((e=>{console.log(e),alert("麦克风权限请求失败,无法进行录音")}))},unmounted(){document.removeEventListener("visibilitychange",this.setVisibilyChange),this.audioUrl&&(URL.revokeObjectURL(this.audioUrl),this.audioUrl=null),this.$refs.audio&&(this.$refs.audio.pause(),this.$refs.audio.src=""),this.mediaRecorder&&(this.mediaRecorder.stop(),this.mediaRecorder=null),this.clearTimer()},watch:{"store.banzouVolume":{handler(){this.audioCtx&&(this.gainNode_banzou.gain.value=this.store.banzouVolume)}},"store.banzouPitch":{handler(){this.audioCtx&&(this.pitchShift_banzou.pitch=this.store.banzouPitch)}}},methods:{test1(){console.log("test1"+this.store)},setVisibilyChange(){"visible"===document.visibilityState?(alert("抱歉,录音过程中页面切换,导致录音文件出现问题,程序不得不结束录音"),this.finish()):document.visibilityState},initAnalyser(e){const t=this.audioCtx.createMediaStreamSource(e);this.analyser=this.audioCtx.createAnalyser(),this.analyser.fftSize=2048,t.connect(this.analyser);let i=this.$refs.waveBox;this.ctx=i.getContext("2d"),this.drawWaveform()},drawWaveform(){const e=this.analyser.fftSize,t=new Uint8Array(e);let i=this.$refs.waveBox,n=this.ctx,o=()=>{this.analyser.getByteTimeDomainData(t),n.clearRect(0,0,i.width,i.height),n.lineWidth=1.5,n.strokeStyle="#e4310d",n.beginPath();const s=1*i.width/e;let a=0;for(let o=0;o<e;o++){const e=t[o]/128,r=e*i.height/2;0===o?n.moveTo(a,r):n.lineTo(a,r),a+=s}n.lineTo(i.width,i.height/2),n.stroke(),this.animationId=requestAnimationFrame(o)};o()},checkQianzouLength(){this.store.parsedLyrics&&this.store.parsedLyrics.length&&this.store.parsedLyrics[0].time>10&&(this.jumpShow=!0)},jumpToSing(){let e=this.store.parsedLyrics[0].value;this.curVal=[e],this.onChange({selectedValues:[e]}),this.changeTime(),this.jumpShow=!1},clearTimer(){clearTimeout(this.cdTimer),clearTimeout(this.delayTimer),clearTimeout(this.touchEndTimer),cancelAnimationFrame(this.animationId)},onSetting(){this.settingShow=!0},setMediaRecorder(){this.mediaRecorder.ondataavailable=e=>{console.log(e.data),this.$refs.audio&&(this.store.audioChunk.push({start:this.recordStarttime,end:this.$refs.audio.currentTime,blob:e.data}),console.log(this.store.audioChunk))}},initMediaRecorder(e){this.mediaRecorder=new MediaRecorder(e),this.setMediaRecorder()},removeRecordedSegmentsAfter(e){this.store.audioChunk=this.store.audioChunk.filter((t=>t.start<e))},createSilentAudio(e){const t=this.audioCtx,i=2,n=t.sampleRate*e,o=t.createBuffer(i,n,t.sampleRate);return o},getCurClass(){let e=[];return this.dotCount<=0&&e.push("c-start-sing"),this.scrolling&&e.push("c-picker-scrolling"),e.join(" ")},onTouchStart(){!this.countingdown&&this.playing&&(console.log("onTouchStart"),this.touchEndTimer?(clearTimeout(this.touchEndTimer),this.touchEndTimer=null):this.touchTime=this.$refs.audio.currentTime,this.scrolling=!0)},onTouchEnd(){!this.countingdown&&this.playing&&(console.log("will onTouchEnd"),this.touchEndTimer=setTimeout((()=>{console.log("onTouchEnd"),this.scrolling=!1,this.touchEndTimer=null,this.changeTime()}),500))},loadAudio(){this.audioUrl=window.URL.createObjectURL(this.store.banzou),this.$refs.audio.src=this.audioUrl},onLoadedMetadata(){this.store.banzouLength=this.$refs.audio.duration,this.mediaRecorder.start(),this.$refs.audio.play(),this.playing=!0,this.checkQianzouLength()},connectAuido(){var e=new(window.AudioContext||window.webkitAudioContext),t=this.$refs.audio,i=e.createMediaElementSource(t),n=e.createGain();i.connect(n),Tone.setContext(e),n.gain.value=this.store.banzouVolume;var o=new Tone.PitchShift;o.pitch=this.store.banzouPitch,Tone.connect(n,o),Tone.connect(o,e.destination),this.audioCtx=e,this.gainNode_banzou=n,this.pitchShift_banzou=o},onBack(){this.$router.replace("/")},setCountdownTime(e){this.showCountdownTime=e<5?0:e-5,this.needCountdown=!0},onPause(){this.countingdown||(this.$refs.audio.pause(),this.mediaRecorder.pause(),this.playing=!1)},onPlay(){this.countingdown||(this.$refs.audio.play(),this.mediaRecorder.resume(),this.playing=!0)},onTimeUpdate(){const e=this.$refs.audio;if(!e)return;if(this.curTime=e.currentTime,this.countingdown||this.scrolling)return;console.log("---------onTimeUpdate");const t=e.currentTime;if(this.needCountdown&&t>=this.showCountdownTime){this.jumpShow=!1;let e=t-this.showCountdownTime,i=Math.floor(e),n=1e3-1e3*(e-i);return this.dotCount=Math.floor(5-(e-i)),this.dotCount<0?(this.dotCount=0,void(this.needCountdown=!1)):(this.countingdown=!0,this.delayTimer=setTimeout((()=>{this.countdown().then((()=>{this.countingdown=!1,"recording"!==this.mediaRecorder.state&&(this.mediaRecorder.start(),this.recordStarttime=this.$refs.audio.currentTime,this.removeRecordedSegmentsAfter(this.recordStarttime))}))}),n),void(this.needCountdown=!1))}if(!this.countingdown)for(let i=0;i<this.store.parsedLyrics.length;i++)if(t>=this.store.parsedLyrics[i].time&&(i===this.store.parsedLyrics.length-1||t<this.store.parsedLyrics[i+1].time)){this.curVal=[this.store.parsedLyrics[i].value];break}},onChange({selectedValues:e}){"recording"===this.mediaRecorder.state&&this.mediaRecorder.stop(),this.valueChangeTime=e[0]},changeTime(){if(this.scrolling||!this.valueChangeTime)return;let e=this.valueChangeTime-5;e<0&&(e=0),console.log("n-> ",e),this.$refs.audio.currentTime=e,this.setCountdownTime(this.valueChangeTime),this.valueChangeTime=null},countdown(){return new Promise((e=>{this.countingdown=!0;let t=()=>{this.dotCount>0?this.cdTimer=setTimeout((()=>{this.dotCount--,t()}),1e3):e()};t()}))},onReplay(){1!=this.countingdown&&(0,I.M5)({title:"提示",message:"是否要重录?"}).then((()=>{this.doReplay()})).catch((()=>{}))},doReplay(){this.clearTimer(),this.$refs.audio.pause(),this.$refs.audio.currentTime=0,this.countingdown=!1,this.dotCount=5,this.valueChangeTime=null,this.showCountdownTime=null,this.store.lrc&&this.store.parsedLyrics.length&&(this.curVal=[this.store.parsedLyrics[0].value],this.setCountdownTime(this.store.parsedLyrics[0].value)),this.mediaRecorder.ondataavailable=()=>{},this.mediaRecorder.stop(),this.setMediaRecorder(),this.recordStarttime=0,this.store.audioChunk=[],this.mediaRecorder.start(),this.drawWaveform(),this.$refs.audio.play(),this.playing=!0,this.checkQianzouLength()},onFinish(){1!=this.countingdown&&(console.log("onFinish"),this.$refs.audio.paused?this.isAlreadyPaused=!0:(this.$refs.audio.pause(),this.isAlreadyPaused=!1),this.fShow=!0)},finish(){console.log("finish"),this.$refs.audio.pause(),this.mediaRecorder.stop(),setTimeout((()=>{this.$router.push({path:"/edit"})}),50)},onFshowCancel(){this.fShow=!1,this.isAlreadyPaused||this.$refs.audio.play()},onFshowSelect(e,t){console.log(e,t),0==t?this.store.recordLength=this.$refs.audio.currentTime:1==t&&(this.store.recordLength=0),this.finish()}}};const tt=(0,g.A)(et,[["render",Ke],["__scopeId","data-v-bfc3cbf6"]]);var it=tt;const nt=e=>((0,o.Qi)("data-v-88f60778"),e=e(),(0,o.jt)(),e),ot={class:"container compose"},st={class:"content content-compose"},at={class:"c-e-name c-e-name-crop"},rt={class:"c-e-ctrlbox"},ct={class:"c-e-ctrlitem"},lt={class:"c-e-sliderbox-time"},ut={class:"c-e-sliderbox"},ht={class:"c-e-sliderbox-time"},dt={class:"c-co-lrcbox"},ft={class:"c-e-title"},mt=nt((()=>(0,o.Lk)("span",null,"伴奏音量",-1))),gt={class:"c-e-voicebox c-co-voicebox"},pt={class:"c-e-title"},vt=nt((()=>(0,o.Lk)("span",null,"压缩音频",-1))),bt={class:"c-co-imgbox"},yt={class:"c-co-imgtitle"},Ct=nt((()=>(0,o.Lk)("span",null,"images:",-1))),At={class:"c-e-editbox c-co-editbox"},xt=["src"],wt={class:"c-co-namebox"},Nt={class:"c-co-itemname"},kt={class:"c-co-volbox"},Lt={class:"c-co-volname"},St={class:"c-co-volbox"},Tt={class:"c-co-volname"},Gt={class:"c-co-volbox"},Rt=nt((()=>(0,o.Lk)("div",{class:"c-co-volname"},"混响",-1))),Ft={class:"c-co-reverbbox"},It={class:"c-e-btnbox c-co-btnbox"},Et={class:"c-co-innerbox"};function Ut(e,t,i,s,a,r){const c=(0,o.g2)("van-nav-bar"),l=(0,o.g2)("van-icon"),u=(0,o.g2)("van-slider"),h=(0,o.g2)("van-switch"),d=(0,o.g2)("van-radio"),f=(0,o.g2)("van-radio-group"),m=(0,o.g2)("van-button"),g=(0,o.g2)("SettingDialog"),p=(0,o.g2)("ReverbDialog");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",ot,[(0,o.bF)(c,{title:"合成","left-text":"主页",onClickLeft:t[0]||(t[0]=e=>r.onBack()),"right-text":"设置",onClickRight:r.onSetting},null,8,["onClickRight"]),(0,o.Lk)("div",st,[(0,o.Lk)("div",at,(0,A.v_)(a.musicName),1),(0,o.Lk)("div",rt,[(0,o.Lk)("div",ct,[(0,o.bo)((0,o.bF)(l,{name:"pause-circle-o",class:"c-e-ctrlicon",onClick:r.onPause},null,8,["onClick"]),[[n.aG,a.playing]]),(0,o.bo)((0,o.bF)(l,{name:"play-circle",class:"c-e-ctrlicon",onClick:r.onPlay},null,8,["onClick"]),[[n.aG,!a.playing]])]),(0,o.Lk)("div",lt,(0,A.v_)(s.util.convertTime(a.curTime)),1),(0,o.Lk)("div",ut,[(0,o.bF)(u,{modelValue:a.curTime,"onUpdate:modelValue":t[1]||(t[1]=e=>a.curTime=e),onChange:r.onDurationChange,max:a.audioDuration,onDragStart:t[2]||(t[2]=e=>a.dragging=!0),onDragEnd:t[3]||(t[3]=e=>a.dragging=!1)},null,8,["modelValue","onChange","max"])]),(0,o.Lk)("div",ht,(0,A.v_)(s.util.convertTime(a.audioDuration)),1)]),(0,o.Lk)("div",dt,(0,A.v_)(a.curLrc),1),(0,o.Lk)("div",ft,[mt,(0,o.Lk)("span",null,(0,A.v_)(a.accompanyVal),1)]),(0,o.Lk)("div",gt,[(0,o.bF)(u,{min:"0",max:"100",modelValue:a.accompanyVal,"onUpdate:modelValue":t[4]||(t[4]=e=>a.accompanyVal=e),onChange:r.onAccompanyVoiceChange},null,8,["modelValue","onChange"])]),(0,o.Lk)("div",pt,[vt,(0,o.bF)(h,{modelValue:s.store.compress,"onUpdate:modelValue":t[5]||(t[5]=e=>s.store.compress=e)},null,8,["modelValue"])]),(0,o.bo)((0,o.Lk)("div",bt,[(0,o.Lk)("div",yt,[Ct,(0,o.bF)(f,{modelValue:a.orient,"onUpdate:modelValue":t[6]||(t[6]=e=>a.orient=e),direction:"horizontal",onChange:r.onOrientChange},{default:(0,o.k6)((()=>[(0,o.bF)(d,{name:"0"},{default:(0,o.k6)((()=>[(0,o.eW)("landscape")])),_:1}),(0,o.bF)(d,{name:"1"},{default:(0,o.k6)((()=>[(0,o.eW)("portrait")])),_:1})])),_:1},8,["modelValue","onChange"])]),(0,o.Lk)("div",{class:(0,A.C4)("0"==a.orient?"c-co-imglist":"c-co-imglist portrait")},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.imgList,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"c-co-imgitem",key:t,style:(0,A.Tr)(r.getBg(e))},[(0,o.bF)(l,{name:"close",class:"c-co-imgrev",onClick:i=>r.onRemoveImg(e,t)},null,8,["onClick"])],4)))),128))],2)],512),[[n.aG,a.imgList.length]]),(0,o.Lk)("div",At,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.filelist,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"c-co-item",key:t},[(0,o.Lk)("audio",{src:e.file.url,ref_for:!0,ref:"setItemRef",class:"c-co-audio"},null,8,xt),(0,o.Lk)("div",wt,[(0,o.Lk)("div",Nt,(0,A.v_)(e.file.name.replace(/\.(mp3|wav)$/i,"")),1)]),(0,o.Lk)("div",kt,[(0,o.Lk)("span",Lt,[(0,o.eW)("音量: "),(0,o.Lk)("b",null,(0,A.v_)(e.volume),1)]),(0,o.bF)(u,{class:"c-co-volslider",modelValue:e.volume,"onUpdate:modelValue":t=>e.volume=t,onChange:i=>r.onVolumeChange(e,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),(0,o.Lk)("div",St,[(0,o.Lk)("span",Tt,[(0,o.eW)("迟延: "),(0,o.Lk)("b",null,(0,A.v_)(e.delay),1)]),(0,o.bF)(u,{min:"-2",max:"2",step:"0.1",class:"c-co-volslider c-co-volslider-delay",modelValue:e.delay,"onUpdate:modelValue":t=>e.delay=t,onChange:i=>r.onDelayChange(e,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),(0,o.Lk)("div",Gt,[Rt,(0,o.Lk)("div",Ft,[(0,o.bo)((0,o.bF)(m,{plain:"",type:"primary",size:"small",class:"c-e-cusbtn",onClick:i=>r.onReverbSetting(e,t)},{default:(0,o.k6)((()=>[(0,o.eW)("设置")])),_:2},1032,["onClick"]),[[n.aG,e.reverb]]),(0,o.bF)(h,{modelValue:e.reverb,"onUpdate:modelValue":t=>e.reverb=t,onChange:i=>{r.onReverbChange(i,e,t)}},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),(0,o.bF)(l,{name:"close",class:"c-co-remove",onClick:i=>r.onVoiceRemove(e,t)},null,8,["onClick"])])))),128))]),(0,o.Lk)("div",It,[(0,o.Lk)("div",Et,[(0,o.Lk)("input",{type:"file",multiple:"",ref:"imgFile",style:{display:"none"},onChange:t[7]||(t[7]=(...e)=>r.onImgFileSelect&&r.onImgFileSelect(...e))},null,544),(0,o.Lk)("input",{type:"file",ref:"audioFile",style:{display:"none"},onChange:t[8]||(t[8]=(...e)=>r.onAudioFileSelect&&r.onAudioFileSelect(...e))},null,544),(0,o.bF)(m,{class:"c-e-btn",type:"primary",onClick:r.onAudioAdd},{default:(0,o.k6)((()=>[(0,o.eW)("添加人声")])),_:1},8,["onClick"]),(0,o.bF)(m,{round:"",class:"c-e-btn c-e-btn-r",type:"success",onClick:r.compose},{default:(0,o.k6)((()=>[(0,o.eW)("合成歌曲")])),_:1},8,["onClick"])])])])]),(0,o.bF)(g,{visible:a.settingShow,"onUpdate:visible":t[9]||(t[9]=e=>a.settingShow=e),data:a.curReverbData},null,8,["visible","data"]),(0,o.bF)(p,{ref:"rbDlg",onChange:r.onReverbDetailChange,onClose:t[10]||(t[10]=t=>e.curReverbItem=null)},null,8,["onChange"])],64)}let Dt;var Vt={name:"ComposeView",components:{SettingDialog:$e,ReverbDialog:Se},setup(){Dt=Te(new(window.AudioContext||window.webkitAudioContext)),console.log("compose.......");const e=l(),t=(0,ue.KR)(null);return{store:e,util:y,rbDlg:t}},data(){return{audioContext:null,offlineAudioCtx:null,musicName:"",audioDuration:0,curTime:0,curLrc:"",dragging:!1,accompanyVal:0,playing:!1,orient:"0",settingShow:!1,remainTime:0,imgList:[],filelist:[],rbSettingShow:!1,curReverbData:{}}},mounted(){if(!this.store.banzou)return alert("没有找到需要编辑的音频"),void this.$router.replace("/");this.audioContext=Dt.context,console.log(this.audioContext),this.init(this.store.banzou),document.addEventListener("visibilitychange",this.setVisibilyChange)},unmounted(){document.removeEventListener("visibilitychange",this.setVisibilyChange),this.rTimer&&cancelAnimationFrame(this.rTimer);for(let t=0;t<this.filelist.length;t++){const e=this.filelist[t];e.delayPlayTimer&&(clearTimeout(e.delayPlayTimer),e.delayPlayTimer=null),e.voiceSource.disconnect(),e.voiceSource.buffer=null}this.fileList=[];try{this.bgSource.disconnect(),this.bgSource.buffer=null}catch(e){}try{this.audioContext.close()}catch(e){console.log(e)}try{this.offlineAudioCtx&&("running"==this.offlineAudioCtx.state&&this.offlineAudioCtx.suspend(this.offlineAudioCtx.currentTime),this.offlineAudioCtx=null)}catch(e){console.log(e)}console.log("hide loading"),this.store.hideLoading(),this.store.hideProgess(),me(),he.stop(),Dt=null},watch:{"store.banzouVolume":{handler(){this.audioContext&&(this.accompanyVal=parseInt(100*this.store.banzouVolume),this.bgGain.gain.value=this.store.banzouVolume)}}},methods:{setVisibilyChange(){if("visible"===document.visibilityState)try{this.audioContext.suspend()}catch(e){}else"hidden"===document.visibilityState&&this.doStop()},onReverbSetting(e,t){this.rbDlg.show({time:e.reverbNode.time,decay:e.reverbNode.decay,mix:e.reverbNode.mix}),this.curReverbItem=e},async init(e){this.musicName=this.store.banzou.name.replace(/\.mp3$/i,""),this.store.showLoading();const t=await this.loadAudioData(this.audioContext,e),i=t.duration;this.audioDuration=i;const n=this.audioContext.sampleRate,o=i*n,s=this.audioContext.createBuffer(2,o,n);s.getChannelData(0).set(t.getChannelData(0).subarray(0,o));let a=0;t.numberOfChannels>1&&(a=1),s.getChannelData(1).set(t.getChannelData(a).subarray(0,o));const r=this.audioContext.createBufferSource();r.buffer=s,this.bgGain=this.audioContext.createGain(),this.accompanyVal=parseInt(100*this.store.banzouVolume),this.bgGain.gain.value=this.store.banzouVolume,r.connect(this.bgGain),Tone.setContext(this.audioContext);var c=new Tone.PitchShift;c.pitch=this.store.banzouPitch,Tone.connect(this.bgGain,c),Tone.connect(c,this.audioContext.destination),this.bgSource=r,this.remainTime=this.audioContext.currentTime,this.store.lrc&&await this.store.readLrcText(),this.audioContext.suspend(),r.start(),this.store.hideLoading()},loadAudioData(e,t){return new Promise(((i,n)=>{const o=new FileReader;o.onload=()=>{e.decodeAudioData(o.result).then((e=>i(e))).catch((e=>n(e)))},o.onerror=()=>n(o.error),o.readAsArrayBuffer(t)}))},setCurTime(){let e=this.audioContext.currentTime-this.remainTime;e>=this.audioDuration?this.doStop(!0):(this.dragging||(this.curTime=e),this.onTimeUpdate(),this.rTimer=requestAnimationFrame(this.setCurTime))},onAccompanyVoiceChange(e){this.bgGain&&(this.bgGain.gain.value=e/100,this.store.banzouVolume=e/100)},doStop(e){console.log(this.audioContext.state),this.playing=!1,"running"==this.audioContext.state&&(this.audioContext.suspend(),e&&(this.curTime=0,this.rTimer=null,this.remainTime=this.audioContext.currentTime))},jumpTo(e){try{this.bgSource.stop()}catch(i){}const t=this.audioContext.createBufferSource();t.buffer=this.bgSource.buffer,this.bgSource.disconnect(),this.bgSource.buffer=null,t.connect(this.bgGain),this.bgSource=t,this.bgSource.start(0,e);for(let n=0;n<this.filelist.length;n++){let t=this.filelist[n];try{t.voiceSource.stop()}catch(i){}const o=this.audioContext.createBufferSource();console.log(t.voiceSource),o.buffer=t.voiceSource.buffer,t.voiceSource.disconnect(),t.voiceSource.buffer=null,o.connect(t.gainNode),t.voiceSource=o,this.startVoiceSource(e,t)}},startVoiceSource(e=0,t){t.delayPlayTimer&&(clearTimeout(t.delayPlayTimer),t.delayPlayTimer=null);let i=0;if(i=e+t.delay,i>=0)t.voiceSource.start(0,i);else{let e=-1e3*i;i=0,t.delayPlayTimer=setTimeout((()=>{t.voiceSource.start(0,i)}),e)}},onPlay(){this.doPlay()},doPlay(){console.log(this.audioContext.state),"running"!=this.audioContext.state&&(this.playing=!0,this.audioContext.resume(),this.rTimer?this.jumpTo(this.curTime):(this.setCurTime(),this.jumpTo(0)))},onPause(){this.doStop()},onBack(){this.$router.replace("/")},setItemRef(e,t){return`voice${t}`},onTimeUpdate(){if(!this.store.parsedLyrics||!this.store.parsedLyrics.length)return;const e=this.curTime;for(let t=0;t<this.store.parsedLyrics.length;t++)if(e>=this.store.parsedLyrics[t].time&&(t===this.store.parsedLyrics.length-1||e<this.store.parsedLyrics[t+1].time)){this.curLrc=this.store.parsedLyrics[t].text;break}},getBg(e){let t=`background-image: url(${e.url}); background-repeat: no-repeat; background-position: center;`;return t},onImgFileSelect(){if(this.imgList.length>=10)return void alert("最多添加10张图片");const e=this.$refs.imgFile.files;for(let t of e){if(console.log(t.type),"image/png"!==t.type&&"image/jpeg"!==t.type){alert("只能添加图片文件 -> "+t.name);continue}if(t.size>5242880){alert("图片大小不能超过5M -> "+t.name);continue}let e=URL.createObjectURL(t);this.imgList.push({url:e})}this.$refs.imgFile.value=""},onImgAdd(){this.$refs.imgFile.click()},onRemoveImg(e,t){this.imgList.splice(t,1)},isSurpportFile(e){const t=/\.(mp3|wav)$/i;return t.test(e.name)},async onAudioFileSelect(){this.store.showLoading();const e=this.$refs.audioFile.files[0];if(!this.isSurpportFile(e))return(0,E.P0)("目前只支持 wav, mp3 格式"),void this.store.hideLoading();this.doStop();let t={reverb:!1,reverbNode:new Dt.Effects.Reverb({...this.store.reverbOption}),volume:100,delay:0,file:e,gainNode:null};this.filelist.push(t),await this.addVoice(t),this.$refs.audioFile.value="",this.store.hideLoading()},onAudioAdd(){this.$refs.audioFile.click()},async addVoice(e){const t=await this.loadAudioData(this.audioContext,e.file);let i=t.duration;this.audioDuration<i&&(i=this.audioDuration);const n=this.audioContext.sampleRate,o=i*n,s=this.audioContext.createBuffer(2,o,n);s.getChannelData(0).set(t.getChannelData(0).subarray(0,o));let a=0;t.numberOfChannels>1&&(a=1),s.getChannelData(1).set(t.getChannelData(a).subarray(0,o));const r=this.audioContext.createBufferSource();r.buffer=s,e.voiceSource=r;let c=this.audioContext.createGain();c.gain.value=1,e.gainNode=c,r.connect(c),c.connect(this.audioContext.destination)},async getReverb(e){this.store.showLoading();const t="audio/reverb"+e+".wav";try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok "+e.statusText);const i=await e.arrayBuffer(),n=await this.audioContext.decodeAudioData(i);return console.log(n),this.store.hideLoading(),n}catch(i){return console.error("There has been a problem with your fetch operation:",i),this.store.hideLoading(),null}},async onReverbChange(e,t,i){e?(t.gainNode.disconnect(),t.gainNode.connect(t.reverbNode),t.reverbNode.connect(this.audioContext.destination)):(t.gainNode.disconnect(),t.reverbNode.disconnect(),t.gainNode.connect(this.audioContext.destination))},onReverbDetailChange(e){this.curReverbItem&&(this.curReverbItem.reverbNode.time=e.time,this.curReverbItem.reverbNode.decay=e.decay,this.curReverbItem.reverbNode.mix=e.mix)},onVolumeChange(e,t){console.log(e,t),e.gainNode.gain.value=e.volume/100},onDelayChange(e,t){this.jumpTo(this.curTime)},onSetting(){this.settingShow=!0},onDurationChange(e){this.remainTime=this.audioContext.currentTime-e,this.jumpTo(e)},onOrientChange(e,t){console.log(e,t)},onVoiceRemove(e,t){this.doStop(),e.voiceSource.disconnect(),e.gainNode.disconnect(),e.disconnectReverb&&(e.disconnectReverb(),e.disconnectReverb=null),this.filelist.splice(t,1)},compose(){this.filelist.length?(this.doStop(),this.exportAudio(this.store.compress)):(0,E.P0)("请添加人声音频")},async exportAudio(e){let t,i=this.audioDuration,n=new OfflineAudioContext({numberOfChannels:2,length:48e3*i,sampleRate:48e3}),o=Te(n);this.offlineAudioCtx=n,t=n.createBufferSource(),t.buffer=this.bgSource.buffer;let s=n.createGain();s.gain.value=this.store.banzouVolume,Tone.setContext(n);let a=new Tone.PitchShift;a.pitch=this.store.banzouPitch,t.connect(s),Tone.connect(s,a),Tone.connect(a,n.destination);let r=[];for(let c=0;c<this.filelist.length;c++){const e=this.filelist[c];let t=n.createBufferSource();t.buffer=e.voiceSource.buffer;let i=n.createGain(),s={reverb:e.reverb,reverbNode:new o.Effects.Reverb({time:e.reverbNode.time,decay:e.reverbNode.decay,mix:e.reverbNode.mix}),gainNode:i,voiceSource:t,delay:e.delay,volume:e.volume};console.log(s),i.gain.value=s.volume/100,t.connect(i),s.reverb?(i.connect(s.reverbNode),s.reverbNode.connect(n.destination)):i.connect(n.destination),this.startVoiceSource(0,s),r.push(t)}t.start(),console.log("start generate"),n.startRendering().then((t=>{this.offlineAudioCtx&&(console.log("渲染完成",t),e&&(0,E.P0)("正在压缩音频,可能要花费很长时间..."),be(t,n.length,e,(e=>{this.offlineAudioCtx&&this.store.showProgess(e)}),(()=>{this.store.hideProgess()})))})).catch((e=>{console.error("渲染错误:",e)})),(0,E.P0)("正在生成音频,请稍后..."),he.start(n,t.buffer.duration,(e=>{this.offlineAudioCtx&&(console.log("progess",e),this.store.showProgess(e))}),(()=>{this.store.hideProgess(),t.disconnect(),t.buffer=null;for(let e of r)e.disconnect(),e.buffer=null}))}}};const Bt=(0,g.A)(Vt,[["render",Ut],["__scopeId","data-v-88f60778"]]);var Ot=Bt;const Pt=[{path:"/",name:"home",component:V},{path:"/record",name:"record",component:it},{path:"/edit",name:"edit",component:Ie},{path:"/compose",name:"compose",component:Ot}],zt=(0,C.aE)({history:(0,C.Bt)(),routes:Pt});var Mt=zt,Qt=(i(2622),i(3876)),jt=i(9655);const Kt=(0,r.Ey)();Kt.use(Qt.A);const Wt=(0,n.Ef)(v);Wt.use(jt.Ay$),Wt.use(Mt),Wt.use(Kt),Wt.mount("#app")},8411:function(e,t,i){"use strict";e.exports=i.p+"img/banzou.6a90dd29.png"},9527:function(e){"use strict";e.exports="data:image/png;base64,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"}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.m=e,function(){var e=[];i.O=function(t,n,o,s){if(!n){var a=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],s=e[u][2];for(var r=!0,c=0;c<n.length;c++)(!1&s||a>=s)&&Object.keys(i.O).every((function(e){return i.O[e](n[c])}))?n.splice(c--,1):(r=!1,s<a&&(a=s));if(r){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,o,s]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.p=""}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,a=n[0],r=n[1],c=n[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(c)var u=c(i)}for(t&&t(n);l<a.length;l++)s=a[l],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(u)},n=self["webpackChunkallsing"]=self["webpackChunkallsing"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],(function(){return i(4312)}));n=i.O(n)})();
//# sourceMappingURL=app.564a5bba.js.map